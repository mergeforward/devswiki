{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Makefile\u541b\u7684\u6587\u6863\u7ad9 \u6280\u672f\u535a\u6587 golang\u76f8\u5173 \u5f00\u653e\u5c01\u95ed\u51c6\u5219\u7684golang\u5b9e\u4f8b k8s\u76f8\u5173 harbor\u90e8\u7f72 k8s\u6301\u7eed\u6784\u5efa/\u96c6\u6210\u73af\u5883\u7684\u642d\u5efa \u673a\u5668\u5b66\u4e60 cuda\u5b89\u88c5 \u5bc6\u7801\u5b66 \u6d88\u606f\u7684\u901a\u8baf \u8bfe\u7a0b\u4e0e\u6f14\u8bb2 \u5bb9\u5668\u6280\u672f\u76f8\u5173 15\u5206\u949f\u5feb\u901f\u5165\u95e8 2\u5c0f\u65f6\u7b80\u5355\u5165\u95e8 Python\u76f8\u5173 \u5feb\u901f\u6392\u5e8f GDG \u4e0a\u6d77 \u7cfb\u5217\u8bfe\u7a0b Docker\u4e0eK8s\u7cfb\u5217\u8bfe\u7a0b GDG \u90d1\u5dde \u6f14\u8bb2 API-Frist Intro \u53cb\u60c5\u652f\u6301 sponsorship","title":"Makefile\u541b\u7684\u6587\u6863\u7ad9"},{"location":"#makefile","text":"","title":"Makefile\u541b\u7684\u6587\u6863\u7ad9"},{"location":"#_1","text":"","title":"\u6280\u672f\u535a\u6587"},{"location":"#golang","text":"\u5f00\u653e\u5c01\u95ed\u51c6\u5219\u7684golang\u5b9e\u4f8b","title":"golang\u76f8\u5173"},{"location":"#k8s","text":"harbor\u90e8\u7f72 k8s\u6301\u7eed\u6784\u5efa/\u96c6\u6210\u73af\u5883\u7684\u642d\u5efa","title":"k8s\u76f8\u5173"},{"location":"#_2","text":"cuda\u5b89\u88c5","title":"\u673a\u5668\u5b66\u4e60"},{"location":"#_3","text":"\u6d88\u606f\u7684\u901a\u8baf","title":"\u5bc6\u7801\u5b66"},{"location":"#_4","text":"","title":"\u8bfe\u7a0b\u4e0e\u6f14\u8bb2"},{"location":"#_5","text":"15\u5206\u949f\u5feb\u901f\u5165\u95e8 2\u5c0f\u65f6\u7b80\u5355\u5165\u95e8","title":"\u5bb9\u5668\u6280\u672f\u76f8\u5173"},{"location":"#python","text":"\u5feb\u901f\u6392\u5e8f","title":"Python\u76f8\u5173"},{"location":"#gdg","text":"Docker\u4e0eK8s\u7cfb\u5217\u8bfe\u7a0b","title":"GDG \u4e0a\u6d77 \u7cfb\u5217\u8bfe\u7a0b"},{"location":"#gdg_1","text":"API-Frist Intro","title":"GDG \u90d1\u5dde \u6f14\u8bb2"},{"location":"#_6","text":"sponsorship","title":"\u53cb\u60c5\u652f\u6301"},{"location":"assets/css/theme/","text":"Dependencies Themes are written using Sass to keep things modular and reduce the need for repeated selectors across files. Make sure that you have the reveal.js development environment including the Grunt dependencies installed before proceding: https://github.com/hakimel/reveal.js#full-setup Creating a Theme To create your own theme, start by duplicating a .scss file in /css/theme/source . It will be automatically compiled by Grunt from Sass to CSS (see the Gruntfile ) when you run grunt css-themes . Each theme file does four things in the following order: Include /css/theme/template/mixins.scss Shared utility functions. Include /css/theme/template/settings.scss Declares a set of custom variables that the template file (step 4) expects. Can be overridden in step 3. Override This is where you override the default theme. Either by specifying variables (see settings.scss for reference) or by adding any selectors and styles you please. Include /css/theme/template/theme.scss The template theme file which will generate final CSS output based on the currently defined variables.","title":"Index"},{"location":"assets/css/theme/#dependencies","text":"Themes are written using Sass to keep things modular and reduce the need for repeated selectors across files. Make sure that you have the reveal.js development environment including the Grunt dependencies installed before proceding: https://github.com/hakimel/reveal.js#full-setup","title":"Dependencies"},{"location":"assets/css/theme/#creating-a-theme","text":"To create your own theme, start by duplicating a .scss file in /css/theme/source . It will be automatically compiled by Grunt from Sass to CSS (see the Gruntfile ) when you run grunt css-themes . Each theme file does four things in the following order: Include /css/theme/template/mixins.scss Shared utility functions. Include /css/theme/template/settings.scss Declares a set of custom variables that the template file (step 4) expects. Can be overridden in step 3. Override This is where you override the default theme. Either by specifying variables (see settings.scss for reference) or by adding any selectors and styles you please. Include /css/theme/template/theme.scss The template theme file which will generate final CSS output based on the currently defined variables.","title":"Creating a Theme"},{"location":"assets/js/plugin/markdown/example/","text":"Markdown Demo External 1.1 Content 1.1 Note: This will only appear in the speaker notes window. External 1.2 Content 1.2 External 2 Content 2.1 External 3.1 Content 3.1 External 3.2 Content 3.2","title":"Markdown Demo"},{"location":"assets/js/plugin/markdown/example/#markdown-demo","text":"","title":"Markdown Demo"},{"location":"assets/js/plugin/markdown/example/#external-11","text":"Content 1.1 Note: This will only appear in the speaker notes window.","title":"External 1.1"},{"location":"assets/js/plugin/markdown/example/#external-12","text":"Content 1.2","title":"External 1.2"},{"location":"assets/js/plugin/markdown/example/#external-2","text":"Content 2.1","title":"External 2"},{"location":"assets/js/plugin/markdown/example/#external-31","text":"Content 3.1","title":"External 3.1"},{"location":"assets/js/plugin/markdown/example/#external-32","text":"Content 3.2","title":"External 3.2"},{"location":"assets/js/plugin/menu/","text":"reveal.js-menu A slideout menu plugin for Reveal.js to quickly jump to any slide by title. Also optionally change the theme and set the default transition. Check out the live demo Installation Bower Download and install the package in your project: bower install reveal.js-menu Add the plugin to the dependencies in your presentation, as below. Reveal . initialize ({ // ... dependencies : [ // ... { src : 'bower_components/reveal.js-menu/menu.js' } ] }); npm Download and install the package in your project: npm install --save reveal.js-menu Add the plugin to the dependencies in your presentation, as below. Reveal . initialize ({ // ... dependencies : [ // ... { src : 'node_modules/reveal.js-menu/menu.js' } ] }); Manual Copy this repository into the plugins folder of your reveal.js presentation, ie plugins/menu . Add the plugin to the dependencies in your presentation, as below. Reveal . initialize ({ // ... dependencies : [ // ... { src : 'plugin/menu/menu.js' } ] }); Configuration You can configure the menu for your presentation by providing a menu option in the reveal.js initialization options. Note that all config values are optional and will default as specified below. Reveal . initialize ({ // ... menu : { // Specifies which side of the presentation the menu will // be shown. Use 'left' or 'right'. side : 'left' , // Add slide numbers to the titles in the slide list. // Use 'true' or format string (same as reveal.js slide numbers) numbers : false , // Specifies which slide elements will be used for generating // the slide titles in the menu. The default selects the first // heading element found in the slide, but you can specify any // valid css selector and the text from the first matching // element will be used. // Note: that a section data-menu-title attribute or an element // with a menu-title class will take precedence over this option titleSelector : 'h1, h2, h3, h4, h5, h6' , // Hide slides from the menu that do not have a title. // Set to 'true' to only list slides with titles. hideMissingTitles : false , // Add markers to the slide titles to indicate the // progress through the presentation markers : false , // Specify custom panels to be included in the menu, by // providing an array of objects with 'title', 'icon' // properties, and either a 'src' or 'content' property. custom : false , // Specifies the themes that will be available in the themes // menu panel. Set to 'false' to hide themes panel. themes : [ { name : 'Black' , theme : 'css/theme/black.css' }, { name : 'White' , theme : 'css/theme/white.css' }, { name : 'League' , theme : 'css/theme/league.css' }, { name : 'Sky' , theme : 'css/theme/sky.css' }, { name : 'Swagger' , theme : 'css/theme/swagger.css' }, { name : 'Beige' , theme : 'css/theme/beige.css' }, { name : 'Simple' , theme : 'css/theme/simple.css' }, { name : 'Serif' , theme : 'css/theme/serif.css' }, { name : 'Blood' , theme : 'css/theme/blood.css' }, { name : 'Night' , theme : 'css/theme/night.css' }, { name : 'Moon' , theme : 'css/theme/moon.css' }, { name : 'Solarized' , theme : 'css/theme/solarized.css' } ], // Specifies if the transitions menu panel will be shown. transitions : true , // Adds a menu button to the slides to open the menu panel. // Set to 'false' to hide the button. openButton : true , // If 'true' allows the slide number in the presentation to // open the menu panel. The reveal.js slideNumber option must // be displayed for this to take effect openSlideNumber : false , // If true allows the user to open and navigate the menu using // the keyboard. Standard keyboard interaction with reveal // will be disabled while the menu is open. keyboard : true }, }); Slide Titles The slide titles used in the menu can be supplied explicitly or are taken directly from the presentation, using the following rules... 1. The section's data-menu-title attribute. If the slide's section element contains a data-menu-title attribute this will be used for the slide title in the menu. For example... < section data-menu-title = \"Custom Menu Title\" > < h1 > Title </ h1 > < p > ... </ p > </ section > 2. Any element with the class menu-title . If the slide's section contains an element with the class menu-title then the element's text will be used for the title. The first such element found will be used if there are more than one. Note the element need not be displayed to be used. For example... < section > < h1 > Title </ h1 > < span class = \"menu-title\" style = \"display: none\" > Custom Menu Title </ span > < p > ... </ p > </ section > 3. The first heading found or a custom element selector The titleSelector option can be used to customise the elements that will be used to generate the slide titles in the menu. The default option selects the first heading element found in the slide. For example... < section > < h3 > This will be the slide title in the menu </ h3 > < h1 > Title </ h1 > < p > ... </ p > </ section > Any valid CSS selector should work but note the selector will only be applied to elements contained within the slide section. You could use the 'h1' selector to only use level 1 headings or 'p' to use the first paragraph element. For example, titleSelector: 'p.lead' would be used like this... < section > < h1 > Title </ h1 > < p class = \"lead\" > This will be the slide title in the menu </ p > < p > ... </ p > </ section > Using titleSelector: '' will ignore all elements and no title will be provided, unless the slide section contains a data-menu-title attribute or an element with the menu-title class. 4. No title is provided If no title can be found using the above methods, a default title incorporating the slide number will be used. For example, the following would result in a slide title in the format of 'Slide 12'... < section > < p > ... </ p > </ section > If the hideMissingTitles option is set to true , however, the slide will not be listed in the menu. Custom Menu Panels Additional custom panels can be added the menu using the custom option. Reveal . initialize ({ // ... menu : { // ... custom : [ { title : 'Links' , icon : '<i class=\"fa fa-external-link\">' , src : 'links.html' }, { title : 'About' , icon : '<i class=\"fa fa-info\">' , content : '<p>This slidedeck is created with reveal.js</p>' } ] } }); title and icon are used for the toolbar buttons at the top of the menu. There are two approaches you can use to provide content for the panels... You can provide a URL in src to load html from another file. Alternatively, you can provide html in content and this will be added to the custom panel. Custom slide menu items You can provide menu items in your custom panels using the following format. This allows you to define your own navigation links for your presentation. < h1 > Links </ h1 > < ul class = \"slide-menu-items\" > < li class = \"slide-menu-item\" >< a href = \"#/transitions\" > Transitions </ a ></ li > < li class = \"slide-menu-item\" >< a href = \"#/13\" > Code highlighting </ a ></ li > </ ul > You are not limited to linking to presentation slides. You can provide any link you wish. < h1 > External Links </ h1 > < ul class = \"slide-menu-items\" > < li class = \"slide-menu-item\" >< a href = \"https://github.com/denehyg/reveal.js-menu\" target = \"_blank\" > Reveal.js-menu </ a ></ li > < li class = \"slide-menu-item\" >< a href = \"https://github.com/hakimel/reveal.js\" target = \"_blank\" > Reveal.js </ a ></ li > </ ul > Using menu items enables keyboard navigation of your links as with the other panels. However, you don't have to use menu items for your links. You can simply provide standard links and unordered lists in your html. Notice you can provide your custom menu items mixed with other html if you wish. Ready Event A 'menu-ready' event is fired when reveal.js-menu has loaded all non-async dependencies and is ready to start navigating. Reveal . addEventListener ( 'menu-ready' , function ( event ) { // your code } ); License MIT licensed Copyright (C) 2015 Greg Denehy","title":"reveal.js-menu"},{"location":"assets/js/plugin/menu/#revealjs-menu","text":"A slideout menu plugin for Reveal.js to quickly jump to any slide by title. Also optionally change the theme and set the default transition. Check out the live demo","title":"reveal.js-menu"},{"location":"assets/js/plugin/menu/#installation","text":"","title":"Installation"},{"location":"assets/js/plugin/menu/#bower","text":"Download and install the package in your project: bower install reveal.js-menu Add the plugin to the dependencies in your presentation, as below. Reveal . initialize ({ // ... dependencies : [ // ... { src : 'bower_components/reveal.js-menu/menu.js' } ] });","title":"Bower"},{"location":"assets/js/plugin/menu/#npm","text":"Download and install the package in your project: npm install --save reveal.js-menu Add the plugin to the dependencies in your presentation, as below. Reveal . initialize ({ // ... dependencies : [ // ... { src : 'node_modules/reveal.js-menu/menu.js' } ] });","title":"npm"},{"location":"assets/js/plugin/menu/#manual","text":"Copy this repository into the plugins folder of your reveal.js presentation, ie plugins/menu . Add the plugin to the dependencies in your presentation, as below. Reveal . initialize ({ // ... dependencies : [ // ... { src : 'plugin/menu/menu.js' } ] });","title":"Manual"},{"location":"assets/js/plugin/menu/#configuration","text":"You can configure the menu for your presentation by providing a menu option in the reveal.js initialization options. Note that all config values are optional and will default as specified below. Reveal . initialize ({ // ... menu : { // Specifies which side of the presentation the menu will // be shown. Use 'left' or 'right'. side : 'left' , // Add slide numbers to the titles in the slide list. // Use 'true' or format string (same as reveal.js slide numbers) numbers : false , // Specifies which slide elements will be used for generating // the slide titles in the menu. The default selects the first // heading element found in the slide, but you can specify any // valid css selector and the text from the first matching // element will be used. // Note: that a section data-menu-title attribute or an element // with a menu-title class will take precedence over this option titleSelector : 'h1, h2, h3, h4, h5, h6' , // Hide slides from the menu that do not have a title. // Set to 'true' to only list slides with titles. hideMissingTitles : false , // Add markers to the slide titles to indicate the // progress through the presentation markers : false , // Specify custom panels to be included in the menu, by // providing an array of objects with 'title', 'icon' // properties, and either a 'src' or 'content' property. custom : false , // Specifies the themes that will be available in the themes // menu panel. Set to 'false' to hide themes panel. themes : [ { name : 'Black' , theme : 'css/theme/black.css' }, { name : 'White' , theme : 'css/theme/white.css' }, { name : 'League' , theme : 'css/theme/league.css' }, { name : 'Sky' , theme : 'css/theme/sky.css' }, { name : 'Swagger' , theme : 'css/theme/swagger.css' }, { name : 'Beige' , theme : 'css/theme/beige.css' }, { name : 'Simple' , theme : 'css/theme/simple.css' }, { name : 'Serif' , theme : 'css/theme/serif.css' }, { name : 'Blood' , theme : 'css/theme/blood.css' }, { name : 'Night' , theme : 'css/theme/night.css' }, { name : 'Moon' , theme : 'css/theme/moon.css' }, { name : 'Solarized' , theme : 'css/theme/solarized.css' } ], // Specifies if the transitions menu panel will be shown. transitions : true , // Adds a menu button to the slides to open the menu panel. // Set to 'false' to hide the button. openButton : true , // If 'true' allows the slide number in the presentation to // open the menu panel. The reveal.js slideNumber option must // be displayed for this to take effect openSlideNumber : false , // If true allows the user to open and navigate the menu using // the keyboard. Standard keyboard interaction with reveal // will be disabled while the menu is open. keyboard : true }, });","title":"Configuration"},{"location":"assets/js/plugin/menu/#slide-titles","text":"The slide titles used in the menu can be supplied explicitly or are taken directly from the presentation, using the following rules...","title":"Slide Titles"},{"location":"assets/js/plugin/menu/#1-the-sections-data-menu-title-attribute","text":"If the slide's section element contains a data-menu-title attribute this will be used for the slide title in the menu. For example... < section data-menu-title = \"Custom Menu Title\" > < h1 > Title </ h1 > < p > ... </ p > </ section >","title":"1. The section's data-menu-title attribute."},{"location":"assets/js/plugin/menu/#2-any-element-with-the-class-menu-title","text":"If the slide's section contains an element with the class menu-title then the element's text will be used for the title. The first such element found will be used if there are more than one. Note the element need not be displayed to be used. For example... < section > < h1 > Title </ h1 > < span class = \"menu-title\" style = \"display: none\" > Custom Menu Title </ span > < p > ... </ p > </ section >","title":"2. Any element with the class menu-title."},{"location":"assets/js/plugin/menu/#3-the-first-heading-found-or-a-custom-element-selector","text":"The titleSelector option can be used to customise the elements that will be used to generate the slide titles in the menu. The default option selects the first heading element found in the slide. For example... < section > < h3 > This will be the slide title in the menu </ h3 > < h1 > Title </ h1 > < p > ... </ p > </ section > Any valid CSS selector should work but note the selector will only be applied to elements contained within the slide section. You could use the 'h1' selector to only use level 1 headings or 'p' to use the first paragraph element. For example, titleSelector: 'p.lead' would be used like this... < section > < h1 > Title </ h1 > < p class = \"lead\" > This will be the slide title in the menu </ p > < p > ... </ p > </ section > Using titleSelector: '' will ignore all elements and no title will be provided, unless the slide section contains a data-menu-title attribute or an element with the menu-title class.","title":"3. The first heading found or a custom element selector"},{"location":"assets/js/plugin/menu/#4-no-title-is-provided","text":"If no title can be found using the above methods, a default title incorporating the slide number will be used. For example, the following would result in a slide title in the format of 'Slide 12'... < section > < p > ... </ p > </ section > If the hideMissingTitles option is set to true , however, the slide will not be listed in the menu.","title":"4. No title is provided"},{"location":"assets/js/plugin/menu/#custom-menu-panels","text":"Additional custom panels can be added the menu using the custom option. Reveal . initialize ({ // ... menu : { // ... custom : [ { title : 'Links' , icon : '<i class=\"fa fa-external-link\">' , src : 'links.html' }, { title : 'About' , icon : '<i class=\"fa fa-info\">' , content : '<p>This slidedeck is created with reveal.js</p>' } ] } }); title and icon are used for the toolbar buttons at the top of the menu. There are two approaches you can use to provide content for the panels... You can provide a URL in src to load html from another file. Alternatively, you can provide html in content and this will be added to the custom panel.","title":"Custom Menu Panels"},{"location":"assets/js/plugin/menu/#custom-slide-menu-items","text":"You can provide menu items in your custom panels using the following format. This allows you to define your own navigation links for your presentation. < h1 > Links </ h1 > < ul class = \"slide-menu-items\" > < li class = \"slide-menu-item\" >< a href = \"#/transitions\" > Transitions </ a ></ li > < li class = \"slide-menu-item\" >< a href = \"#/13\" > Code highlighting </ a ></ li > </ ul > You are not limited to linking to presentation slides. You can provide any link you wish. < h1 > External Links </ h1 > < ul class = \"slide-menu-items\" > < li class = \"slide-menu-item\" >< a href = \"https://github.com/denehyg/reveal.js-menu\" target = \"_blank\" > Reveal.js-menu </ a ></ li > < li class = \"slide-menu-item\" >< a href = \"https://github.com/hakimel/reveal.js\" target = \"_blank\" > Reveal.js </ a ></ li > </ ul > Using menu items enables keyboard navigation of your links as with the other panels. However, you don't have to use menu items for your links. You can simply provide standard links and unordered lists in your html. Notice you can provide your custom menu items mixed with other html if you wish.","title":"Custom slide menu items"},{"location":"assets/js/plugin/menu/#ready-event","text":"A 'menu-ready' event is fired when reveal.js-menu has loaded all non-async dependencies and is ready to start navigating. Reveal . addEventListener ( 'menu-ready' , function ( event ) { // your code } );","title":"Ready Event"},{"location":"assets/js/plugin/menu/#license","text":"MIT licensed Copyright (C) 2015 Greg Denehy","title":"License"},{"location":"notes/2019/k8s/harbor_install/","text":"\u5728k8s\u4e0a\u642d\u5efaharbor \u65f6\u6548\u6027: 2019\u5e74\u4e2d \u51c6\u5907\u4e8b\u5b9c k8s\u96c6\u7fa4 helm3 harbor helmchart nginx ingress controller nfs share server & nfs pv \u76f8\u5173\u8fde\u63a5 helm releases harbor helm chart nginx ingress controller \u4e00\u4e9b\u8aaa\u660e harbor\u672c\u8eab\u6709\u5f88\u591a\u7d44\u4ef6\uff0c\u6bd4\u5982\u6700\u6838\u5fc3\u7684\u4e09\u65b9\u7d44\u4ef6registry\u4ee5\u53ca\u5b58\u653ehelmchart\u7684chartmusuem\uff0c \u4ee5\u53ca\u7528\u4e8e\u6f0f\u6d1e\u626b\u63cf\u7684clair, \u5b58\u50a8\u548c\u7f13\u5b58\u7528\u7684postgres\u548credis\uff0c\u8dd1\u4efb\u52a1\u7528\u7684jobservice\u7b49 \u4e0b\u9762\u4e3a\u6210\u529f\u90e8\u7f72\u540e\u7684deployment harbor-harbor-chartmuseum 1 /1 1 1 2d16h harbor-harbor-clair 1 /1 1 1 2d16h harbor-harbor-core 1 /1 1 1 2d16h harbor-harbor-jobservice 1 /1 1 1 2d16h harbor-harbor-notary-server 1 /1 1 1 2d16h harbor-harbor-notary-signer 1 /1 1 1 2d16h harbor-harbor-portal 1 /1 1 1 2d16h harbor-harbor-registry 1 /1 1 1 2d16h \u4e0b\u9762\u65f6\u6210\u529f\u90e8\u7f72\u540e\u7684pod harbor-harbor-chartmuseum-69c9cdcbf8-gmnl7 1 /1 Running 5 2d16h harbor-harbor-clair-c9757f6cb-nq6zk 1 /1 Running 14 2d5h harbor-harbor-core-7c44cfc7f-xp9nm 1 /1 Running 10 2d16h harbor-harbor-database-0 1 /1 Running 5 2d16h harbor-harbor-jobservice-d5db6cc65-csg94 1 /1 Running 11 2d16h harbor-harbor-notary-server-79f8d8b8b8-hld8l 1 /1 Running 9 2d5h harbor-harbor-notary-signer-86cb6fb8bf-xqv2x 1 /1 Running 11 2d5h harbor-harbor-portal-7dddbf759c-8w7s8 1 /1 Running 5 2d16h harbor-harbor-redis-0 1 /1 Running 5 2d16h harbor-harbor-registry-5c499d8d49-h7h7r 2 /2 Running 10 2d16h \u56e0\u4e3a\u76f8\u5bf9\u6bd4\u8f83\u590d\u6742\uff0c\u6240\u4ee5\u53ef\u4ee5\u8003\u8651\u4f7f\u7528helm\u7684chart\u5305\u5b8c\u6210\u90e8\u7f72\uff0c\u8981\u6ce8\u610f\u7684\u662fhelm\u6700\u8fd1\u53d1\u5e03\u4e86\u6700\u65b0\u7684v3\u7248\u672c\uff0c\u548cv2\u7248\u672c\u76f8\u6bd4\uff0c\u53bb\u9664\u4e86\u670d\u52a1\u7aef\u7684tiller\u670d\u52a1\uff0c\u66f4\u52a0\u7b80\u5355\uff0charbor\u7684helm\u6a21\u677f\u53ef\u4ee5\u4f7f\u7528helm v3\u7248\u672c\u8fdb\u884c\u90e8\u7f72\u3002 \u914d\u7f6epv\u548cpvc helm\u7684\u914d\u7f6e\u96c6\u4e2d\u5728values.yaml\u4e2d\u8bbe\u7f6e\uff0c\u8fd9\u91cc\u9996\u5148\u8981\u8003\u8651\u7684\u662fpv\u548cpvc\u7684\u8bbe\u7f6e persistence : enabled : true # Setting it to \"keep\" to avoid removing PVCs during a helm delete # operation. Leaving it empty will delete PVCs after the chart deleted resourcePolicy : \"keep\" persistentVolumeClaim : registry : # Use the existing PVC which must be created manually before bound, # and specify the \"subPath\" if the PVC is shared with other components existingClaim : \"harbor-registry\" # Specify the \"storageClass\" used to provision the volume. Or the default # StorageClass will be used(the default). # Set it to \"-\" to disable dynamic provisioning storageClass : \"\" subPath : \"\" accessMode : ReadWriteMany size : 5Gi chartmuseum : existingClaim : \"harbor-chartmuseum\" storageClass : \"\" subPath : \"\" accessMode : ReadWriteMany size : 5Gi jobservice : existingClaim : \"harbor-jobservice\" storageClass : \"\" subPath : \"\" accessMode : ReadWriteMany size : 1Gi # If external database is used, the following settings for database will # be ignored database : existingClaim : \"harbor-database\" storageClass : \"\" subPath : \"\" accessMode : ReadWriteMany size : 1Gi \u4e00\u822c\u6765\u8bf4helm\u7684\u914d\u7f6e\u4e0d\u4f1a\u5177\u4f53\u9650\u5b9a\u4f7f\u7528\u54ea\u4e00\u4e2apv\uff0c \u800c\u662f\u53ea\u662f\u786e\u5b9a\u4e00\u4e2a\u5bf9\u5e94\u7684pvc\u540d\u79f0\u3002\u6211\u4eec\u8fd9\u91cc\u4fee\u6539pvc\u540d\u5b57\u4e3a\u81ea\u5df1\u60f3\u8981\u7684pvc \u7136\u540e\u8fd9\u91cc\u7ed9\u51fa\u914d\u7f6epv\u7684\u4e24\u79cd\u76f8\u5bf9\u53ef\u884c\u4e5f\u76f8\u5bf9\u7b80\u5355\u7684\u65b9\u5f0f \u7b2c\u4e00\u79cd\u662f\u4f7f\u7528local \u7684hostpath\u7c7b\u578b\u7684pv\uff0c\u4f46\u662f\u8981\u6ce8\u610f\uff0c\u6bcf\u4e00\u4e2apv\u6700\u597d\u72ec\u7acb\u4f7f\u7528\u4e00\u4e2a\u76ee\u5f55\uff0c\u4e0d\u8981\u6df7\u642d\uff0c\u5177\u4f53\u539f\u56e0\u89c1 \u95ee\u9898 \u8fd9\u91cc\u5217\u4e3e\u4e00\u4f8b kind : PersistentVolume metadata : name : harbor-registry namespace : harbor spec : capacity : storage : 5Gi accessModes : - ReadWriteOnce hostPath : path : /home/harbor/registry --- kind : PersistentVolumeClaim apiVersion : v1 metadata : name : harbor-registry namespace : harbor spec : accessModes : - ReadWriteOnce resources : requests : storage : 5Gi volumeName : \"harbor-registry\" \u53e6\u4e00\u79cd\u4e5f\u6bd4\u8f83\u7b80\u5355\u7684\u65b9\u5f0f\u662f\u4f7f\u7528nfs\u5377\u8fdb\u884c\u6302\u8f7d apiVersion : v1 kind : PersistentVolume metadata : name : harbor-registry namespace : harbor spec : capacity : storage : 5Gi accessModes : - ReadWriteMany nfs : # FIXME: use the right IP server : 172.19.0.11 path : \"/var/nfsshare/registry\" persistentVolumeReclaimPolicy : Recycle --- kind : PersistentVolumeClaim apiVersion : v1 metadata : name : harbor-registry namespace : harbor spec : accessModes : - ReadWriteMany resources : requests : storage : 5Gi volumeName : \"harbor-registry\" \u8fd9\u91cc\u8981\u6ce8\u610f\u7684\u662fhostpath\u6a21\u5f0f\u662f\u4e0d\u652f\u6301\u591a\u673a\u5171\u4eab\u5199\u5165\u7684\uff0c\u6240\u4ee5\u53ea\u80fdReadWriteOnce,\u4e0d\u80fd\u4f7f\u7528ReadWriteMany\uff0c \u53ef\u4ee5\u901a\u8fc7volumeName\u8bbe\u7f6epvc\u548cpv\u7ed1\u5b9a\uff0c\u540c\u65f6\u4e5f\u53ef\u901a\u8fc7nodeAffinity\u7ed1\u5b9a\u8282\u70b9\u3002 \u800cnfs\u5377\u5219\u8981\u914d\u7f6e\u76f8\u5e94\u7684server\u548cpath\uff08nfs\u5b89\u88c5\u89c1\u540e\u6587\uff09 \u540c\u65f6\u5efa\u8bae\u6bcf\u4e00\u4e2a\u7ec4\u4ef6\u4f7f\u7528\u72ec\u7acb\u7684\u76ee\u5f55\uff0c\u4e0d\u8981\u6df7\u7528\u3002 \u914d\u7f6enginx ingress controller \u6211\u4eec\u8fd9\u91cc\u4f7f\u7528\u72ec\u7acb\u7684ingress controller, \u53ef\u4ee5\u4f7f\u7528 nginx-ingress nginx ingress controller\u53ef\u4ee5\u4f7f\u7528\u591a\u79cd\u65b9\u5f0f\u90e8\u7f72\uff08\u6bd4\u5982pod\u6216daemonset\uff09\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528helm\u5b8c\u6210\u90e8\u7f72\u3002 \u8fd9\u91cc\u7ed9\u51fadaemonset\u76f4\u63a5\u914d\u7f6e\u7684\u90e8\u7f72\u65b9\u5f0f kubectl apply -f common/ns-and-sa.yaml kubectl apply -f common/default-server-secret.yaml kubectl apply -f common/nginx-config.yaml kubectl apply -f rbac/rbac.yaml kubectl apply -f daemon-set/nginx-ingress.yaml \u8fd9\u91cc\u8981\u6ce8\u610f\u7684\u662f\uff0c\u4e3a\u4e86\u4fdd\u8bc1\u540e\u9762\u955c\u50cf\u80fd\u591f\u901a\u8fc7\u8fd9\u5c42ingress\u6b63\u5e38\u63a8\u9001\uff0c\u9700\u8981\u4fee\u6539common/nginx-config.yaml\u4e2d\u5173\u4e8ebody\u5c3a\u5bf8\u7684\u9650\u5236\uff0c \u7c7b\u4f3c\u5982\u4e0b kind : ConfigMap apiVersion : v1 metadata : name : nginx-config namespace : nginx-ingress data : proxy-connect-timeout : \"10s\" proxy-read-timeout : \"10s\" client-max-body-size : \"100m\" \u90e8\u7f72harbor \u4fee\u6539harbor\u7684helmchart\u7684values\u76ee\u5f55\u540e\uff0c\u53ef\u4ee5\u5728harbor-helm\u7684\u76ee\u5f55\u4e0b\uff08\u5e26\u6709values.yaml\u6587\u4ef6\u7684\u76ee\u5f55\uff09\u6267\u884c helm install harbor --namespace=harbor . \u5982\u679c\u90e8\u7f72\u53d1\u73b0\u95ee\u9898\uff0c\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u5220\u9664 helm uninstall --namespace harbor harbor nfs service\u7aef\u5b89\u88c5 \u5b89\u88c5\u5305 sudo apt-get install nfs-kernel-server nfs-common \u521b\u5efa\u5171\u4eab\u76ee\u5f55 sudo mkdir -p /var/nfsshare/xxx sudo chmod -R 777 /var/nfsshare/xxx \u5728 /etc/exports \u52a0\u5165 /var/nfsshare/xxx xxx.xxx.xxx.* ( rw,sync,no_root_squash,no_all_squash ) \u6216\u8005\u7c7b\u4f3c /var/nfsshare/xxx * ( rw,sync,no_root_squash,no_all_squash ) \u542f\u52a8\u670d\u52a1 /etc/init.d/nfs-kernel-server restart","title":"\u5728k8s\u4e0a\u642d\u5efaharbor"},{"location":"notes/2019/k8s/harbor_install/#k8sharbor","text":"\u65f6\u6548\u6027: 2019\u5e74\u4e2d \u51c6\u5907\u4e8b\u5b9c k8s\u96c6\u7fa4 helm3 harbor helmchart nginx ingress controller nfs share server & nfs pv \u76f8\u5173\u8fde\u63a5 helm releases harbor helm chart nginx ingress controller \u4e00\u4e9b\u8aaa\u660e harbor\u672c\u8eab\u6709\u5f88\u591a\u7d44\u4ef6\uff0c\u6bd4\u5982\u6700\u6838\u5fc3\u7684\u4e09\u65b9\u7d44\u4ef6registry\u4ee5\u53ca\u5b58\u653ehelmchart\u7684chartmusuem\uff0c \u4ee5\u53ca\u7528\u4e8e\u6f0f\u6d1e\u626b\u63cf\u7684clair, \u5b58\u50a8\u548c\u7f13\u5b58\u7528\u7684postgres\u548credis\uff0c\u8dd1\u4efb\u52a1\u7528\u7684jobservice\u7b49 \u4e0b\u9762\u4e3a\u6210\u529f\u90e8\u7f72\u540e\u7684deployment harbor-harbor-chartmuseum 1 /1 1 1 2d16h harbor-harbor-clair 1 /1 1 1 2d16h harbor-harbor-core 1 /1 1 1 2d16h harbor-harbor-jobservice 1 /1 1 1 2d16h harbor-harbor-notary-server 1 /1 1 1 2d16h harbor-harbor-notary-signer 1 /1 1 1 2d16h harbor-harbor-portal 1 /1 1 1 2d16h harbor-harbor-registry 1 /1 1 1 2d16h \u4e0b\u9762\u65f6\u6210\u529f\u90e8\u7f72\u540e\u7684pod harbor-harbor-chartmuseum-69c9cdcbf8-gmnl7 1 /1 Running 5 2d16h harbor-harbor-clair-c9757f6cb-nq6zk 1 /1 Running 14 2d5h harbor-harbor-core-7c44cfc7f-xp9nm 1 /1 Running 10 2d16h harbor-harbor-database-0 1 /1 Running 5 2d16h harbor-harbor-jobservice-d5db6cc65-csg94 1 /1 Running 11 2d16h harbor-harbor-notary-server-79f8d8b8b8-hld8l 1 /1 Running 9 2d5h harbor-harbor-notary-signer-86cb6fb8bf-xqv2x 1 /1 Running 11 2d5h harbor-harbor-portal-7dddbf759c-8w7s8 1 /1 Running 5 2d16h harbor-harbor-redis-0 1 /1 Running 5 2d16h harbor-harbor-registry-5c499d8d49-h7h7r 2 /2 Running 10 2d16h \u56e0\u4e3a\u76f8\u5bf9\u6bd4\u8f83\u590d\u6742\uff0c\u6240\u4ee5\u53ef\u4ee5\u8003\u8651\u4f7f\u7528helm\u7684chart\u5305\u5b8c\u6210\u90e8\u7f72\uff0c\u8981\u6ce8\u610f\u7684\u662fhelm\u6700\u8fd1\u53d1\u5e03\u4e86\u6700\u65b0\u7684v3\u7248\u672c\uff0c\u548cv2\u7248\u672c\u76f8\u6bd4\uff0c\u53bb\u9664\u4e86\u670d\u52a1\u7aef\u7684tiller\u670d\u52a1\uff0c\u66f4\u52a0\u7b80\u5355\uff0charbor\u7684helm\u6a21\u677f\u53ef\u4ee5\u4f7f\u7528helm v3\u7248\u672c\u8fdb\u884c\u90e8\u7f72\u3002","title":"\u5728k8s\u4e0a\u642d\u5efaharbor"},{"location":"notes/2019/k8s/harbor_install/#pvpvc","text":"helm\u7684\u914d\u7f6e\u96c6\u4e2d\u5728values.yaml\u4e2d\u8bbe\u7f6e\uff0c\u8fd9\u91cc\u9996\u5148\u8981\u8003\u8651\u7684\u662fpv\u548cpvc\u7684\u8bbe\u7f6e persistence : enabled : true # Setting it to \"keep\" to avoid removing PVCs during a helm delete # operation. Leaving it empty will delete PVCs after the chart deleted resourcePolicy : \"keep\" persistentVolumeClaim : registry : # Use the existing PVC which must be created manually before bound, # and specify the \"subPath\" if the PVC is shared with other components existingClaim : \"harbor-registry\" # Specify the \"storageClass\" used to provision the volume. Or the default # StorageClass will be used(the default). # Set it to \"-\" to disable dynamic provisioning storageClass : \"\" subPath : \"\" accessMode : ReadWriteMany size : 5Gi chartmuseum : existingClaim : \"harbor-chartmuseum\" storageClass : \"\" subPath : \"\" accessMode : ReadWriteMany size : 5Gi jobservice : existingClaim : \"harbor-jobservice\" storageClass : \"\" subPath : \"\" accessMode : ReadWriteMany size : 1Gi # If external database is used, the following settings for database will # be ignored database : existingClaim : \"harbor-database\" storageClass : \"\" subPath : \"\" accessMode : ReadWriteMany size : 1Gi \u4e00\u822c\u6765\u8bf4helm\u7684\u914d\u7f6e\u4e0d\u4f1a\u5177\u4f53\u9650\u5b9a\u4f7f\u7528\u54ea\u4e00\u4e2apv\uff0c \u800c\u662f\u53ea\u662f\u786e\u5b9a\u4e00\u4e2a\u5bf9\u5e94\u7684pvc\u540d\u79f0\u3002\u6211\u4eec\u8fd9\u91cc\u4fee\u6539pvc\u540d\u5b57\u4e3a\u81ea\u5df1\u60f3\u8981\u7684pvc \u7136\u540e\u8fd9\u91cc\u7ed9\u51fa\u914d\u7f6epv\u7684\u4e24\u79cd\u76f8\u5bf9\u53ef\u884c\u4e5f\u76f8\u5bf9\u7b80\u5355\u7684\u65b9\u5f0f \u7b2c\u4e00\u79cd\u662f\u4f7f\u7528local \u7684hostpath\u7c7b\u578b\u7684pv\uff0c\u4f46\u662f\u8981\u6ce8\u610f\uff0c\u6bcf\u4e00\u4e2apv\u6700\u597d\u72ec\u7acb\u4f7f\u7528\u4e00\u4e2a\u76ee\u5f55\uff0c\u4e0d\u8981\u6df7\u642d\uff0c\u5177\u4f53\u539f\u56e0\u89c1 \u95ee\u9898 \u8fd9\u91cc\u5217\u4e3e\u4e00\u4f8b kind : PersistentVolume metadata : name : harbor-registry namespace : harbor spec : capacity : storage : 5Gi accessModes : - ReadWriteOnce hostPath : path : /home/harbor/registry --- kind : PersistentVolumeClaim apiVersion : v1 metadata : name : harbor-registry namespace : harbor spec : accessModes : - ReadWriteOnce resources : requests : storage : 5Gi volumeName : \"harbor-registry\" \u53e6\u4e00\u79cd\u4e5f\u6bd4\u8f83\u7b80\u5355\u7684\u65b9\u5f0f\u662f\u4f7f\u7528nfs\u5377\u8fdb\u884c\u6302\u8f7d apiVersion : v1 kind : PersistentVolume metadata : name : harbor-registry namespace : harbor spec : capacity : storage : 5Gi accessModes : - ReadWriteMany nfs : # FIXME: use the right IP server : 172.19.0.11 path : \"/var/nfsshare/registry\" persistentVolumeReclaimPolicy : Recycle --- kind : PersistentVolumeClaim apiVersion : v1 metadata : name : harbor-registry namespace : harbor spec : accessModes : - ReadWriteMany resources : requests : storage : 5Gi volumeName : \"harbor-registry\" \u8fd9\u91cc\u8981\u6ce8\u610f\u7684\u662fhostpath\u6a21\u5f0f\u662f\u4e0d\u652f\u6301\u591a\u673a\u5171\u4eab\u5199\u5165\u7684\uff0c\u6240\u4ee5\u53ea\u80fdReadWriteOnce,\u4e0d\u80fd\u4f7f\u7528ReadWriteMany\uff0c \u53ef\u4ee5\u901a\u8fc7volumeName\u8bbe\u7f6epvc\u548cpv\u7ed1\u5b9a\uff0c\u540c\u65f6\u4e5f\u53ef\u901a\u8fc7nodeAffinity\u7ed1\u5b9a\u8282\u70b9\u3002 \u800cnfs\u5377\u5219\u8981\u914d\u7f6e\u76f8\u5e94\u7684server\u548cpath\uff08nfs\u5b89\u88c5\u89c1\u540e\u6587\uff09 \u540c\u65f6\u5efa\u8bae\u6bcf\u4e00\u4e2a\u7ec4\u4ef6\u4f7f\u7528\u72ec\u7acb\u7684\u76ee\u5f55\uff0c\u4e0d\u8981\u6df7\u7528\u3002","title":"\u914d\u7f6epv\u548cpvc"},{"location":"notes/2019/k8s/harbor_install/#nginx-ingress-controller","text":"\u6211\u4eec\u8fd9\u91cc\u4f7f\u7528\u72ec\u7acb\u7684ingress controller, \u53ef\u4ee5\u4f7f\u7528 nginx-ingress nginx ingress controller\u53ef\u4ee5\u4f7f\u7528\u591a\u79cd\u65b9\u5f0f\u90e8\u7f72\uff08\u6bd4\u5982pod\u6216daemonset\uff09\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528helm\u5b8c\u6210\u90e8\u7f72\u3002 \u8fd9\u91cc\u7ed9\u51fadaemonset\u76f4\u63a5\u914d\u7f6e\u7684\u90e8\u7f72\u65b9\u5f0f kubectl apply -f common/ns-and-sa.yaml kubectl apply -f common/default-server-secret.yaml kubectl apply -f common/nginx-config.yaml kubectl apply -f rbac/rbac.yaml kubectl apply -f daemon-set/nginx-ingress.yaml \u8fd9\u91cc\u8981\u6ce8\u610f\u7684\u662f\uff0c\u4e3a\u4e86\u4fdd\u8bc1\u540e\u9762\u955c\u50cf\u80fd\u591f\u901a\u8fc7\u8fd9\u5c42ingress\u6b63\u5e38\u63a8\u9001\uff0c\u9700\u8981\u4fee\u6539common/nginx-config.yaml\u4e2d\u5173\u4e8ebody\u5c3a\u5bf8\u7684\u9650\u5236\uff0c \u7c7b\u4f3c\u5982\u4e0b kind : ConfigMap apiVersion : v1 metadata : name : nginx-config namespace : nginx-ingress data : proxy-connect-timeout : \"10s\" proxy-read-timeout : \"10s\" client-max-body-size : \"100m\"","title":"\u914d\u7f6enginx ingress controller"},{"location":"notes/2019/k8s/harbor_install/#harbor","text":"\u4fee\u6539harbor\u7684helmchart\u7684values\u76ee\u5f55\u540e\uff0c\u53ef\u4ee5\u5728harbor-helm\u7684\u76ee\u5f55\u4e0b\uff08\u5e26\u6709values.yaml\u6587\u4ef6\u7684\u76ee\u5f55\uff09\u6267\u884c helm install harbor --namespace=harbor . \u5982\u679c\u90e8\u7f72\u53d1\u73b0\u95ee\u9898\uff0c\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u5220\u9664 helm uninstall --namespace harbor harbor","title":"\u90e8\u7f72harbor"},{"location":"notes/2019/k8s/harbor_install/#nfs-service","text":"\u5b89\u88c5\u5305 sudo apt-get install nfs-kernel-server nfs-common \u521b\u5efa\u5171\u4eab\u76ee\u5f55 sudo mkdir -p /var/nfsshare/xxx sudo chmod -R 777 /var/nfsshare/xxx \u5728 /etc/exports \u52a0\u5165 /var/nfsshare/xxx xxx.xxx.xxx.* ( rw,sync,no_root_squash,no_all_squash ) \u6216\u8005\u7c7b\u4f3c /var/nfsshare/xxx * ( rw,sync,no_root_squash,no_all_squash ) \u542f\u52a8\u670d\u52a1 /etc/init.d/nfs-kernel-server restart","title":"nfs service\u7aef\u5b89\u88c5"},{"location":"notes/2020/bi/superset/quick_look/","text":"pip install apache-superset -i https://mirrors.aliyun.com/pypi/simple/ superset version superset --version ~/.superset/superset.db .schema dbs CREATE TABLE IF NOT EXISTS \"dbs\" ( created_on DATETIME NOT NULL, changed_on DATETIME NOT NULL, id INTEGER NOT NULL, database_name VARCHAR(250) NOT NULL, sqlalchemy_uri VARCHAR(1024) NOT NULL, created_by_fk INTEGER, changed_by_fk INTEGER, password BLOB, cache_timeout INTEGER, extra TEXT, select_as_create_table_as BOOLEAN, allow_ctas BOOLEAN, expose_in_sqllab BOOLEAN, force_ctas_schema VARCHAR(250), allow_run_async BOOLEAN, allow_dml BOOLEAN, perm VARCHAR(1000), verbose_name VARCHAR(250), impersonate_user BOOLEAN, allow_multi_schema_metadata_fetch BOOLEAN, allow_csv_upload BOOLEAN DEFAULT 1 NOT NULL, encrypted_extra BLOB, server_cert BLOB, PRIMARY KEY (id), CHECK (select_as_create_table_as IN (0, 1)), CHECK (allow_ctas IN (0, 1)), CHECK (expose_in_sqllab IN (0, 1)), CHECK (allow_run_async IN (0, 1)), CHECK (allow_dml IN (0, 1)), CHECK (impersonate_user IN (0, 1)), CHECK (allow_multi_schema_metadata_fetch IN (0, 1)), CHECK (allow_csv_upload IN (0, 1)), UNIQUE (database_name), FOREIGN KEY(created_by_fk) REFERENCES ab_user (id), FOREIGN KEY(changed_by_fk) REFERENCES ab_user (id) ); superset db upgrade \u95ee\u9898 fabmanager create-admin --app superset fabmanager is going to be deprecated in 2.2.X, you can use the same commands on the improved 'flask fab <command>' Username [admin]: User first name [admin]: User last name [user]: Email [admin@fab.org]: Password: Repeat for confirmation: Traceback (most recent call last): File \"/home/dameng/.pyenv/versions/supers/bin/fabmanager\", line 10, in <module> sys.exit(cli()) File \"/home/dameng/.pyenv/versions/3.7.6/envs/supers/lib/python3.7/site-packages/flask_appbuilder/console.py\", line 422, in cli cli_app() File \"/home/dameng/.pyenv/versions/3.7.6/envs/supers/lib/python3.7/site-packages/click/core.py\", line 829, in __call__ return self.main(*args, **kwargs) File \"/home/dameng/.pyenv/versions/3.7.6/envs/supers/lib/python3.7/site-packages/click/core.py\", line 782, in main rv = self.invoke(ctx) File \"/home/dameng/.pyenv/versions/3.7.6/envs/supers/lib/python3.7/site-packages/click/core.py\", line 1259, in invoke return _process_result(sub_ctx.command.invoke(sub_ctx)) File \"/home/dameng/.pyenv/versions/3.7.6/envs/supers/lib/python3.7/site-packages/click/core.py\", line 1066, in invoke return ctx.invoke(self.callback, **ctx.params) File \"/home/dameng/.pyenv/versions/3.7.6/envs/supers/lib/python3.7/site-packages/click/core.py\", line 610, in invoke return callback(*args, **kwargs) File \"/home/dameng/.pyenv/versions/3.7.6/envs/supers/lib/python3.7/site-packages/flask_appbuilder/console.py\", line 137, in create_admin auth_type.get(_appbuilder.sm.auth_type, \"No Auth method\") AttributeError: 'NoneType' object has no attribute 'auth_type' fabmanager is going to be deprecated in 2.2.X, you can use the same commands on the improved 'flask fab <command>' flask fab create-admin select * from ab_user; 1|admin|user|admin|pbkdf2:sha256:150000$WdqYWjRS$51d35a36a3ccf9cf35a5c8b64c1ba0529756a568c6c5c700913620e8639e4fce|1|admin@fab.org||||2020-08-04 10:48:48.236493|2020-08-04 10:48:48.236503|| flask fab list-users List of users ------------- username:admin | email:admin@fab.org | role:[Admin] superset db migrate flask fab create-admin superset db init flask db stamp head flask db migrate flask fab create-admin","title":"Quick look"},{"location":"notes/2020/crypt/fun_crypt/","text":"\u73b0\u4ee3\u5bc6\u7801\u5b66\u4e4b\u6d88\u606f\u7684\u901a\u8baf \u4ee5\u4e0b\u7684\u5185\u5bb9\u6574\u7406\u81eaVita\u541b\u7684\u7238\u7238\u5468\u81ea\u6052\u8001\u5e08\u6700\u8fd1\u65b0\u4e66\u300a\u56fe\u89e3\u5bc6\u7801\u6280\u672f\u300b\u63a8\u4ecb\u65f6\u56fe\u7075\u793e\u533a\u7684\u5206\u4eab\u7684\u90e8\u5206\u5185\u5bb9\uff0c\u867d\u7136\u4ece\u4e2a\u4eba\u7684\u89d2\u5ea6\u6765\u8bf4\uff0c\u5927\u90e8\u5206\u5185\u5bb9\u5df2\u7ecf\u77e5\u6653\uff0c\u4f46\u957f\u65f6\u95f4\u4e0d\u7528\u591a\u5c11\u8fd8\u662f\u6709\u4e9b\u751f\u758f\uff0c\u5728\u5468\u8001\u5e08\u5faa\u5e8f\u6e10\u8fdb\u7684\u8bb2\u8ff0\u4e0b\u66f4\u6709\u878d\u4f1a\u8d2f\u901a\u4e4b\u611f\uff0c\u8fd9\u91cc\u8bb0\u5f55\u4e00\u4e0b\uff0c\u4ee5\u5907\u4e0d\u65f6\u4e4b\u9700\u3002 \u4fe1\u606f\u5b89\u5168\u9762\u4e34\u7684\u5a01\u80c1 \u4fe1\u606f\u5b89\u5168\u8981\u89e3\u51b3\u7684\u95ee\u9898\uff0c\u4e00\u5b9a\u6e90\u81ea\u4e8e\u771f\u5b9e\u7684\u6848\u4f8b\uff0c\u5728\u5b9e\u9645\u7684\u6d88\u606f\u901a\u8baf\u4e2d\uff0c\u5176\u9762\u4e34\u7740\u5982\u4e0b\u51e0\u79cd\u7c7b\u578b\u7684\u5a01\u80c1 - \u7a83\u542c\uff08\u79c1\u5bc6\u4fe1\u606f\u7684\u6cc4\u6f0f\uff09 - \u7be1\u6539\uff08\u4fe1\u606f\u88ab\u4fee\u6539\uff09 - \u5047\u5192\uff08\u4f2a\u88c5\u6210\u4fe1\u606f\u7684\u53d1\u9001\u8005\uff09 - \u5426\u8ba4\uff08\u4fe1\u606f\u5df2\u7ecf\u53d1\u9001\uff0c\u4f46\u662f\u4e8b\u540e\u5374\u4e0d\u627f\u8ba4\uff09 \u7a83\u542c alice\u5728\u60f3bob\u8ba8\u9152\u559d\u7684\u65f6\u5019\uff0c\u4fe1\u606f\u9762\u4e34\u7740\u88abX\u7a83\u542c\u7684\u53ef\u80fd\u3002\u8fd9\u79cd\u60c5\u51b5\u975e\u5e38\u5e38\u89c1\uff0c\u4efb\u4f55\u901a\u8baf\u4e2d\u95f4\u8282\u70b9\u53ea\u8981\u88ab\u5229\u7528\uff0c\u90fd\u53ef\u4ee5\u505a\u5230\u8fd9\u4e00\u70b9\uff0c\u751a\u81f3\u662f\u5c40\u57df\u7f51\u5185\u7684\u6df7\u6742\u6a21\u5f0f\u7684\u6293\u5305\u4e5f\u80fd\u83b7\u5f97\u90e8\u5206\u4fe1\u606f\u3002 \u7be1\u6539 \u5982\u56fe\uff0cX\u5728\u53d1\u51fa\u8ba8\u9152\u7684\u8bf7\u6c42\u65f6\u88abX\u62e6\u622a\u4e86\uff0cX\u4ec5\u4ec5\u662f\u4fee\u6539\u4e86\u6536\u8d27\u5730\u5740\uff0c\u5f53Alice\u5c1d\u8bd5\u8be2\u95eeBob\u9152\uff08\u94b1\uff09\u5728\u4f55\u65b9\u65f6\uff0cBob\u5c31\u5f7b\u5e95\u8499\u5708\u4e86\u3002 \u5047\u5192 X\u76f4\u63a5\u4f2a\u88c5\u6210\u4e86Alice\u5411Bob\u8ba8\u9152\u559d\uff0cBob\u7ed9\u4e86\u540e\u518d\u8981\u6c42Alice\u507f\u8fd8\u76f8\u5e94\u7684\uff08\u9152\u94b1\uff09\u65f6\uff0c\u5c31\u8f6e\u5230Alice\u8499\u5708\u4e86 \u5426\u8ba4 \u8fd9\u79cd\u60c5\u5f62\u4e0b\uff0cAlice\u5e94\u8be5\u65f6\u4e2a\u8001\u9152\u9b3c\u4e86\uff0c\u501f\u4e86\u9152\u559d\u5374\u4e0d\u7ed9\u94b1\u4e0d\u8ba4\u8d26\u4e86 \u5bf9\u5e94\u7684\u89e3\u51b3\u65b9\u5f0f \u4e0a\u6587\u4e2d\u4ecb\u7ecd\u7684\u56db\u7c7b\u5a01\u80c1\uff0c\u5206\u522b\u5bf9\u5e94\u4e86\u56db\u79cd\u7279\u6027\u3002\u73b0\u4ee3\u5bc6\u7801\u5b66\u4e2d\u4e5f\u6709\u5bf9\u5e94\u7684\u65b9\u5f0f\u6765\u89e3\u51b3\u5404\u4e2a\u95ee\u9898 \u975e\u5bf9\u79f0\u52a0\u5bc6 \u8fd9\u91cc\u9762\u505a\u8fd9\u6837\u4e00\u4e2a\u7ea6\u5b9a\uff0c\u975e\u5bf9\u79f0\u52a0\u5bc6\u4e2d\u6709\u6210\u5bf9\u51fa\u73b0\u7684\u516c\u94a5\u548c\u79c1\u94a5\uff0c\u56fe\u4e2d\u7528\u9501\u8868\u662f\u516c\u94a5\uff0c\u94a5\u5319\u8868\u793a\u79c1\u94a5\u3002\u5176\u5b9e\u67d0\u4e9b\u60c5\u51b5\u4e0b\u53ef\u4ee5\u4e92\u6362\uff0c\u7528\u5176\u4e2d\u4e00\u4e2a\u52a0\u5bc6\uff0c\u7528\u53e6\u4e00\u4e2a\u8fdb\u884c\u89e3\u5bc6\u3002 \u6d88\u606f\u8ba4\u8bc1\u7801 \u4e3a\u4e86\u9a8c\u8bc1\u6d88\u606f\u7684\u771f\u5b9e\u6027\uff0c\u53ef\u4ee5\u5bf9\u6d88\u606f\u672c\u8eab\uff0c\u6216\u8005\u6d88\u606f\u7684digest\u8fdb\u884c\u4e00\u5b9a\u7684\u5904\u7406\uff0c\u8fd9\u91cc\u9762\u7684hello\u662f\u540c\u6837\u7684key\uff0c\u53ef\u4ee5\u4f7f\u7528\u516c\u94a5\u5206\u53d1\u7684\u673a\u5236\u8fdb\u884c\u5206\u53d1\u3002Alice\u548cBob\u5728\u6709\u76f8\u540c\u7684key\uff08hello\uff09\uff0c\u53ef\u4ee5\u6821\u9a8c\u6d88\u606f\u7684\u771f\u5b9e\u6027\u3002 \u53e6\u5916\uff0c\u6709\u4e00\u79cd\u653b\u51fb\u662f\u91cd\u653e\uff08\u6d41\u91cf\uff09\u653b\u51fb\uff0c\u53ef\u4ee5\u901a\u8fc7\u5728\u6d88\u606f\u8ba4\u8bc1\u7801\u4e2d\u589e\u52a0\u989d\u5916\u7684\u552f\u4e00\u968f\u673a\u6570\u6765\u9632\u8303\u3002 \u4e2d\u95f4\u4eba\u653b\u51fb \u5373\u4f7f\u6709\u4e86\u975e\u5bf9\u79f0\u52a0\u5bc6\uff0c\u6d88\u606f\u8ba4\u8bc1\u7801\u7b49\u673a\u5236\uff0c\u901a\u4fe1\u4f9d\u65e7\u53ef\u80fd\u88ab\u52ab\u6301\uff0c\u5728\u4e92\u76f8\u4f20\u9012\u5bc6\u94a5\u7684\u65f6\u5019\uff0c\u4f9d\u65e7\u9762\u4e34\u7740\u98ce\u9669\u3002 \u7b7e\u540d \u7b7e\u540d\u7684\u751f\u6210\u548c\u4e0a\u9762\u4f20\u9012\u6d88\u606f\uff0c\u52a0\u89e3\u5bc6\u7528\u7684\u5bc6\u94a5\u6070\u6070\u76f8\u53cd\u3002\u5f53\u751f\u6210\u7b7e\u540d\u65f6\uff0c\u4f7f\u7528\u79c1\u94a5\u52a0\u5bc6\u3002\u9a8c\u8bc1\u65f6\uff0c\u4f7f\u7528\u516c\u94a5\u89e3\u5bc6\u3002 \u8bc1\u4e66 \u8bc1\u4e66\u5f15\u5165\u4e86\u7b2c\u4e09\u65b9\u7684\u8bc1\u4e66\u8ba4\u8bc1\u4e2d\u5fc3\uff0c\u8bc1\u4e66\u7684\u7b7e\u53d1\uff0c\u5b9e\u9645\u4e0a\u8981\u6bd4\u56fe\u4e2d\u7a0d\u5fae\u590d\u6742\u4e00\u4e9b\uff0c\u8981\u901a\u8fc7\u81ea\u5df1\u7684\u516c\u94a5\u751f\u6210csr\uff08\u8bc1\u4e66\u8bf7\u6c42\uff09\uff0c\u63d0\u4ea4\u7ed9ca\u4e2d\u5fc3\u3002ca\u4e2d\u5fc3\u4f7f\u7528\u81ea\u5df1\u7684\u79c1\u94a5\u4e3a\u5176\u7b7e\u540d\uff0c\u5e76\u5c06\u7b7e\u540d\uff0cbob\u7684\u516c\u94a5\u4e00\u5e76\u6253\u5305\u6210\u8bc1\u4e66\u53d1\u9001\u7ed9alice\u3002 alice\u6536\u5230\u8bc1\u4e66\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7\u5df2\u7ecf\u5b58\u50a8\u7684ca\u4e2d\u5fc3\u7684\u516c\u94a5\u89e3\u5bc6\u51fabob\u7684\u516c\u94a5\uff0c\u8fdb\u800c\u5b8c\u6210\u5b89\u5168\u7684\u901a\u8baf\u3002 \u9488\u5bf9\u8bc1\u4e66\u7684\u4e2d\u95f4\u4eba\u653b\u51fb \u5355\u5355\u5f15\u5165\u8bc1\u4e66\u4f9d\u65e7\u53ef\u80fd\u5b58\u5728\u5b89\u5168\u56e0\u60a3\uff0c\u5728\u8bc1\u4e66\u4e0b\u53d1\u7684\u65f6\u5019\u4f9d\u65e7\u53ef\u80fd\u5b58\u5728\u4e2d\u95f4\u4eba\u653b\u51fb\u3002 \u8bc1\u4e66\u94fe \u4e3a\u4e86\u89e3\u51b3\u4e0b\u53d1\u8bc1\u4e66\u7684\u95ee\u9898\uff0c\u5f15\u5165\u4e86\u8bc1\u4e66\u94fe\u3002\u5176\u7f6a\u9876\u5c42\u65f6\u6839\u8bc1\u4e66\uff0c\u8bc1\u4e66\u4e5f\u662f\u4e00\u5c42\u4e00\u5c42\u7684\uff0c\u53ef\u4ee5\u5206\u5c42\u83b7\u53d6\u4e0b\u4e00\u5c42\u7684\u516c\u94a5\uff0c\u800c\u8ddf\u8bc1\u4e66\u7684\u4e0b\u53d1\u5f80\u5f80\u662f\u5c81\u7535\u8111\u7cfb\u7edf\u4e00\u5757\u7684\u3002","title":"\u73b0\u4ee3\u5bc6\u7801\u5b66\u4e4b\u6d88\u606f\u7684\u901a\u8baf"},{"location":"notes/2020/crypt/fun_crypt/#_1","text":"\u4ee5\u4e0b\u7684\u5185\u5bb9\u6574\u7406\u81eaVita\u541b\u7684\u7238\u7238\u5468\u81ea\u6052\u8001\u5e08\u6700\u8fd1\u65b0\u4e66\u300a\u56fe\u89e3\u5bc6\u7801\u6280\u672f\u300b\u63a8\u4ecb\u65f6\u56fe\u7075\u793e\u533a\u7684\u5206\u4eab\u7684\u90e8\u5206\u5185\u5bb9\uff0c\u867d\u7136\u4ece\u4e2a\u4eba\u7684\u89d2\u5ea6\u6765\u8bf4\uff0c\u5927\u90e8\u5206\u5185\u5bb9\u5df2\u7ecf\u77e5\u6653\uff0c\u4f46\u957f\u65f6\u95f4\u4e0d\u7528\u591a\u5c11\u8fd8\u662f\u6709\u4e9b\u751f\u758f\uff0c\u5728\u5468\u8001\u5e08\u5faa\u5e8f\u6e10\u8fdb\u7684\u8bb2\u8ff0\u4e0b\u66f4\u6709\u878d\u4f1a\u8d2f\u901a\u4e4b\u611f\uff0c\u8fd9\u91cc\u8bb0\u5f55\u4e00\u4e0b\uff0c\u4ee5\u5907\u4e0d\u65f6\u4e4b\u9700\u3002","title":"\u73b0\u4ee3\u5bc6\u7801\u5b66\u4e4b\u6d88\u606f\u7684\u901a\u8baf"},{"location":"notes/2020/crypt/fun_crypt/#_2","text":"\u4fe1\u606f\u5b89\u5168\u8981\u89e3\u51b3\u7684\u95ee\u9898\uff0c\u4e00\u5b9a\u6e90\u81ea\u4e8e\u771f\u5b9e\u7684\u6848\u4f8b\uff0c\u5728\u5b9e\u9645\u7684\u6d88\u606f\u901a\u8baf\u4e2d\uff0c\u5176\u9762\u4e34\u7740\u5982\u4e0b\u51e0\u79cd\u7c7b\u578b\u7684\u5a01\u80c1 - \u7a83\u542c\uff08\u79c1\u5bc6\u4fe1\u606f\u7684\u6cc4\u6f0f\uff09 - \u7be1\u6539\uff08\u4fe1\u606f\u88ab\u4fee\u6539\uff09 - \u5047\u5192\uff08\u4f2a\u88c5\u6210\u4fe1\u606f\u7684\u53d1\u9001\u8005\uff09 - \u5426\u8ba4\uff08\u4fe1\u606f\u5df2\u7ecf\u53d1\u9001\uff0c\u4f46\u662f\u4e8b\u540e\u5374\u4e0d\u627f\u8ba4\uff09","title":"\u4fe1\u606f\u5b89\u5168\u9762\u4e34\u7684\u5a01\u80c1"},{"location":"notes/2020/crypt/fun_crypt/#_3","text":"alice\u5728\u60f3bob\u8ba8\u9152\u559d\u7684\u65f6\u5019\uff0c\u4fe1\u606f\u9762\u4e34\u7740\u88abX\u7a83\u542c\u7684\u53ef\u80fd\u3002\u8fd9\u79cd\u60c5\u51b5\u975e\u5e38\u5e38\u89c1\uff0c\u4efb\u4f55\u901a\u8baf\u4e2d\u95f4\u8282\u70b9\u53ea\u8981\u88ab\u5229\u7528\uff0c\u90fd\u53ef\u4ee5\u505a\u5230\u8fd9\u4e00\u70b9\uff0c\u751a\u81f3\u662f\u5c40\u57df\u7f51\u5185\u7684\u6df7\u6742\u6a21\u5f0f\u7684\u6293\u5305\u4e5f\u80fd\u83b7\u5f97\u90e8\u5206\u4fe1\u606f\u3002","title":"\u7a83\u542c"},{"location":"notes/2020/crypt/fun_crypt/#_4","text":"\u5982\u56fe\uff0cX\u5728\u53d1\u51fa\u8ba8\u9152\u7684\u8bf7\u6c42\u65f6\u88abX\u62e6\u622a\u4e86\uff0cX\u4ec5\u4ec5\u662f\u4fee\u6539\u4e86\u6536\u8d27\u5730\u5740\uff0c\u5f53Alice\u5c1d\u8bd5\u8be2\u95eeBob\u9152\uff08\u94b1\uff09\u5728\u4f55\u65b9\u65f6\uff0cBob\u5c31\u5f7b\u5e95\u8499\u5708\u4e86\u3002","title":"\u7be1\u6539"},{"location":"notes/2020/crypt/fun_crypt/#_5","text":"X\u76f4\u63a5\u4f2a\u88c5\u6210\u4e86Alice\u5411Bob\u8ba8\u9152\u559d\uff0cBob\u7ed9\u4e86\u540e\u518d\u8981\u6c42Alice\u507f\u8fd8\u76f8\u5e94\u7684\uff08\u9152\u94b1\uff09\u65f6\uff0c\u5c31\u8f6e\u5230Alice\u8499\u5708\u4e86","title":"\u5047\u5192"},{"location":"notes/2020/crypt/fun_crypt/#_6","text":"\u8fd9\u79cd\u60c5\u5f62\u4e0b\uff0cAlice\u5e94\u8be5\u65f6\u4e2a\u8001\u9152\u9b3c\u4e86\uff0c\u501f\u4e86\u9152\u559d\u5374\u4e0d\u7ed9\u94b1\u4e0d\u8ba4\u8d26\u4e86","title":"\u5426\u8ba4"},{"location":"notes/2020/crypt/fun_crypt/#_7","text":"\u4e0a\u6587\u4e2d\u4ecb\u7ecd\u7684\u56db\u7c7b\u5a01\u80c1\uff0c\u5206\u522b\u5bf9\u5e94\u4e86\u56db\u79cd\u7279\u6027\u3002\u73b0\u4ee3\u5bc6\u7801\u5b66\u4e2d\u4e5f\u6709\u5bf9\u5e94\u7684\u65b9\u5f0f\u6765\u89e3\u51b3\u5404\u4e2a\u95ee\u9898","title":"\u5bf9\u5e94\u7684\u89e3\u51b3\u65b9\u5f0f"},{"location":"notes/2020/crypt/fun_crypt/#_8","text":"\u8fd9\u91cc\u9762\u505a\u8fd9\u6837\u4e00\u4e2a\u7ea6\u5b9a\uff0c\u975e\u5bf9\u79f0\u52a0\u5bc6\u4e2d\u6709\u6210\u5bf9\u51fa\u73b0\u7684\u516c\u94a5\u548c\u79c1\u94a5\uff0c\u56fe\u4e2d\u7528\u9501\u8868\u662f\u516c\u94a5\uff0c\u94a5\u5319\u8868\u793a\u79c1\u94a5\u3002\u5176\u5b9e\u67d0\u4e9b\u60c5\u51b5\u4e0b\u53ef\u4ee5\u4e92\u6362\uff0c\u7528\u5176\u4e2d\u4e00\u4e2a\u52a0\u5bc6\uff0c\u7528\u53e6\u4e00\u4e2a\u8fdb\u884c\u89e3\u5bc6\u3002","title":"\u975e\u5bf9\u79f0\u52a0\u5bc6"},{"location":"notes/2020/crypt/fun_crypt/#_9","text":"\u4e3a\u4e86\u9a8c\u8bc1\u6d88\u606f\u7684\u771f\u5b9e\u6027\uff0c\u53ef\u4ee5\u5bf9\u6d88\u606f\u672c\u8eab\uff0c\u6216\u8005\u6d88\u606f\u7684digest\u8fdb\u884c\u4e00\u5b9a\u7684\u5904\u7406\uff0c\u8fd9\u91cc\u9762\u7684hello\u662f\u540c\u6837\u7684key\uff0c\u53ef\u4ee5\u4f7f\u7528\u516c\u94a5\u5206\u53d1\u7684\u673a\u5236\u8fdb\u884c\u5206\u53d1\u3002Alice\u548cBob\u5728\u6709\u76f8\u540c\u7684key\uff08hello\uff09\uff0c\u53ef\u4ee5\u6821\u9a8c\u6d88\u606f\u7684\u771f\u5b9e\u6027\u3002 \u53e6\u5916\uff0c\u6709\u4e00\u79cd\u653b\u51fb\u662f\u91cd\u653e\uff08\u6d41\u91cf\uff09\u653b\u51fb\uff0c\u53ef\u4ee5\u901a\u8fc7\u5728\u6d88\u606f\u8ba4\u8bc1\u7801\u4e2d\u589e\u52a0\u989d\u5916\u7684\u552f\u4e00\u968f\u673a\u6570\u6765\u9632\u8303\u3002","title":"\u6d88\u606f\u8ba4\u8bc1\u7801"},{"location":"notes/2020/crypt/fun_crypt/#_10","text":"\u5373\u4f7f\u6709\u4e86\u975e\u5bf9\u79f0\u52a0\u5bc6\uff0c\u6d88\u606f\u8ba4\u8bc1\u7801\u7b49\u673a\u5236\uff0c\u901a\u4fe1\u4f9d\u65e7\u53ef\u80fd\u88ab\u52ab\u6301\uff0c\u5728\u4e92\u76f8\u4f20\u9012\u5bc6\u94a5\u7684\u65f6\u5019\uff0c\u4f9d\u65e7\u9762\u4e34\u7740\u98ce\u9669\u3002","title":"\u4e2d\u95f4\u4eba\u653b\u51fb"},{"location":"notes/2020/crypt/fun_crypt/#_11","text":"\u7b7e\u540d\u7684\u751f\u6210\u548c\u4e0a\u9762\u4f20\u9012\u6d88\u606f\uff0c\u52a0\u89e3\u5bc6\u7528\u7684\u5bc6\u94a5\u6070\u6070\u76f8\u53cd\u3002\u5f53\u751f\u6210\u7b7e\u540d\u65f6\uff0c\u4f7f\u7528\u79c1\u94a5\u52a0\u5bc6\u3002\u9a8c\u8bc1\u65f6\uff0c\u4f7f\u7528\u516c\u94a5\u89e3\u5bc6\u3002","title":"\u7b7e\u540d"},{"location":"notes/2020/crypt/fun_crypt/#_12","text":"\u8bc1\u4e66\u5f15\u5165\u4e86\u7b2c\u4e09\u65b9\u7684\u8bc1\u4e66\u8ba4\u8bc1\u4e2d\u5fc3\uff0c\u8bc1\u4e66\u7684\u7b7e\u53d1\uff0c\u5b9e\u9645\u4e0a\u8981\u6bd4\u56fe\u4e2d\u7a0d\u5fae\u590d\u6742\u4e00\u4e9b\uff0c\u8981\u901a\u8fc7\u81ea\u5df1\u7684\u516c\u94a5\u751f\u6210csr\uff08\u8bc1\u4e66\u8bf7\u6c42\uff09\uff0c\u63d0\u4ea4\u7ed9ca\u4e2d\u5fc3\u3002ca\u4e2d\u5fc3\u4f7f\u7528\u81ea\u5df1\u7684\u79c1\u94a5\u4e3a\u5176\u7b7e\u540d\uff0c\u5e76\u5c06\u7b7e\u540d\uff0cbob\u7684\u516c\u94a5\u4e00\u5e76\u6253\u5305\u6210\u8bc1\u4e66\u53d1\u9001\u7ed9alice\u3002 alice\u6536\u5230\u8bc1\u4e66\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7\u5df2\u7ecf\u5b58\u50a8\u7684ca\u4e2d\u5fc3\u7684\u516c\u94a5\u89e3\u5bc6\u51fabob\u7684\u516c\u94a5\uff0c\u8fdb\u800c\u5b8c\u6210\u5b89\u5168\u7684\u901a\u8baf\u3002","title":"\u8bc1\u4e66"},{"location":"notes/2020/crypt/fun_crypt/#_13","text":"\u5355\u5355\u5f15\u5165\u8bc1\u4e66\u4f9d\u65e7\u53ef\u80fd\u5b58\u5728\u5b89\u5168\u56e0\u60a3\uff0c\u5728\u8bc1\u4e66\u4e0b\u53d1\u7684\u65f6\u5019\u4f9d\u65e7\u53ef\u80fd\u5b58\u5728\u4e2d\u95f4\u4eba\u653b\u51fb\u3002","title":"\u9488\u5bf9\u8bc1\u4e66\u7684\u4e2d\u95f4\u4eba\u653b\u51fb"},{"location":"notes/2020/crypt/fun_crypt/#_14","text":"\u4e3a\u4e86\u89e3\u51b3\u4e0b\u53d1\u8bc1\u4e66\u7684\u95ee\u9898\uff0c\u5f15\u5165\u4e86\u8bc1\u4e66\u94fe\u3002\u5176\u7f6a\u9876\u5c42\u65f6\u6839\u8bc1\u4e66\uff0c\u8bc1\u4e66\u4e5f\u662f\u4e00\u5c42\u4e00\u5c42\u7684\uff0c\u53ef\u4ee5\u5206\u5c42\u83b7\u53d6\u4e0b\u4e00\u5c42\u7684\u516c\u94a5\uff0c\u800c\u8ddf\u8bc1\u4e66\u7684\u4e0b\u53d1\u5f80\u5f80\u662f\u5c81\u7535\u8111\u7cfb\u7edf\u4e00\u5757\u7684\u3002","title":"\u8bc1\u4e66\u94fe"},{"location":"notes/2020/devops/twhomework/doc/","text":"\u79c1\u6709\u4e91DevOps\u6301\u7eed\u6784\u5efa\u7cfb\u7edf\u7684\u642d\u5efa -- thoughtworks devops\u9762\u8bd5\u9898\u89e3\u7b54 author: \u5b5f\u7e41\u8d85(dameng/Makefile\u541b) copyright\uff1a \u7248\u6743\u6240\u6709\uff0c\u5982\u9700\u8f6c\u8f7d\u8bf7\u8054\u7cfb pingf0@gmail.com \u80cc\u666f: thoughtworks\u7684DevOps\u7684\u9762\u8bd5\u9898\u76ee\u4e2d\u7684\u6838\u5fc3\u8981\u6c42\u5982\u4e0b(\u7ec6\u8282\u7684\u8bdd\u6682\u4e0d\u65b9\u4fbf\u900f\u9732): - \u63d0\u4f9b\u4e00\u4e2a\u7ed9\u5f00\u53d1\u4f7f\u7528\u7684\u73af\u5883 - \u642d\u5efa\u4e00\u4e2aCI/CD\u73af\u5883\u6784\u5efa\u76f8\u5173\u7684\u5236\u54c1 - \u901a\u8fc7CI/CD\u5c06\u5f00\u53d1\u4ee3\u7801\u90e8\u7f72\u5230\u76f8\u5e94\u7684\u73af\u5883\u4e0a \u601d\u8def\u5206\u6790: \u5176\u4e2d\u6d89\u53ca\u5230\u4e24\u5757\u73af\u5883\u7684\u642d\u5efa\uff0c\u4e00\u4e2a\u662f\u642d\u5efa\u8fd0\u884c\u65f6\u73af\u5883\uff0c\u4e00\u4e2a\u662f\u6784\u5efaCI/CD\u7cfb\u7edf\u3002\u540c\u65f6\u5176\u4e5f\u9690\u6027\u7684\u8981\u6c42\u4e86\uff0c\u7f16\u5199demo\u4ee3\u7801\uff0c\u901a\u8fc7CI/CD\u7cfb\u7edf\u90e8\u7f72\u5230\u642d\u5efa\u7684\u8fd0\u884c\u65f6\u73af\u5883\u4e2d\u53bb\u3002 \u6240\u4ee5\u5c06\u4efb\u52a1\u9700\u6c42\u8fdb\u884c\u62c6\u5206 - CI/CD\u73af\u5883\u7684\u642d\u5efa\uff08\u5305\u542b\u4e2d\u95f4\u4ea7\u51fa\u5236\u54c1\u4f9d\u8d56\u7cfb\u7edf\u7684\u642d\u5efa\uff09 - \u8fd0\u884c\u65f6\u73af\u5883\u7684\u642d\u5efa - demo\u4ee3\u7801\u7684\u7f16\u5199 - \u6d41\u6c34\u7ebf\u7684\u6d89\u53ca - \u5b9e\u9645\u6784\u5efa\u90e8\u7f72\u7684\u5c55\u793a \u6280\u672f\u9009\u578b\uff1a \u56e0\u4e3a\u662f\u5c55\u793a\u6027\u7684\u9898\u76ee\uff0c\u8fd9\u91cc\u5728\u6280\u672f\u9009\u578b\u4e0a\u5e76\u4e0d\u4f1a\u6709\u5386\u53f2\u5305\u88b1\uff0c\u6240\u4ee5\u8fd9\u91cc\u9009\u7528\u5f00\u6e90\u4e91\u539f\u751f\u7684\u4e00\u5957\u4f53\u7cfb\u8fdb\u884c\u642d\u5efa\u3002 - \u5236\u54c1\u7edf\u4e00\u4f7f\u7528Docker\u955c\u50cf\u7684\u65b9\u5f0f\u8fdb\u884c\u6d41\u8f6c\uff0c\u8fd0\u884c\u73af\u5883\u4e3aK8s\u73af\u5883\uff08\u5b9e\u9645\u90e8\u7f72\u4f7f\u7528\u4e86HA\u65b9\u6848\uff0c\u5e76\u90e8\u7f72\u4e86istio\u8fd9\u6837\u7684service mesh\u6846\u67b6\uff09 - CI/CD\u73af\u5883\u4e3a Jenkins 2 (\u901a\u8fc7\u63d2\u4ef6\u65b9\u5f0f\u5b9e\u73b0docker\u955c\u50cf\u6784\u5efa\u4e0e\u53d1\u5e03\u4ee5\u53cak8s\u7684\u90e8\u7f72) - \u4e2d\u95f4\u5236\u54c1\u7684\u5b58\u50a8\u4f7f\u7528 Nexus 3 \uff08\u867d\u7136Nexus\u662f\u4e00\u4e2a\u901a\u7528\u7684\u5236\u54c1\u4ed3\u5e93\uff0c\u4f46\u662f\u8fd9\u91cc\u91cd\u70b9\u9488\u5bf9\u5176Docker\u955c\u50cf\u4ed3\u5e93\u8fdb\u884c\u64cd\u4f5c\uff09 - \u6d41\u6c34\u7ebf\u90e8\u5206\u4f7f\u7528jenkinsfile\uff0c\u5b9e\u73b0\u4e86pipeline as code\uff0c\u5e76\u4e14\u4ee5\u6a21\u62df\u7684\u5f62\u5f0f\u533a\u5206\u4e86\u5f00\u53d1\uff0c\u6d4b\u8bd5\uff0c\u751f\u4ea7\u4e09\u5957\u73af\u5883\uff08\u7406\u8bba\u4e0a\u53ef\u4ee5\u66f4\u591a\uff0c\u4f46\u662f\u6682\u65f6\u53ea\u9009\u4e86\u8fd9\u4e09\u4e2a\u6700\u57fa\u7840\u7684\u73af\u5883\uff09 - demo\u4f7f\u7528\u7684python\u7684fastapi\u6846\u67b6\u8fdb\u884c\u642d\u5efa\uff0c\u6d4b\u8bd5\u90e8\u5206\u63d0\u4f9b\u4e86pytest\u7684\u6d4b\u8bd5\u4ee3\u7801\uff0c\u5e76\u539f\u751f\u63d0\u4f9b\u4e86swagger ui\u8fdb\u884c\u5728\u7ebf\u6d4b\u8bd5\u529f\u80fd\uff0c\u4ee5\u53caredoc\u9875\u9762\u8fdb\u884capi\u6587\u6863\u6d4f\u89c8 \u786c\u4ef6\u914d\u7f6e \u4e3a\u4e86\u65b9\u4fbfJenkins\u4ee5\u53caNexus\u7684\u642d\u5efa\u5728\u6b64\u6b21\u63d0\u4ea4\u7684\u4f5c\u4e1a\u4e2d\u5e76\u6ca1\u6709\u653e\u5728k8s\u96c6\u7fa4\u4e2d\uff0c\u800c\u662f\u72ec\u7acb\u5728\u4e3b\u673a\u4e0a\u4ee5docker\u65b9\u5f0f\u72ec\u7acb\u542f\u52a8 \u4e3b\u673a\u4e3a\u6211\u7684\u7b14\u8bb0\u672c\u7535\u8111 cpu: i7 9750h, 1T\u786c\u76d8\uff0c 64G \u5185\u5b58 k8s\u8fd0\u884c\u65f6\u73af\u5883\u4f7f\u7528\u7684\u662f\u6700\u65b0\u7248\u672c\uff081.18\uff09\u7684k8s\uff0c\u91c7\u7528\u4e86\u9ad8\u53ef\u7528\u7684\u90e8\u7f72\u65b9\u6848\uff0c\u5171\u8017\u8d39\u4e868\u53f0kvm\u865a\u62df\u673a\uff0c\u6bcf\u53f0\u673a\u5668\u5206\u914d2\u68384G\u5185\u5b58\uff0c\u7cfb\u7edf\u4e3adebian 10.4 \u5b9e\u9645\u5f00\u9500\u4e3a\u5c06\u8fd140G\u7684\u5185\u5b58\uff08\u622a\u56fe\u4e2d\u4e3a35.7G\u4f7f\u7528\u91cf\uff0c\u5b9e\u9645\u6d4b\u8bd5\u65f6\u6709\u5230\u8fc740G\uff09 \u89e3\u51b3\u65b9\u6848 DevOps\u6d41\u7a0b\u67b6\u6784 \u6309\u7167\u5cf0\u8fbe\u6574\u7406\u7684\u76f8\u5bf9\u5b8c\u5907\u7684Devops\u6d41\u7a0b\u4e2d\uff0c\u5e94\u5305\u62ec\u5982\u4e0b\u51e0\u4e2a\u73af\u8282 \u4f46\u662f\u8fd9\u91cc\u56e0\u4e3a\u65f6\u95f4\u548c\u7cbe\u529b\u6709\u9650\uff0c\u53ea\u6311\u9009\u4e86\u5176\u4e2d\u76f8\u5bf9\u6bd4\u8f83\u91cd\u8981\u7684\u73af\u8282\u8fdb\u884c\u642d\u5efa\u6f14\u793a \u56fe\u4e2d\u8986\u76d6\u4e86CI/CD\u7684\u6838\u5fc3\u73af\u8282\uff0c\u6d41\u6c34\u7ebf\u4e3b\u8981\u6d41\u7a0b\u6db5\u76d6\u4e86\u5982\u4e0b\u51e0\u4e2a\u73af\u8282 \u4ee3\u7801\u7684\u62c9\u53d6 \u955c\u50cf\u7684\u6784\u5efa \u6d4b\u8bd5\u4e0e\u8d28\u91cf \u5236\u54c1\u7684\u53d1\u5e03 \u5783\u573e\u7684\u6e05\u7406 \u5236\u54c1\u7684\u90e8\u7f72 \u6570\u636e\u7684\u5c55\u793a*\uff08\u90e8\u7f72istio\u540e\u81ea\u5e26\uff09 \u540c\u65f6\u901a\u8fc7Nexus\u521b\u5efa\u4e86\u4e09\u4e2a\u4e0d\u540c\u7684\u4ed3\u5e93\u7528\u6765\u533a\u5206\u955c\u50cf\u7684\u73af\u5883\uff0c\u800c\u5728K8s\u96c6\u7fa4\u4e2d\u4ee5\u4e0d\u540cnamespace \u90e8\u7f72\u67b6\u6784 \u4e3a\u4e86\u65b9\u4fbf\u540e\u7eed\u63cf\u8ff0\uff0c\u8fd9\u91cc\u7ed9\u51fa\u90e8\u7f72\u8282\u70b9\u7684\u67b6\u6784\u56fe \u6ce8\u610f\uff0c\u56fe\u4e2d172.19.0.1\u4e3a\u5bbf\u4e3b\u673a\u5728172.19\u7f51\u6bb5\u7684IP\uff0c\u4e5f\u53ef\u901a\u8fc7127.0.0.1\u6216192.168.31.72(\u6211\u7684\u5916\u90e8\u7f51\u7edc\u5206\u914d\u7684IP)\u8fdb\u884c\u8bbf\u95ee\uff0c\u540e\u6587\u4e2d\u5982\u679c\u6709\u76f8\u5173IP\uff0c\u5747\u6307\u5411\u540c\u4e00\u673a\u5668 Docker\u7684\u5b89\u88c5 \u5378\u8f7d\u65e7\u7248 sudo apt-get remove docker docker-engine docker.io containerd runc \u914d\u7f6e\u6e90 sudo apt-get update sudo apt-get install \\ apt-transport-https \\ ca-certificates \\ curl \\ gnupg-agent \\ software-properties-common curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add - sudo add-apt-repository \\ \"deb [arch=amd64] https://download.docker.com/linux/ubuntu \\ $( lsb_release -cs ) \\ stable\" \u5b89\u88c5docker sudo apt-get update sudo apt-get install docker-ce docker-ce-cli containerd.io \u7528\u6237\u7ec4\u8d4b\u80fd sudo groupadd docker sudo usermod -aG docker $USER \u4fee\u6539\u914d\u7f6e \u4fee\u6539 /etc/docker/daemon.json \u5982\u4e0b { \"registry-mirrors\": [ \"https://registry.docker-cn.com\", \"http://hub-mirror.c.163.com\", \"https://docker.mirrors.ustc.edu.cn\", \"https://reg-mirror.qiniu.com\", \"https://quay.azk8s.cn\", \"https://gcr.azk8s.cn\", \"https://dockerhub.azk8s.cn\" ], \"exec-opts\": [\"native.cgroupdriver=systemd\"], \"log-driver\": \"json-file\", \"log-opts\": { \"max-size\": \"100m\" }, \"insecure-registries\": [\"0.0.0.0/0\"], \"storage-driver\": \"overlay2\" } \u5e76\u91cd\u542fdocker\uff0c sudo service docker restart KubeCtl\u7684\u5b89\u88c5 \u5bbf\u4e3b\u673a\u5668\u4e0a\u5b89\u88c5kubectl \u53ea\u662f\u65b9\u4fbf\u64cd\u4f5ck8s\u96c6\u7fa4\uff0c\u56e0\u4e3ajenkins\u4f1a\u7528\u5230kubectl\uff0c\u6240\u4ee5\u8fd9\u91cc\u5b89\u88c5\u540e\uff0c\u53ef\u4ee5\u76f4\u63a5\u6302\u8f7d\u7ed9jenkins\u4f7f\u7528\u3002 apt-get update && apt-get install -y apt-transport-https curl https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg | apt-key add - cat <<EOF >/etc/apt/sources.list.d/kubernetes.list deb https://mirrors.aliyun.com/kubernetes/apt/ kubernetes-xenial main EOF apt-get update apt-get install -y kubectl Jenkins\u7684\u5b89\u88c5\u4e0e\u914d\u7f6e \u5728\u4e3b\u673a\u4e0a\u4ee5docker\u8fd0\u884cJenkins\u975e\u5e38\u65b9\u4fbf\uff0c\u4f46\u662f\u8981\u56e0\u4e3a\u8981\u5bf9\u63a5docker\u548ck8s docker run -d -v /home/dameng/jenkins:/var/jenkins_home -v /var/run/docker.sock:/var/run/docker.sock --name jenkins -v $(which docker):/usr/bin/docker -v $(which kubectl):/usr/bin/kubectl --group-add=$(stat -c %g /var/run/docker.sock) -v /home/dameng/jenkins/.docker-jenkins:/.docker -v /home/dameng/jenkins/.kube:/.kube --network host jenkins/jenkins:lts \u8981\u6ce8\u610f: - \u7aef\u53e38080,50000\u662f\u5fc5\u987b\u8981\u66b4\u9732\u7684\uff0c\u7b80\u5355\u8d77\u89c1\u8fd9\u91cc\u4f7f\u7528\u4e86host\u7f51\u7edc\u6a21\u5f0f - \u914d\u7f6e\u6587\u4ef6\u72ec\u7acb\u6302\u8f7d - \u590d\u7528\u5bbf\u4e3b\u673a\u7684docker(cli\u4ee5\u53caunix socket)\uff0ckubectl\uff08cli\u4ee5\u53cakube config\u914d\u7f6e\uff09 \u5728\u5b89\u88c5\u540e\u53ef\u901a\u8fc78080\u7aef\u53e3\u8fdb\u884c\u8bbf\u95ee\uff0c\u4e3a\u4e86\u65b9\u4fbf\u548c\u7f8e\u89c2\u9009\u88c5Blue Ocean UI\uff0c Docker Pipeline\uff0c Kubernetes CLI\u7b49\u63d2\u4ef6 \u63d2\u4ef6\u5b89\u88c5\u9875\u9762 Blue Ocean UI Nexus\u7684\u5b89\u88c5\u4e0e\u914d\u7f6e \u548c\u524d\u9762\u8fd0\u884cJenkins\u7684\u65b9\u5f0f\u7c7b\u4f3c\uff0c\u8fd9\u91cc\u6211\u4eec\u4e5f\u4f7f\u7528docker\u7684\u65b9\u5f0f\u6765\u8fd0\u884cNexus docker run -d --network host --name nexus -v /home/dameng/nexus:/nexus-data sonatype/nexus3 \u540c\u6837\u4e5f\u6709\u4e9b\u8981\u6ce8\u610f\u7684\u5730\u65b9 \u7aef\u53e38081\u662f\u5fc5\u987b\u8981\u66b4\u9732\u7684\uff0c\u7b80\u5355\u8d77\u89c1\u8fd9\u91cc\u4f7f\u7528\u4e86host\u7f51\u7edc\u6a21\u5f0f \u914d\u7f6e\u6587\u4ef6\u72ec\u7acb\u6302\u8f7d \u767b\u9646\u4e4b\u540e\uff0c\u4f1a\u751f\u6210\u9996\u6b21\u8fd0\u884c\u7528\u5bc6\u7801\uff0c\u4f4d\u4e8e\u5bb9\u5668\u4e2d /nexus-data/admin.password \u6587\u4ef6\u4e2d\uff0c\u4f7f\u7528\u5176\u767b\u9646\u540e\u6709UI\u63d0\u793a\u4fee\u6539\u5bc6\u7801\uff0c\u4fee\u6539\u5373\u53ef Nexus\u652f\u6301maven\uff0cpip\uff0cnode\uff0cdocker registry\u7b49\u591a\u79cd\u4ed3\u5e93\uff0c\u672c\u6587\u6240\u8ba8\u8bba\u7684\u53ea\u6d89\u53caDocker Registry\u3002\u53e6\u5916\u5176\u8fd8\u652f\u6301host\uff0cproxy\uff0cgroup\u4e09\u79cd\u6a21\u5f0f\uff0c\u53ef\u4ee5\u642d\u914d\u4f7f\u7528\uff0c\u4f46\u8fd9\u91cc\u7684\u65b9\u6848\u76f4\u63a5\u4f7f\u7528host\u6a21\u5f0f\u7684docker registry\uff0c\u5206\u522b\u5bf9\u5e94\u5f00\u53d1\uff0c\u6d4b\u8bd5\uff0c\u751f\u4ea7\u73af\u5883\u7684\u955c\u50cf\u4ed3\u5e93\u3002 \u8fd9\u91cc\u5206\u522b\u5c068082,8083\u89c4\u5212\u4e3adev\u73af\u5883\u7684http\u548chttps\u7aef\u53e3\uff0c8084,8085\u5bf9\u5e94\u5f00\u53d1\u73af\u5883\uff0c8086\uff0c8087\u5bf9\u5e94\u751f\u4ea7\u73af\u5883\u3002 \u53e6\u5916\u8981\u6ce8\u610f\u7684\u662f\uff0c\u521b\u5efa\u5b8c\u6210\u540e\u5e76\u4e0d\u80fd\u76f4\u63a5login\uff0c\u9700\u8981\u901a\u8fc7realms\u8bbe\u7f6edocker bearer token realm\uff0c\u5b8c\u6210\u6388\u6743\u7684\u7ba1\u7406\u3002 K8s \u73af\u5883\u642d\u5efa\uff08HA\uff09 \u57fa\u7840\u914d\u7f6e \u9664\u4e86\u4e0a\u9762docker\u7684\u914d\u7f6e\u4ee5\u5916\uff0c\u4e3a\u4e86\u7b80\u4fbf\uff0c\u8fd9\u91cc\u5bf9\u6bcf\u53f0K8s\u8282\u70b9\u8fdb\u884c\u5982\u4e0b\u64cd\u4f5c \u786e\u5b9asystemctl\u7ba1\u7406\u670d\u52a1\u7684\u7cfb\u7edf\uff08\u5982debian\uff0cubuntu, fedora\uff09 \u914d\u7f6e\u597dssh\u767b\u9646 \u5f00\u542fIpForward \u7f16\u8f91 /etc/sysctl.conf \u4fee\u6539 net.ipv4.ip_forward = 1 \u7136\u540e\u6267\u884c sysctl --system - \u5173\u95edswap\u5206\u533a \u7f16\u8f91 /etc/fstab \u6ce8\u91ca \u548cswap\u76f8\u5173\u7684\u884c\uff0c\u91cd\u542f\u6216\u6267\u884c\u547d\u4ee4 swapoff -a \u5b89\u88c5\u4e09\u5927\u4ef6\uff08\u4e0d\u662f\u6bcf\u53f0\u673a\u5668\u90fd\u9700\u8981\uff0c\u4f46\u662f\u9ed8\u8ba4\u65b9\u4fbf\uff0c\u53ef\u4ee5\u65e0\u8111\u5b89\u88c5\uff09 apt-get update && apt-get install -y apt-transport-https curl https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg | apt-key add - cat <<EOF >/etc/apt/sources.list.d/kubernetes.list deb https://mirrors.aliyun.com/kubernetes/apt/ kubernetes-xenial main EOF apt-get update apt-get install -y kubelet kubeadm kubectl \u62c9\u53d6\u955c\u50cf \u6267\u884c kubeadm config images list \u83b7\u5f97 k8s.gcr.io/kube-apiserver:v1.18.6 k8s.gcr.io/kube-controller-manager:v1.18.6 k8s.gcr.io/kube-scheduler:v1.18.6 k8s.gcr.io/kube-proxy:v1.18.6 k8s.gcr.io/pause:3.2 k8s.gcr.io/etcd:3.4.3-0 k8s.gcr.io/coredns:1.6.7 \u7f16\u8f91\u811a\u672c\u5e76\u6267\u884c #! bash images =( kube-apiserver:v1.18.3 kube-controller-manager:v1.18.3 kube-scheduler:v1.18.3 kube-proxy:v1.18.3 pause:3.2 etcd:3.4.3-0 coredns:1.6.7 ) for imageName in ${ images [@] } ; do docker pull registry.cn-hangzhou.aliyuncs.com/google_containers/ $imageName docker tag registry.cn-hangzhou.aliyuncs.com/google_containers/ $imageName k8s.gcr.io/ $imageName docker rmi registry.cn-hangzhou.aliyuncs.com/google_containers/ $imageName done haproxy 42\uff0c43\u8282\u70b9\u5b89\u88c5haproxy apt-get update && apt-get upgrade && apt-get install -y haproxy \u7f16\u8f91 /etc/haproxy/haproxy.cfg global user haproxy group haproxy defaults mode http log global retries 2 timeout connect 3000ms timeout server 5000ms timeout client 5000ms frontend kubernetes bind 172 .19.0.41:6443,172.19.0.41:30843 option tcplog mode tcp default_backend kubernetes-master-nodes backend kubernetes-master-nodes mode tcp balance roundrobin option tcp-check server deb45 172 .19.0.45 check fall 3 rise 2 server deb46 172 .19.0.46 check fall 3 rise 2 \u4fee\u6539 /etc/sysctl.conf \u6587\u4ef6 net.ipv4.ip_nonlocal_bind = 1 \u4e4b\u540e\u6267\u884c sysctl -p \uff0c\u4e4b\u540e\u6267\u884c systemctl start haproxy heartbeat & VIP apt-get -y install heartbeat && systemctl enable heartbeat \u751f\u6210heartbeat\u7528\u7684key echo -n securepass | md5sum \u5c06\u751f\u6210\u7684\u7c7b\u4f3c\u5982\u4e0b\u5185\u5bb9\u5199\u5165 /etc/ha.d/authkeys \uff0c \u5e76\u4fee\u6539\u6743\u9650 chmod 600 /etc/ha.d/authkeys aba7d0d3b3f239fa5db79bdf27b4d19z \u914d\u7f6eheartbeat \u5728 /etc/ha.d/ha.cf \u6dfb\u52a0heartbeat\u6240\u5728\u7684\u8282\u70b9 node deb42 deb43 \u5176\u4e2ddeb42\uff0cdeb43\u5728 /etc/hosts \u914d\u7f6e\u6210\u4e86.42\u548c.43\u7684\u8282\u70b9 \u914d\u7f6e /etc/ha.d/haresources .42\u8282\u70b9\u914d\u7f6e\u6210 deb42 172 .19.0.41 .43\u8282\u70b9\u914d\u7f6e\u6210 deb43 172 .19.0.41 \u4e4b\u540e\u91cd\u542fheartbeat, systemctl restart heartbeat etcd ha \u4e0b\u9762\u914d\u7f6e\u9700\u8981\u5728bash\u4e0b\u8fd0\u884c export HOST0 = 172 .19.0.42 export HOST1 = 172 .19.0.43 export HOST2 = 172 .19.0.44 mkdir -p /tmp/ ${ HOST0 } / /tmp/ ${ HOST1 } / /tmp/ ${ HOST2 } / ETCDHOSTS =( ${ HOST0 } ${ HOST1 } ${ HOST2 } ) NAMES =( \"infra0\" \"infra1\" \"infra2\" ) for i in \" ${ !ETCDHOSTS[@] } \" ; do HOST = ${ ETCDHOSTS [ $i ] } NAME = ${ NAMES [ $i ] } cat << EOF > /tmp/${HOST}/kubeadmcfg.yaml apiVersion: \"kubeadm.k8s.io/v1beta1\" kind: ClusterConfiguration etcd: local: serverCertSANs: - \"${HOST}\" peerCertSANs: - \"${HOST}\" extraArgs: initial-cluster: ${NAMES[0]}=https://${ETCDHOSTS[0]}:2380,${NAMES[1]}=https://${ETCDHOSTS[1]}:2380,${NAMES[2]}=https://${ETCDHOSTS[2]}:2380 initial-cluster-state: new name: ${NAME} listen-peer-urls: https://${HOST}:2380 listen-client-urls: https://${HOST}:2379 advertise-client-urls: https://${HOST}:2379 initial-advertise-peer-urls: https://${HOST}:2380 EOF done \u4e4b\u540e\uff0c kubeadm init phase certs etcd-ca \u751f\u6210ca.crt\u548cca.key \u751f\u6210\u8bc1\u4e66 kubeadm init phase certs etcd-server --config = /tmp/ ${ HOST0 } /kubeadmcfg.yaml ` kubeadm init phase certs etcd-peer --config = /tmp/ ${ HOST0 } /kubeadmcfg.yaml kubeadm init phase certs etcd-healthcheck-client --config = /tmp/ ${ HOST0 } /kubeadmcfg.yaml kubeadm init phase certs apiserver-etcd-client --config = /tmp/ ${ HOST0 } /kubeadmcfg.yaml cp -R /etc/kubernetes/pki /tmp/ ${ HOST0 } / kubeadm init phase certs etcd-server --config = /tmp/ ${ HOST1 } /kubeadmcfg.yaml ` kubeadm init phase certs etcd-peer --config = /tmp/ ${ HOST1 } /kubeadmcfg.yaml kubeadm init phase certs etcd-healthcheck-client --config = /tmp/ ${ HOST1 } /kubeadmcfg.yaml kubeadm init phase certs apiserver-etcd-client --config = /tmp/ ${ HOST1 } /kubeadmcfg.yaml cp -R /etc/kubernetes/pki /tmp/ ${ HOST1 } / kubeadm init phase certs etcd-server --config = /tmp/ ${ HOST2 } /kubeadmcfg.yaml ` kubeadm init phase certs etcd-peer --config = /tmp/ ${ HOST2 } /kubeadmcfg.yaml kubeadm init phase certs etcd-healthcheck-client --config = /tmp/ ${ HOST2 } /kubeadmcfg.yaml kubeadm init phase certs apiserver-etcd-client --config = /tmp/ ${ HOST2 } /kubeadmcfg.yaml cp -R /etc/kubernetes/pki /tmp/ ${ HOST2 } / \u6309\u9700\u62f7\u8d1d scp -r /tmp/ ${ HOST0 } /* ${ HOST0 } : scp -r /tmp/ ${ HOST1 } /* ${ HOST1 } : scp -r /tmp/ ${ HOST2 } /* ${ HOST2 } : \u572842\uff0c43\uff0c44\u8282\u70b9\u4e0a\u6267\u884c cd /root mv pki /etc/kubernetes/ \u6574\u4f53\u8282\u70b9\u76ee\u5f55\u4e3a /root \u2514\u2500\u2500 kubeadmcfg.yaml --- /etc/kubernetes/pki \u251c\u2500\u2500 apiserver-etcd-client.crt \u251c\u2500\u2500 apiserver-etcd-client.key \u2514\u2500\u2500 etcd \u251c\u2500\u2500 ca.crt \u251c\u2500\u2500 healthcheck-client.crt \u251c\u2500\u2500 healthcheck-client.key \u251c\u2500\u2500 peer.crt \u251c\u2500\u2500 peer.key \u251c\u2500\u2500 server.crt \u2514\u2500\u2500 server.key 42,43,44\u5206\u522b\u6267\u884c kubeadm init phase etcd local --config = /tmp/172.19.0.42/kubeadmcfg.yaml kubeadm init phase etcd local --config = /tmp/172.19.0.43/kubeadmcfg.yaml kubeadm init phase etcd local --config = /tmp/172.19.0.44/kubeadmcfg.yaml \u914d\u7f6e\u4e3b\u8282\u70b9&\u4ece\u8282\u70b9 \u5148\u914d\u7f6e45\u8282\u70b9\uff0c \u62f7\u8d1detcd\u8bc1\u4e66\u523045\u4e3b\u8282\u70b9 scp /etc/kubernetes/pki/etcd/ca.crt 172 .19.0.45: scp /etc/kubernetes/pki/apiserver-etcd-client.crt 172 .19.0.45: scp /etc/kubernetes/pki/apiserver-etcd-client.key 172 .19.0.45: \u7f16\u8f91kubeadm-config.yaml apiVersion: kubeadm.k8s.io/v1beta1 kind: ClusterConfiguration kubernetesVersion: stable apiServer: certSANs: - \"172.19.0.41\" controlPlaneEndpoint: \"172.19.0.41:6443\" etcd: external: endpoints: - https://172.19.0.42:2379 - https://172.19.0.43:2379 - https://172.19.0.44:2379 caFile: /etc/kubernetes/pki/etcd/ca.crt certFile: /etc/kubernetes/pki/apiserver-etcd-client.crt keyFile: /etc/kubernetes/pki/apiserver-etcd-client.key \u62f7\u8d1d\u8bc1\u4e66 mkdir -p /etc/kubernetes/pki/etcd/ cp /root/ca.crt /etc/kubernetes/pki/etcd/ cp /root/apiserver-etcd-client.crt /etc/kubernetes/pki/ cp /root/apiserver-etcd-client.key /etc/kubernetes/pki/ kubeadm\u521d\u59cb\u5316 kubeadm init --config kubeadm-config.yaml \u518d\u914d\u7f6e46\u8282\u70b9\uff0c\u572845\u8282\u70b9\u4e0a\u6267\u884c scp /etc/kubernetes/pki/ca.crt 172 .19.0.46: scp /etc/kubernetes/pki/ca.key 172 .19.0.46: scp /etc/kubernetes/pki/sa.key 172 .19.0.46: scp /etc/kubernetes/pki/sa.pub 172 .19.0.46: scp /etc/kubernetes/pki/front-proxy-ca.crt @172.19.0.46: scp /etc/kubernetes/pki/front-proxy-ca.key @172.19.0.46: scp /etc/kubernetes/pki/apiserver-etcd-client.crt @172.19.0.46: scp /etc/kubernetes/pki/apiserver-etcd-client.key @172.19.0.46: scp /etc/kubernetes/pki/etcd/ca.crt 172 .19.0.46:etcd-ca.crt scp /etc/kubernetes/admin.conf 172 .19.0.46: \u518d\u572846\u8282\u70b9\u4e0a mkdir -p /etc/kubernetes/pki/etcd mv /root/ca.crt /etc/kubernetes/pki/ mv /root/ca.key /etc/kubernetes/pki/ mv /root/sa.pub /etc/kubernetes/pki/ mv /root/sa.key /etc/kubernetes/pki/ mv /root/apiserver-etcd-client.crt /etc/kubernetes/pki/ mv /root/apiserver-etcd-client.key /etc/kubernetes/pki/ mv /root/front-proxy-ca.crt /etc/kubernetes/pki/ mv /root/front-proxy-ca.key /etc/kubernetes/pki/ mv /root/etcd-ca.crt /etc/kubernetes/pki/etcd/ca.crt mv /root/admin.conf /etc/kubernetes/admin.conf 46\u4ee5\u4e3b\u8282\u70b9\u65b9\u5f0f\u52a0\u5165ha\u96c6\u7fa4\uff0c\u6ce8\u610f\u5176\u4e2dtoken\u4e3a\u524d\u976245\u8282\u70b9\u521d\u59cb\u5316\u65f6\u7684\u56de\u663e\u4e2d\u7684\u4fe1\u606f kubeadm join 172.19.0.41:6443 --token xxx.yyy --discovery-token-ca-cert-hash sha256:zzz --control-plane 47\uff0c48\uff0c49\u4ee5worker\u8282\u70b9\u65b9\u5f0f\u52a0\u5165, \u5206\u522b\u6267\u884c, \u6ce8\u610f\u6ca1\u6709--control-plane\u7684\u9009\u9879 kubeadm join 172.19.0.41:6443 --token xxx.yyy --discovery-token-ca-cert-hash sha256:zzz \u6ce8\u610f\u4e3a\u4e86\u4fdd\u969c\u7f51\u7edc\u7545\u901a\uff0c\u8fd8\u8981\u786e\u4fdd\u5b89\u88c5\u4e86CNI\u7f51\u7edc\u63d2\u4ef6\uff0c\u8fd9\u91cc\u9009\u7528Calico\uff0c\u5176\u5b89\u88c5\u65b9\u5f0f\u4e3a kubectl apply -f https://docs.projectcalico.org/v3.14/manifests/calico.yaml python\u4ee3\u7801 \u8fd9\u91cc\u4f7f\u7528fastapi\u6784\u5efa\u4e00\u5957\u7b80\u5355\u7684api\uff0c\u4e3a\u4e86\u7b80\u4fbf\uff0c\u6570\u636e\u5e93\u90e8\u5206\u4f7f\u7528\u5185\u5b58\u5bf9\u8c61\u6765mock \u7f16\u8f91main.py\u6587\u4ef6 from typing import Optional from fastapi import FastAPI , Header , HTTPException from pydantic import BaseModel fake_secret_token = \"coneofsilence\" fake_db = { \"foo\" : { \"id\" : \"foo\" , \"title\" : \"Foo\" , \"description\" : \"There goes my hero\" }, \"bar\" : { \"id\" : \"bar\" , \"title\" : \"Bar\" , \"description\" : \"The bartenders\" }, } app = FastAPI () class Item ( BaseModel ): id : str title : str description : Optional [ str ] = None @app . get ( \"/items/ {item_id} \" , response_model = Item ) async def read_main ( item_id : str , x_token : str = Header ( ... )): if x_token != fake_secret_token : raise HTTPException ( status_code = 400 , detail = \"Invalid X-Token header\" ) if item_id not in fake_db : raise HTTPException ( status_code = 404 , detail = \"Item not found\" ) return fake_db [ item_id ] @app . post ( \"/items/\" , response_model = Item ) async def create_item ( item : Item , x_token : str = Header ( ... )): if x_token != fake_secret_token : raise HTTPException ( status_code = 400 , detail = \"Invalid X-Token header\" ) if item . id in fake_db : raise HTTPException ( status_code = 400 , detail = \"Item already exists\" ) fake_db [ item . id ] = item return item \u5bf9\u5e94\u7684test\u6d4b\u8bd5\u4e3a \u7f16\u8f91test_main.py from fastapi.testclient import TestClient from main import app client = TestClient ( app ) def test_read_item (): response = client . get ( \"/items/foo\" , headers = { \"X-Token\" : \"coneofsilence\" }) assert response . status_code == 200 assert response . json () == { \"id\" : \"foo\" , \"title\" : \"Foo\" , \"description\" : \"There goes my hero\" , } def test_read_item_bad_token (): response = client . get ( \"/items/foo\" , headers = { \"X-Token\" : \"hailhydra\" }) assert response . status_code == 400 assert response . json () == { \"detail\" : \"Invalid X-Token header\" } def test_read_inexistent_item (): response = client . get ( \"/items/baz\" , headers = { \"X-Token\" : \"coneofsilence\" }) assert response . status_code == 404 assert response . json () == { \"detail\" : \"Item not found\" } def test_create_item (): response = client . post ( \"/items/\" , headers = { \"X-Token\" : \"coneofsilence\" }, json = { \"id\" : \"foobar\" , \"title\" : \"Foo Bar\" , \"description\" : \"The Foo Barters\" }, ) assert response . status_code == 200 assert response . json () == { \"id\" : \"foobar\" , \"title\" : \"Foo Bar\" , \"description\" : \"The Foo Barters\" , } def test_create_item_bad_token (): response = client . post ( \"/items/\" , headers = { \"X-Token\" : \"hailhydra\" }, json = { \"id\" : \"bazz\" , \"title\" : \"Bazz\" , \"description\" : \"Drop the bazz\" }, ) assert response . status_code == 400 assert response . json () == { \"detail\" : \"Invalid X-Token header\" } def test_create_existing_item (): response = client . post ( \"/items/\" , headers = { \"X-Token\" : \"coneofsilence\" }, json = { \"id\" : \"foo\" , \"title\" : \"The Foo ID Stealers\" , \"description\" : \"There goes my stealer\" , }, ) assert response . status_code == 400 assert response . json () == { \"detail\" : \"Item already exists\" } \u7a0b\u5e8f\u8fd0\u884c\u65b9\u5f0f\u4e3a uvicorn main:app --reload , \u6d4b\u8bd5\u8fd0\u884c\u65b9\u5f0f\u4e3a pytest -v test_main.py \u4f9d\u8d56\u6587\u4ef6requirements.txt attrs == 19.3 . 0 certifi == 2020.6 . 20 chardet == 3.0 . 4 click == 7.1 . 2 fastapi == 0.58 . 1 flake8 == 3.8 . 3 h11 == 0.9 . 0 httptools == 0.1 . 1 idna == 2.10 mccabe == 0.6 . 1 more - itertools == 8.4 . 0 packaging == 20.4 pluggy == 0.13 . 1 py == 1.9 . 0 pycodestyle == 2.6 . 0 pydantic == 1.6 . 1 pyflakes == 2.2 . 0 pyparsing == 2.4 . 7 pytest == 5.4 . 3 requests == 2.24 . 0 six == 1.15 . 0 starlette == 0.13 . 4 urllib3 == 1.25 . 9 uvicorn == 0.11 . 5 uvloop == 0.14 . 0 wcwidth == 0.2 . 5 websockets == 8.1 Dockerfile\u6784\u5efaImage FROM python:3.8-slim WORKDIR /opt/app copy ./ /opt/app RUN pip3 install --no-cache-dir -r /opt/app/requirements.txt -i https://mirrors.aliyun.com/pypi/simple/ ENV PYTHONPATH /opt/app CMD [ \"uvicorn\" , \"main:app\" , \"--host\" , \"0.0.0.0\" ] \u955c\u50cf\u57fa\u4e8epython3.8\u7684slim(debian)\u7248\u4f5c\u4e3a\u57fa\u7840\u955c\u50cf \u6d41\u6c34\u7ebf\u7f16\u6392\u6587\u4ef6 \u56e0\u4e3aJenkins\u7684\u9ed8\u8ba4\u914d\u7f6e\uff0c\u6211\u4eec\u53ef\u4ee5\u4ee5groovy\u5b9a\u5236\u7684DSL\u6765\u7f16\u5199\u6d41\u6c34\u7ebf \u7f16\u8f91Jenkinsfile pipeline { agent any stages { stage ( 'Cloning Git' ) { steps { git 'https://github.com/pingf/hello-world-fastapi.git' } } stage ( 'Building image' ) { steps { script { dockerImage = docker . build imageName + \":$BUILD_NUMBER\" } } } stage ( 'Run Test' ) { steps { script { sh \"docker run --rm \" + imageName + \":$BUILD_NUMBER pytest -v\" } } } stage ( 'Run Flake' ) { steps { script { sh \"docker run --rm \" + imageName + \":$BUILD_NUMBER flake8 main.py\" } } } stage ( 'Publishing Image' ) { parallel { stage ( 'Publishing Image' ) { steps { script { docker . withRegistry ( \"http://\" + registry , registryCred ) { dockerImage . push () } } } } stage ( 'publish to test registry' ) { steps { script { docker . withRegistry ( \"http://\" + registryTest , registryCred ) { dockerImage . push () } } } } stage ( 'publish to prod registry' ) { steps { script { docker . withRegistry ( \"http://\" + registryProd , registryCred ) { dockerImage . push () } } } } } } stage ( 'Clean Local Image' ) { steps { script { sh \"docker rmi \" + registry + \"/\" + imageName + \":$BUILD_NUMBER\" } } } stage ( 'Deploy' ) { parallel { stage ( 'deploy to dev' ) { steps { script { withKubeConfig ([ credentialsId: 'MYKUBE' , serverUrl: 'https://172.19.0.41:6443' , namespace: 'twwork' ]) { sh 'cat deploy.yaml | sed -e \"s/\\\\\\${name}/' + name + '/g\" | sed -e \"s/\\\\\\${port}/' + port + '/g\" | sed -e \"s/\\\\\\${namespace}/' + namespace + '/g\" | sed -e \"s/\\\\\\${registry}/' + registry + '/g\" | sed -e \"s/\\\\\\${version}/' + \"$BUILD_NUMBER\" + '/g\" >> twdeploy.yaml' sh 'cat twdeploy.yaml' sh 'kubectl apply -f twdeploy.yaml' } } } } stage ( 'deploy to test' ) { steps { input 'Deploy to test?' script { withKubeConfig ([ credentialsId: 'MYKUBE' , serverUrl: 'https://172.19.0.41:6443' , namespace: 'twwork' ]) { sh 'cat deploy.yaml | sed -e \"s/\\\\\\${name}/' + nameTest + '/g\" | sed -e \"s/\\\\\\${port}/' + portTest + '/g\" | sed -e \"s/\\\\\\${namespace}/' + namespace + '/g\" | sed -e \"s/\\\\\\${registry}/' + registry + '/g\" | sed -e \"s/\\\\\\${version}/' + \"$BUILD_NUMBER\" + '/g\" >> twdeploy-test.yaml' sh 'cat twdeploy-test.yaml' sh 'kubectl apply -f twdeploy-test.yaml' } } } } stage ( 'deploy to prod' ) { steps { input 'Deploy to prod?' script { withKubeConfig ([ credentialsId: 'MYKUBE' , serverUrl: 'https://172.19.0.41:6443' , namespace: 'twwork' ]) { sh 'cat deploy.yaml | sed -e \"s/\\\\\\${name}/' + nameProd + '/g\" | sed -e \"s/\\\\\\${port}/' + portProd + '/g\" | sed -e \"s/\\\\\\${namespace}/' + namespace + '/g\" | sed -e \"s/\\\\\\${registry}/' + registry + '/g\" | sed -e \"s/\\\\\\${version}/' + \"$BUILD_NUMBER\" + '/g\" >> twdeploy-prod.yaml' sh 'cat twdeploy-prod.yaml' sh 'kubectl apply -f twdeploy-prod.yaml' } } } } } } } environment { registry = '172.19.0.1:8082' registryTest = '172.19.0.1:8084' registryProd = '172.19.0.1:8086' imageName = 'meng/helloworld-fastapi' registryCred = 'DOCKER_CRED' namespace = 'default' namespaceTest = 'twtest' namespaceProd = 'twprod' name = 'demo' nameTest = 'demo-test' nameProd = 'demo-prod' port = '30081' portTest = '30082' portProd = '30083' } } \u5f53\u6211\u4eec\u6253\u5f00Jenkins\u7684Blue Ocean UI\uff0c\u53ef\u4ee5\u901a\u8fc7\u6784\u5efa\uff0c\u770b\u5230\u5177\u4f53\u7684\u6d41\u6c34\u7ebf\u7684\u5f62\u6001 \u5176\u4e2ddeploy to test\u548cdeploy to prod\u4e3a\u624b\u52a8\u786e\u8ba4\u9636\u6bb5\uff0c\u5176\u5b83\u4e3a\u81ea\u52a8\u9636\u6bb5 \u53e6\u5916\u5411\u591a\u4e2a\u73af\u5883publish image\u4e3a\u5e76\u884c\u5904\u7406\u9636\u6bb5 \u8981\u6ce8\u610f\u4e24\u70b9 docker . withRegistry ( \"http://\" + registry , registryCred ) { dockerImage . push () } \u4ee5\u53ca withKubeConfig ([ credentialsId: 'MYKUBE' , serverUrl: 'https://172.19.0.41:6443' , namespace: 'twwork' ]) { sh 'cat deploy.yaml | sed -e \"s/\\\\\\${name}/' + nameTest + '/g\" | sed -e \"s/\\\\\\${port}/' + portTest + '/g\" | sed -e \"s/\\\\\\${namespace}/' + namespace + '/g\" | sed -e \"s/\\\\\\${registry}/' + registry + '/g\" | sed -e \"s/\\\\\\${version}/' + \"$BUILD_NUMBER\" + '/g\" >> twdeploy-test.yaml' sh 'cat twdeploy-test.yaml' sh 'kubectl apply -f twdeploy-test.yaml' } \u8fd9\u4e24\u6bb5\u4ee3\u7801\u4e3a\u4e86\u4fdd\u8bc1\u5b89\u5168\u6027\uff0c\u4f7f\u7528\u4e86jenkins\u7684credential\u673a\u5236\uff0c\u4e14\u5206\u522b\u4e3auser/password\u548csecret file\u5f62\u5f0f\u6dfb\u52a0 \u53e6\u5916\u5728\u8c03\u7528kubectl apply\u65f6\uff0c\u4e3a\u4e86\u5c06jenkins\u6784\u5efa\u65f6\u7684\u53c2\u6570\u52a8\u6001\u4f20\u5165\uff0c\u4f7f\u7528sed\u8fdb\u884c\u6a21\u677f\u66ff\u6362 deploy\u6a21\u677f apiVersion : apps/v1 kind : Deployment metadata : name : ${name} labels : app : ${name} namespace : ${namespace} spec : replicas : 3 selector : matchLabels : app : ${name} template : metadata : labels : app : ${name} spec : containers : - name : ${name} image : ${registry}/meng/helloworld-fastapi:${version} ports : - containerPort : 8000 --- apiVersion : v1 kind : Service metadata : name : ${name} namespace : ${namespace} spec : ports : - name : http nodePort : ${port} port : 8000 protocol : TCP targetPort : 8000 selector : app : ${name} type : NodePort \u90e8\u7f72\u540e\u8fd0\u884c\u5c55\u793a \u56e0\u4e3a\u4f7f\u7528\u674eNodePort\u5bf9\u5916\u66b4\u9732\uff0c\u4ee5dev\u73af\u5883\u4e3a\u4f8b \u6211\u4eec\u8bbf\u95ee http://172.19.0.45:30081/docs , \u53ef\u4ee5\u901a\u8fc7swagger\u7684try it out\u754c\u9762\u8fdb\u884c\u624b\u5de5\u6d4b\u8bd5 \u4e5f\u53ef\u901a\u8fc7 http://172.19.0.45:30081/redoc \u66f4\u597d\u7684\u89c2\u770b\u6587\u6863 \u5f53\u6211\u4eec\u914d\u7f6e\u4e86istio\u7b49service mesh\u7ec4\u4ef6\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7kiali\u7b49\u7ec4\u4ef6\u8fdb\u884c\u94fe\u8def\u5206\u6790 \u53ef\u80fd\u6027\u6539\u8fdb \u76ee\u524d\u7684\u65b9\u6848\u56e0\u4e3a\u7f51\u7edc\u73af\u5883\u6709\u9650\uff0c\u6ca1\u6709\u516c\u7f51ip\uff0cpush\u89e6\u53d1\u6ca1\u6709\u914d\u7f6e\u3002 \u53c8\u56e0\u4e3a\u65f6\u95f4\u6709\u9650\uff0c\u53ea\u662f\u4fdd\u8bc1\u4e86\u8fd0\u884c\u65f6\u67b6\u6784\u4ee5\u53ca\u7528\u6237\u7a0b\u5e8f\uff08\u7531k8s\u4fdd\u8bc1\uff09\u7684ha\uff0c\u5982\u679c\u65f6\u95f4\u5141\u8bb8\uff0c\u8fd8\u53ef\u4ee5\u6709\u5f88\u591a\u6539\u5584\u7684\u73a9\u6cd5\uff0c \u6bd4\u5982jenkins\u4ee5\u53canexus\u5728k8s\u5185\u7684ha\u90e8\u7f72\uff0cjenkins\u590d\u7528k8s\u673a\u5236\u52a8\u6001\u8d77worker\u7b49\u3002 \u540c\u65f6\uff0c\u65f6\u95f4\u5141\u8bb8\u7684\u5316\u4e5f\u53ef\u4ee5\u914d\u7f6e\u4e0bpromethues\u914d\u5408loki\u6216\u8005elk\u7b49\u5b8c\u6210\u76d1\u63a7\u4ee5\u53ca\u65e5\u5fd7\u7684\u76d1\u63a7\u4e0e\u5206\u6790\u7b49\u3002 \u53e6\u5916\uff0c\u5728k8s\u73af\u5883\u4e0b\u6709\u66f4\u52a0\u4e91\u539f\u751f\u7684JenkinsX\u4e5f\u53ef\u4ee5\u8003\u8651\u4f7f\u7528\u3002 \u540e\u8bb0 \u8fd9\u6837\u4e00\u4efd\u8fd9\u4e48\u5b8c\u6574\u7684\u65b9\u6848\uff0c\u7adf\u7136\u6ca1\u6709\u4e00\u6b21\u901a\u8fc7\u3002 \u7ed9\u7684\u7406\u7531\u662f, \u90e8\u7f72\u65b9\u6848\u653e\u5728\u6587\u6863\u91cc\uff0c\u6ca1\u6709\u72ec\u7acb\u5199\u51fa\u81ea\u52a8\u5316\u7684\u811a\u672c\u3002 \u5982\u679c\u662fjenkins\uff0cnexus\u8fd9\u6837\uff0c\u56e0\u4e3a\u6587\u4e2d\u7ed9\u51fa\u7684\u662fdocker\u7b80\u6613\u90e8\u7f72\u6a21\u5f0f\uff0c\u90fd\u662f\u4e00\u884c\u547d\u4ee4\u884c\u800c\u4ee5\uff0c\u653e\u54ea\u91cc\u5176\u5b9e\u533a\u522b\u4e0d\u5927\u3002 \u5982\u679c\u662fk8s\u7684\u90e8\u7f72\uff0c\u8fd9\u91cc\u7ed9\u7684\u662fha\u90e8\u7f72\uff0c\u8981\u6c42\u8fd9\u90fd\u4e00\u952e\u90e8\u7f72\uff0c\u6211\u8fd9\u65b9\u6848\u90fd\u53ef\u4ee5\u5f53\u4ea7\u54c1\u5356\u94b1\u4e86\u3002 \u6574\u4f53\u5bf9tw\u597d\u611f\u5ea6\u9aa4\u7136\u4e0b\u964d\u3002 /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = 'https://devs-wiki.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); Please enable JavaScript to view the comments powered by Disqus.","title":"\u79c1\u6709\u4e91DevOps\u6301\u7eed\u6784\u5efa\u7cfb\u7edf\u7684\u642d\u5efa"},{"location":"notes/2020/devops/twhomework/doc/#devops","text":"-- thoughtworks devops\u9762\u8bd5\u9898\u89e3\u7b54 author: \u5b5f\u7e41\u8d85(dameng/Makefile\u541b) copyright\uff1a \u7248\u6743\u6240\u6709\uff0c\u5982\u9700\u8f6c\u8f7d\u8bf7\u8054\u7cfb pingf0@gmail.com","title":"\u79c1\u6709\u4e91DevOps\u6301\u7eed\u6784\u5efa\u7cfb\u7edf\u7684\u642d\u5efa"},{"location":"notes/2020/devops/twhomework/doc/#_1","text":"thoughtworks\u7684DevOps\u7684\u9762\u8bd5\u9898\u76ee\u4e2d\u7684\u6838\u5fc3\u8981\u6c42\u5982\u4e0b(\u7ec6\u8282\u7684\u8bdd\u6682\u4e0d\u65b9\u4fbf\u900f\u9732): - \u63d0\u4f9b\u4e00\u4e2a\u7ed9\u5f00\u53d1\u4f7f\u7528\u7684\u73af\u5883 - \u642d\u5efa\u4e00\u4e2aCI/CD\u73af\u5883\u6784\u5efa\u76f8\u5173\u7684\u5236\u54c1 - \u901a\u8fc7CI/CD\u5c06\u5f00\u53d1\u4ee3\u7801\u90e8\u7f72\u5230\u76f8\u5e94\u7684\u73af\u5883\u4e0a","title":"\u80cc\u666f:"},{"location":"notes/2020/devops/twhomework/doc/#_2","text":"\u5176\u4e2d\u6d89\u53ca\u5230\u4e24\u5757\u73af\u5883\u7684\u642d\u5efa\uff0c\u4e00\u4e2a\u662f\u642d\u5efa\u8fd0\u884c\u65f6\u73af\u5883\uff0c\u4e00\u4e2a\u662f\u6784\u5efaCI/CD\u7cfb\u7edf\u3002\u540c\u65f6\u5176\u4e5f\u9690\u6027\u7684\u8981\u6c42\u4e86\uff0c\u7f16\u5199demo\u4ee3\u7801\uff0c\u901a\u8fc7CI/CD\u7cfb\u7edf\u90e8\u7f72\u5230\u642d\u5efa\u7684\u8fd0\u884c\u65f6\u73af\u5883\u4e2d\u53bb\u3002 \u6240\u4ee5\u5c06\u4efb\u52a1\u9700\u6c42\u8fdb\u884c\u62c6\u5206 - CI/CD\u73af\u5883\u7684\u642d\u5efa\uff08\u5305\u542b\u4e2d\u95f4\u4ea7\u51fa\u5236\u54c1\u4f9d\u8d56\u7cfb\u7edf\u7684\u642d\u5efa\uff09 - \u8fd0\u884c\u65f6\u73af\u5883\u7684\u642d\u5efa - demo\u4ee3\u7801\u7684\u7f16\u5199 - \u6d41\u6c34\u7ebf\u7684\u6d89\u53ca - \u5b9e\u9645\u6784\u5efa\u90e8\u7f72\u7684\u5c55\u793a","title":"\u601d\u8def\u5206\u6790:"},{"location":"notes/2020/devops/twhomework/doc/#_3","text":"\u56e0\u4e3a\u662f\u5c55\u793a\u6027\u7684\u9898\u76ee\uff0c\u8fd9\u91cc\u5728\u6280\u672f\u9009\u578b\u4e0a\u5e76\u4e0d\u4f1a\u6709\u5386\u53f2\u5305\u88b1\uff0c\u6240\u4ee5\u8fd9\u91cc\u9009\u7528\u5f00\u6e90\u4e91\u539f\u751f\u7684\u4e00\u5957\u4f53\u7cfb\u8fdb\u884c\u642d\u5efa\u3002 - \u5236\u54c1\u7edf\u4e00\u4f7f\u7528Docker\u955c\u50cf\u7684\u65b9\u5f0f\u8fdb\u884c\u6d41\u8f6c\uff0c\u8fd0\u884c\u73af\u5883\u4e3aK8s\u73af\u5883\uff08\u5b9e\u9645\u90e8\u7f72\u4f7f\u7528\u4e86HA\u65b9\u6848\uff0c\u5e76\u90e8\u7f72\u4e86istio\u8fd9\u6837\u7684service mesh\u6846\u67b6\uff09 - CI/CD\u73af\u5883\u4e3a Jenkins 2 (\u901a\u8fc7\u63d2\u4ef6\u65b9\u5f0f\u5b9e\u73b0docker\u955c\u50cf\u6784\u5efa\u4e0e\u53d1\u5e03\u4ee5\u53cak8s\u7684\u90e8\u7f72) - \u4e2d\u95f4\u5236\u54c1\u7684\u5b58\u50a8\u4f7f\u7528 Nexus 3 \uff08\u867d\u7136Nexus\u662f\u4e00\u4e2a\u901a\u7528\u7684\u5236\u54c1\u4ed3\u5e93\uff0c\u4f46\u662f\u8fd9\u91cc\u91cd\u70b9\u9488\u5bf9\u5176Docker\u955c\u50cf\u4ed3\u5e93\u8fdb\u884c\u64cd\u4f5c\uff09 - \u6d41\u6c34\u7ebf\u90e8\u5206\u4f7f\u7528jenkinsfile\uff0c\u5b9e\u73b0\u4e86pipeline as code\uff0c\u5e76\u4e14\u4ee5\u6a21\u62df\u7684\u5f62\u5f0f\u533a\u5206\u4e86\u5f00\u53d1\uff0c\u6d4b\u8bd5\uff0c\u751f\u4ea7\u4e09\u5957\u73af\u5883\uff08\u7406\u8bba\u4e0a\u53ef\u4ee5\u66f4\u591a\uff0c\u4f46\u662f\u6682\u65f6\u53ea\u9009\u4e86\u8fd9\u4e09\u4e2a\u6700\u57fa\u7840\u7684\u73af\u5883\uff09 - demo\u4f7f\u7528\u7684python\u7684fastapi\u6846\u67b6\u8fdb\u884c\u642d\u5efa\uff0c\u6d4b\u8bd5\u90e8\u5206\u63d0\u4f9b\u4e86pytest\u7684\u6d4b\u8bd5\u4ee3\u7801\uff0c\u5e76\u539f\u751f\u63d0\u4f9b\u4e86swagger ui\u8fdb\u884c\u5728\u7ebf\u6d4b\u8bd5\u529f\u80fd\uff0c\u4ee5\u53caredoc\u9875\u9762\u8fdb\u884capi\u6587\u6863\u6d4f\u89c8","title":"\u6280\u672f\u9009\u578b\uff1a"},{"location":"notes/2020/devops/twhomework/doc/#_4","text":"\u4e3a\u4e86\u65b9\u4fbfJenkins\u4ee5\u53caNexus\u7684\u642d\u5efa\u5728\u6b64\u6b21\u63d0\u4ea4\u7684\u4f5c\u4e1a\u4e2d\u5e76\u6ca1\u6709\u653e\u5728k8s\u96c6\u7fa4\u4e2d\uff0c\u800c\u662f\u72ec\u7acb\u5728\u4e3b\u673a\u4e0a\u4ee5docker\u65b9\u5f0f\u72ec\u7acb\u542f\u52a8 \u4e3b\u673a\u4e3a\u6211\u7684\u7b14\u8bb0\u672c\u7535\u8111 cpu: i7 9750h, 1T\u786c\u76d8\uff0c 64G \u5185\u5b58 k8s\u8fd0\u884c\u65f6\u73af\u5883\u4f7f\u7528\u7684\u662f\u6700\u65b0\u7248\u672c\uff081.18\uff09\u7684k8s\uff0c\u91c7\u7528\u4e86\u9ad8\u53ef\u7528\u7684\u90e8\u7f72\u65b9\u6848\uff0c\u5171\u8017\u8d39\u4e868\u53f0kvm\u865a\u62df\u673a\uff0c\u6bcf\u53f0\u673a\u5668\u5206\u914d2\u68384G\u5185\u5b58\uff0c\u7cfb\u7edf\u4e3adebian 10.4 \u5b9e\u9645\u5f00\u9500\u4e3a\u5c06\u8fd140G\u7684\u5185\u5b58\uff08\u622a\u56fe\u4e2d\u4e3a35.7G\u4f7f\u7528\u91cf\uff0c\u5b9e\u9645\u6d4b\u8bd5\u65f6\u6709\u5230\u8fc740G\uff09","title":"\u786c\u4ef6\u914d\u7f6e"},{"location":"notes/2020/devops/twhomework/doc/#_5","text":"","title":"\u89e3\u51b3\u65b9\u6848"},{"location":"notes/2020/devops/twhomework/doc/#devops_1","text":"\u6309\u7167\u5cf0\u8fbe\u6574\u7406\u7684\u76f8\u5bf9\u5b8c\u5907\u7684Devops\u6d41\u7a0b\u4e2d\uff0c\u5e94\u5305\u62ec\u5982\u4e0b\u51e0\u4e2a\u73af\u8282 \u4f46\u662f\u8fd9\u91cc\u56e0\u4e3a\u65f6\u95f4\u548c\u7cbe\u529b\u6709\u9650\uff0c\u53ea\u6311\u9009\u4e86\u5176\u4e2d\u76f8\u5bf9\u6bd4\u8f83\u91cd\u8981\u7684\u73af\u8282\u8fdb\u884c\u642d\u5efa\u6f14\u793a \u56fe\u4e2d\u8986\u76d6\u4e86CI/CD\u7684\u6838\u5fc3\u73af\u8282\uff0c\u6d41\u6c34\u7ebf\u4e3b\u8981\u6d41\u7a0b\u6db5\u76d6\u4e86\u5982\u4e0b\u51e0\u4e2a\u73af\u8282 \u4ee3\u7801\u7684\u62c9\u53d6 \u955c\u50cf\u7684\u6784\u5efa \u6d4b\u8bd5\u4e0e\u8d28\u91cf \u5236\u54c1\u7684\u53d1\u5e03 \u5783\u573e\u7684\u6e05\u7406 \u5236\u54c1\u7684\u90e8\u7f72 \u6570\u636e\u7684\u5c55\u793a*\uff08\u90e8\u7f72istio\u540e\u81ea\u5e26\uff09 \u540c\u65f6\u901a\u8fc7Nexus\u521b\u5efa\u4e86\u4e09\u4e2a\u4e0d\u540c\u7684\u4ed3\u5e93\u7528\u6765\u533a\u5206\u955c\u50cf\u7684\u73af\u5883\uff0c\u800c\u5728K8s\u96c6\u7fa4\u4e2d\u4ee5\u4e0d\u540cnamespace","title":"DevOps\u6d41\u7a0b\u67b6\u6784"},{"location":"notes/2020/devops/twhomework/doc/#_6","text":"\u4e3a\u4e86\u65b9\u4fbf\u540e\u7eed\u63cf\u8ff0\uff0c\u8fd9\u91cc\u7ed9\u51fa\u90e8\u7f72\u8282\u70b9\u7684\u67b6\u6784\u56fe \u6ce8\u610f\uff0c\u56fe\u4e2d172.19.0.1\u4e3a\u5bbf\u4e3b\u673a\u5728172.19\u7f51\u6bb5\u7684IP\uff0c\u4e5f\u53ef\u901a\u8fc7127.0.0.1\u6216192.168.31.72(\u6211\u7684\u5916\u90e8\u7f51\u7edc\u5206\u914d\u7684IP)\u8fdb\u884c\u8bbf\u95ee\uff0c\u540e\u6587\u4e2d\u5982\u679c\u6709\u76f8\u5173IP\uff0c\u5747\u6307\u5411\u540c\u4e00\u673a\u5668","title":"\u90e8\u7f72\u67b6\u6784"},{"location":"notes/2020/devops/twhomework/doc/#docker","text":"\u5378\u8f7d\u65e7\u7248 sudo apt-get remove docker docker-engine docker.io containerd runc \u914d\u7f6e\u6e90 sudo apt-get update sudo apt-get install \\ apt-transport-https \\ ca-certificates \\ curl \\ gnupg-agent \\ software-properties-common curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add - sudo add-apt-repository \\ \"deb [arch=amd64] https://download.docker.com/linux/ubuntu \\ $( lsb_release -cs ) \\ stable\" \u5b89\u88c5docker sudo apt-get update sudo apt-get install docker-ce docker-ce-cli containerd.io \u7528\u6237\u7ec4\u8d4b\u80fd sudo groupadd docker sudo usermod -aG docker $USER \u4fee\u6539\u914d\u7f6e \u4fee\u6539 /etc/docker/daemon.json \u5982\u4e0b { \"registry-mirrors\": [ \"https://registry.docker-cn.com\", \"http://hub-mirror.c.163.com\", \"https://docker.mirrors.ustc.edu.cn\", \"https://reg-mirror.qiniu.com\", \"https://quay.azk8s.cn\", \"https://gcr.azk8s.cn\", \"https://dockerhub.azk8s.cn\" ], \"exec-opts\": [\"native.cgroupdriver=systemd\"], \"log-driver\": \"json-file\", \"log-opts\": { \"max-size\": \"100m\" }, \"insecure-registries\": [\"0.0.0.0/0\"], \"storage-driver\": \"overlay2\" } \u5e76\u91cd\u542fdocker\uff0c sudo service docker restart","title":"Docker\u7684\u5b89\u88c5"},{"location":"notes/2020/devops/twhomework/doc/#kubectl","text":"\u5bbf\u4e3b\u673a\u5668\u4e0a\u5b89\u88c5kubectl \u53ea\u662f\u65b9\u4fbf\u64cd\u4f5ck8s\u96c6\u7fa4\uff0c\u56e0\u4e3ajenkins\u4f1a\u7528\u5230kubectl\uff0c\u6240\u4ee5\u8fd9\u91cc\u5b89\u88c5\u540e\uff0c\u53ef\u4ee5\u76f4\u63a5\u6302\u8f7d\u7ed9jenkins\u4f7f\u7528\u3002 apt-get update && apt-get install -y apt-transport-https curl https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg | apt-key add - cat <<EOF >/etc/apt/sources.list.d/kubernetes.list deb https://mirrors.aliyun.com/kubernetes/apt/ kubernetes-xenial main EOF apt-get update apt-get install -y kubectl","title":"KubeCtl\u7684\u5b89\u88c5"},{"location":"notes/2020/devops/twhomework/doc/#jenkins","text":"\u5728\u4e3b\u673a\u4e0a\u4ee5docker\u8fd0\u884cJenkins\u975e\u5e38\u65b9\u4fbf\uff0c\u4f46\u662f\u8981\u56e0\u4e3a\u8981\u5bf9\u63a5docker\u548ck8s docker run -d -v /home/dameng/jenkins:/var/jenkins_home -v /var/run/docker.sock:/var/run/docker.sock --name jenkins -v $(which docker):/usr/bin/docker -v $(which kubectl):/usr/bin/kubectl --group-add=$(stat -c %g /var/run/docker.sock) -v /home/dameng/jenkins/.docker-jenkins:/.docker -v /home/dameng/jenkins/.kube:/.kube --network host jenkins/jenkins:lts \u8981\u6ce8\u610f: - \u7aef\u53e38080,50000\u662f\u5fc5\u987b\u8981\u66b4\u9732\u7684\uff0c\u7b80\u5355\u8d77\u89c1\u8fd9\u91cc\u4f7f\u7528\u4e86host\u7f51\u7edc\u6a21\u5f0f - \u914d\u7f6e\u6587\u4ef6\u72ec\u7acb\u6302\u8f7d - \u590d\u7528\u5bbf\u4e3b\u673a\u7684docker(cli\u4ee5\u53caunix socket)\uff0ckubectl\uff08cli\u4ee5\u53cakube config\u914d\u7f6e\uff09 \u5728\u5b89\u88c5\u540e\u53ef\u901a\u8fc78080\u7aef\u53e3\u8fdb\u884c\u8bbf\u95ee\uff0c\u4e3a\u4e86\u65b9\u4fbf\u548c\u7f8e\u89c2\u9009\u88c5Blue Ocean UI\uff0c Docker Pipeline\uff0c Kubernetes CLI\u7b49\u63d2\u4ef6 \u63d2\u4ef6\u5b89\u88c5\u9875\u9762 Blue Ocean UI","title":"Jenkins\u7684\u5b89\u88c5\u4e0e\u914d\u7f6e"},{"location":"notes/2020/devops/twhomework/doc/#nexus","text":"\u548c\u524d\u9762\u8fd0\u884cJenkins\u7684\u65b9\u5f0f\u7c7b\u4f3c\uff0c\u8fd9\u91cc\u6211\u4eec\u4e5f\u4f7f\u7528docker\u7684\u65b9\u5f0f\u6765\u8fd0\u884cNexus docker run -d --network host --name nexus -v /home/dameng/nexus:/nexus-data sonatype/nexus3 \u540c\u6837\u4e5f\u6709\u4e9b\u8981\u6ce8\u610f\u7684\u5730\u65b9 \u7aef\u53e38081\u662f\u5fc5\u987b\u8981\u66b4\u9732\u7684\uff0c\u7b80\u5355\u8d77\u89c1\u8fd9\u91cc\u4f7f\u7528\u4e86host\u7f51\u7edc\u6a21\u5f0f \u914d\u7f6e\u6587\u4ef6\u72ec\u7acb\u6302\u8f7d \u767b\u9646\u4e4b\u540e\uff0c\u4f1a\u751f\u6210\u9996\u6b21\u8fd0\u884c\u7528\u5bc6\u7801\uff0c\u4f4d\u4e8e\u5bb9\u5668\u4e2d /nexus-data/admin.password \u6587\u4ef6\u4e2d\uff0c\u4f7f\u7528\u5176\u767b\u9646\u540e\u6709UI\u63d0\u793a\u4fee\u6539\u5bc6\u7801\uff0c\u4fee\u6539\u5373\u53ef Nexus\u652f\u6301maven\uff0cpip\uff0cnode\uff0cdocker registry\u7b49\u591a\u79cd\u4ed3\u5e93\uff0c\u672c\u6587\u6240\u8ba8\u8bba\u7684\u53ea\u6d89\u53caDocker Registry\u3002\u53e6\u5916\u5176\u8fd8\u652f\u6301host\uff0cproxy\uff0cgroup\u4e09\u79cd\u6a21\u5f0f\uff0c\u53ef\u4ee5\u642d\u914d\u4f7f\u7528\uff0c\u4f46\u8fd9\u91cc\u7684\u65b9\u6848\u76f4\u63a5\u4f7f\u7528host\u6a21\u5f0f\u7684docker registry\uff0c\u5206\u522b\u5bf9\u5e94\u5f00\u53d1\uff0c\u6d4b\u8bd5\uff0c\u751f\u4ea7\u73af\u5883\u7684\u955c\u50cf\u4ed3\u5e93\u3002 \u8fd9\u91cc\u5206\u522b\u5c068082,8083\u89c4\u5212\u4e3adev\u73af\u5883\u7684http\u548chttps\u7aef\u53e3\uff0c8084,8085\u5bf9\u5e94\u5f00\u53d1\u73af\u5883\uff0c8086\uff0c8087\u5bf9\u5e94\u751f\u4ea7\u73af\u5883\u3002 \u53e6\u5916\u8981\u6ce8\u610f\u7684\u662f\uff0c\u521b\u5efa\u5b8c\u6210\u540e\u5e76\u4e0d\u80fd\u76f4\u63a5login\uff0c\u9700\u8981\u901a\u8fc7realms\u8bbe\u7f6edocker bearer token realm\uff0c\u5b8c\u6210\u6388\u6743\u7684\u7ba1\u7406\u3002","title":"Nexus\u7684\u5b89\u88c5\u4e0e\u914d\u7f6e"},{"location":"notes/2020/devops/twhomework/doc/#k8s-ha","text":"","title":"K8s \u73af\u5883\u642d\u5efa\uff08HA\uff09"},{"location":"notes/2020/devops/twhomework/doc/#_7","text":"\u9664\u4e86\u4e0a\u9762docker\u7684\u914d\u7f6e\u4ee5\u5916\uff0c\u4e3a\u4e86\u7b80\u4fbf\uff0c\u8fd9\u91cc\u5bf9\u6bcf\u53f0K8s\u8282\u70b9\u8fdb\u884c\u5982\u4e0b\u64cd\u4f5c \u786e\u5b9asystemctl\u7ba1\u7406\u670d\u52a1\u7684\u7cfb\u7edf\uff08\u5982debian\uff0cubuntu, fedora\uff09 \u914d\u7f6e\u597dssh\u767b\u9646 \u5f00\u542fIpForward \u7f16\u8f91 /etc/sysctl.conf \u4fee\u6539 net.ipv4.ip_forward = 1 \u7136\u540e\u6267\u884c sysctl --system - \u5173\u95edswap\u5206\u533a \u7f16\u8f91 /etc/fstab \u6ce8\u91ca \u548cswap\u76f8\u5173\u7684\u884c\uff0c\u91cd\u542f\u6216\u6267\u884c\u547d\u4ee4 swapoff -a","title":"\u57fa\u7840\u914d\u7f6e"},{"location":"notes/2020/devops/twhomework/doc/#_8","text":"apt-get update && apt-get install -y apt-transport-https curl https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg | apt-key add - cat <<EOF >/etc/apt/sources.list.d/kubernetes.list deb https://mirrors.aliyun.com/kubernetes/apt/ kubernetes-xenial main EOF apt-get update apt-get install -y kubelet kubeadm kubectl","title":"\u5b89\u88c5\u4e09\u5927\u4ef6\uff08\u4e0d\u662f\u6bcf\u53f0\u673a\u5668\u90fd\u9700\u8981\uff0c\u4f46\u662f\u9ed8\u8ba4\u65b9\u4fbf\uff0c\u53ef\u4ee5\u65e0\u8111\u5b89\u88c5\uff09"},{"location":"notes/2020/devops/twhomework/doc/#_9","text":"\u6267\u884c kubeadm config images list \u83b7\u5f97 k8s.gcr.io/kube-apiserver:v1.18.6 k8s.gcr.io/kube-controller-manager:v1.18.6 k8s.gcr.io/kube-scheduler:v1.18.6 k8s.gcr.io/kube-proxy:v1.18.6 k8s.gcr.io/pause:3.2 k8s.gcr.io/etcd:3.4.3-0 k8s.gcr.io/coredns:1.6.7 \u7f16\u8f91\u811a\u672c\u5e76\u6267\u884c #! bash images =( kube-apiserver:v1.18.3 kube-controller-manager:v1.18.3 kube-scheduler:v1.18.3 kube-proxy:v1.18.3 pause:3.2 etcd:3.4.3-0 coredns:1.6.7 ) for imageName in ${ images [@] } ; do docker pull registry.cn-hangzhou.aliyuncs.com/google_containers/ $imageName docker tag registry.cn-hangzhou.aliyuncs.com/google_containers/ $imageName k8s.gcr.io/ $imageName docker rmi registry.cn-hangzhou.aliyuncs.com/google_containers/ $imageName done","title":"\u62c9\u53d6\u955c\u50cf"},{"location":"notes/2020/devops/twhomework/doc/#haproxy","text":"42\uff0c43\u8282\u70b9\u5b89\u88c5haproxy apt-get update && apt-get upgrade && apt-get install -y haproxy \u7f16\u8f91 /etc/haproxy/haproxy.cfg global user haproxy group haproxy defaults mode http log global retries 2 timeout connect 3000ms timeout server 5000ms timeout client 5000ms frontend kubernetes bind 172 .19.0.41:6443,172.19.0.41:30843 option tcplog mode tcp default_backend kubernetes-master-nodes backend kubernetes-master-nodes mode tcp balance roundrobin option tcp-check server deb45 172 .19.0.45 check fall 3 rise 2 server deb46 172 .19.0.46 check fall 3 rise 2 \u4fee\u6539 /etc/sysctl.conf \u6587\u4ef6 net.ipv4.ip_nonlocal_bind = 1 \u4e4b\u540e\u6267\u884c sysctl -p \uff0c\u4e4b\u540e\u6267\u884c systemctl start haproxy","title":"haproxy"},{"location":"notes/2020/devops/twhomework/doc/#heartbeat-vip","text":"apt-get -y install heartbeat && systemctl enable heartbeat \u751f\u6210heartbeat\u7528\u7684key echo -n securepass | md5sum \u5c06\u751f\u6210\u7684\u7c7b\u4f3c\u5982\u4e0b\u5185\u5bb9\u5199\u5165 /etc/ha.d/authkeys \uff0c \u5e76\u4fee\u6539\u6743\u9650 chmod 600 /etc/ha.d/authkeys aba7d0d3b3f239fa5db79bdf27b4d19z \u914d\u7f6eheartbeat \u5728 /etc/ha.d/ha.cf \u6dfb\u52a0heartbeat\u6240\u5728\u7684\u8282\u70b9 node deb42 deb43 \u5176\u4e2ddeb42\uff0cdeb43\u5728 /etc/hosts \u914d\u7f6e\u6210\u4e86.42\u548c.43\u7684\u8282\u70b9 \u914d\u7f6e /etc/ha.d/haresources .42\u8282\u70b9\u914d\u7f6e\u6210 deb42 172 .19.0.41 .43\u8282\u70b9\u914d\u7f6e\u6210 deb43 172 .19.0.41 \u4e4b\u540e\u91cd\u542fheartbeat, systemctl restart heartbeat","title":"heartbeat &amp; VIP"},{"location":"notes/2020/devops/twhomework/doc/#etcd-ha","text":"\u4e0b\u9762\u914d\u7f6e\u9700\u8981\u5728bash\u4e0b\u8fd0\u884c export HOST0 = 172 .19.0.42 export HOST1 = 172 .19.0.43 export HOST2 = 172 .19.0.44 mkdir -p /tmp/ ${ HOST0 } / /tmp/ ${ HOST1 } / /tmp/ ${ HOST2 } / ETCDHOSTS =( ${ HOST0 } ${ HOST1 } ${ HOST2 } ) NAMES =( \"infra0\" \"infra1\" \"infra2\" ) for i in \" ${ !ETCDHOSTS[@] } \" ; do HOST = ${ ETCDHOSTS [ $i ] } NAME = ${ NAMES [ $i ] } cat << EOF > /tmp/${HOST}/kubeadmcfg.yaml apiVersion: \"kubeadm.k8s.io/v1beta1\" kind: ClusterConfiguration etcd: local: serverCertSANs: - \"${HOST}\" peerCertSANs: - \"${HOST}\" extraArgs: initial-cluster: ${NAMES[0]}=https://${ETCDHOSTS[0]}:2380,${NAMES[1]}=https://${ETCDHOSTS[1]}:2380,${NAMES[2]}=https://${ETCDHOSTS[2]}:2380 initial-cluster-state: new name: ${NAME} listen-peer-urls: https://${HOST}:2380 listen-client-urls: https://${HOST}:2379 advertise-client-urls: https://${HOST}:2379 initial-advertise-peer-urls: https://${HOST}:2380 EOF done \u4e4b\u540e\uff0c kubeadm init phase certs etcd-ca \u751f\u6210ca.crt\u548cca.key \u751f\u6210\u8bc1\u4e66 kubeadm init phase certs etcd-server --config = /tmp/ ${ HOST0 } /kubeadmcfg.yaml ` kubeadm init phase certs etcd-peer --config = /tmp/ ${ HOST0 } /kubeadmcfg.yaml kubeadm init phase certs etcd-healthcheck-client --config = /tmp/ ${ HOST0 } /kubeadmcfg.yaml kubeadm init phase certs apiserver-etcd-client --config = /tmp/ ${ HOST0 } /kubeadmcfg.yaml cp -R /etc/kubernetes/pki /tmp/ ${ HOST0 } / kubeadm init phase certs etcd-server --config = /tmp/ ${ HOST1 } /kubeadmcfg.yaml ` kubeadm init phase certs etcd-peer --config = /tmp/ ${ HOST1 } /kubeadmcfg.yaml kubeadm init phase certs etcd-healthcheck-client --config = /tmp/ ${ HOST1 } /kubeadmcfg.yaml kubeadm init phase certs apiserver-etcd-client --config = /tmp/ ${ HOST1 } /kubeadmcfg.yaml cp -R /etc/kubernetes/pki /tmp/ ${ HOST1 } / kubeadm init phase certs etcd-server --config = /tmp/ ${ HOST2 } /kubeadmcfg.yaml ` kubeadm init phase certs etcd-peer --config = /tmp/ ${ HOST2 } /kubeadmcfg.yaml kubeadm init phase certs etcd-healthcheck-client --config = /tmp/ ${ HOST2 } /kubeadmcfg.yaml kubeadm init phase certs apiserver-etcd-client --config = /tmp/ ${ HOST2 } /kubeadmcfg.yaml cp -R /etc/kubernetes/pki /tmp/ ${ HOST2 } / \u6309\u9700\u62f7\u8d1d scp -r /tmp/ ${ HOST0 } /* ${ HOST0 } : scp -r /tmp/ ${ HOST1 } /* ${ HOST1 } : scp -r /tmp/ ${ HOST2 } /* ${ HOST2 } : \u572842\uff0c43\uff0c44\u8282\u70b9\u4e0a\u6267\u884c cd /root mv pki /etc/kubernetes/ \u6574\u4f53\u8282\u70b9\u76ee\u5f55\u4e3a /root \u2514\u2500\u2500 kubeadmcfg.yaml --- /etc/kubernetes/pki \u251c\u2500\u2500 apiserver-etcd-client.crt \u251c\u2500\u2500 apiserver-etcd-client.key \u2514\u2500\u2500 etcd \u251c\u2500\u2500 ca.crt \u251c\u2500\u2500 healthcheck-client.crt \u251c\u2500\u2500 healthcheck-client.key \u251c\u2500\u2500 peer.crt \u251c\u2500\u2500 peer.key \u251c\u2500\u2500 server.crt \u2514\u2500\u2500 server.key 42,43,44\u5206\u522b\u6267\u884c kubeadm init phase etcd local --config = /tmp/172.19.0.42/kubeadmcfg.yaml kubeadm init phase etcd local --config = /tmp/172.19.0.43/kubeadmcfg.yaml kubeadm init phase etcd local --config = /tmp/172.19.0.44/kubeadmcfg.yaml","title":"etcd ha"},{"location":"notes/2020/devops/twhomework/doc/#_10","text":"\u5148\u914d\u7f6e45\u8282\u70b9\uff0c \u62f7\u8d1detcd\u8bc1\u4e66\u523045\u4e3b\u8282\u70b9 scp /etc/kubernetes/pki/etcd/ca.crt 172 .19.0.45: scp /etc/kubernetes/pki/apiserver-etcd-client.crt 172 .19.0.45: scp /etc/kubernetes/pki/apiserver-etcd-client.key 172 .19.0.45: \u7f16\u8f91kubeadm-config.yaml apiVersion: kubeadm.k8s.io/v1beta1 kind: ClusterConfiguration kubernetesVersion: stable apiServer: certSANs: - \"172.19.0.41\" controlPlaneEndpoint: \"172.19.0.41:6443\" etcd: external: endpoints: - https://172.19.0.42:2379 - https://172.19.0.43:2379 - https://172.19.0.44:2379 caFile: /etc/kubernetes/pki/etcd/ca.crt certFile: /etc/kubernetes/pki/apiserver-etcd-client.crt keyFile: /etc/kubernetes/pki/apiserver-etcd-client.key \u62f7\u8d1d\u8bc1\u4e66 mkdir -p /etc/kubernetes/pki/etcd/ cp /root/ca.crt /etc/kubernetes/pki/etcd/ cp /root/apiserver-etcd-client.crt /etc/kubernetes/pki/ cp /root/apiserver-etcd-client.key /etc/kubernetes/pki/ kubeadm\u521d\u59cb\u5316 kubeadm init --config kubeadm-config.yaml \u518d\u914d\u7f6e46\u8282\u70b9\uff0c\u572845\u8282\u70b9\u4e0a\u6267\u884c scp /etc/kubernetes/pki/ca.crt 172 .19.0.46: scp /etc/kubernetes/pki/ca.key 172 .19.0.46: scp /etc/kubernetes/pki/sa.key 172 .19.0.46: scp /etc/kubernetes/pki/sa.pub 172 .19.0.46: scp /etc/kubernetes/pki/front-proxy-ca.crt @172.19.0.46: scp /etc/kubernetes/pki/front-proxy-ca.key @172.19.0.46: scp /etc/kubernetes/pki/apiserver-etcd-client.crt @172.19.0.46: scp /etc/kubernetes/pki/apiserver-etcd-client.key @172.19.0.46: scp /etc/kubernetes/pki/etcd/ca.crt 172 .19.0.46:etcd-ca.crt scp /etc/kubernetes/admin.conf 172 .19.0.46: \u518d\u572846\u8282\u70b9\u4e0a mkdir -p /etc/kubernetes/pki/etcd mv /root/ca.crt /etc/kubernetes/pki/ mv /root/ca.key /etc/kubernetes/pki/ mv /root/sa.pub /etc/kubernetes/pki/ mv /root/sa.key /etc/kubernetes/pki/ mv /root/apiserver-etcd-client.crt /etc/kubernetes/pki/ mv /root/apiserver-etcd-client.key /etc/kubernetes/pki/ mv /root/front-proxy-ca.crt /etc/kubernetes/pki/ mv /root/front-proxy-ca.key /etc/kubernetes/pki/ mv /root/etcd-ca.crt /etc/kubernetes/pki/etcd/ca.crt mv /root/admin.conf /etc/kubernetes/admin.conf 46\u4ee5\u4e3b\u8282\u70b9\u65b9\u5f0f\u52a0\u5165ha\u96c6\u7fa4\uff0c\u6ce8\u610f\u5176\u4e2dtoken\u4e3a\u524d\u976245\u8282\u70b9\u521d\u59cb\u5316\u65f6\u7684\u56de\u663e\u4e2d\u7684\u4fe1\u606f kubeadm join 172.19.0.41:6443 --token xxx.yyy --discovery-token-ca-cert-hash sha256:zzz --control-plane 47\uff0c48\uff0c49\u4ee5worker\u8282\u70b9\u65b9\u5f0f\u52a0\u5165, \u5206\u522b\u6267\u884c, \u6ce8\u610f\u6ca1\u6709--control-plane\u7684\u9009\u9879 kubeadm join 172.19.0.41:6443 --token xxx.yyy --discovery-token-ca-cert-hash sha256:zzz \u6ce8\u610f\u4e3a\u4e86\u4fdd\u969c\u7f51\u7edc\u7545\u901a\uff0c\u8fd8\u8981\u786e\u4fdd\u5b89\u88c5\u4e86CNI\u7f51\u7edc\u63d2\u4ef6\uff0c\u8fd9\u91cc\u9009\u7528Calico\uff0c\u5176\u5b89\u88c5\u65b9\u5f0f\u4e3a kubectl apply -f https://docs.projectcalico.org/v3.14/manifests/calico.yaml","title":"\u914d\u7f6e\u4e3b\u8282\u70b9&amp;\u4ece\u8282\u70b9"},{"location":"notes/2020/devops/twhomework/doc/#python","text":"\u8fd9\u91cc\u4f7f\u7528fastapi\u6784\u5efa\u4e00\u5957\u7b80\u5355\u7684api\uff0c\u4e3a\u4e86\u7b80\u4fbf\uff0c\u6570\u636e\u5e93\u90e8\u5206\u4f7f\u7528\u5185\u5b58\u5bf9\u8c61\u6765mock \u7f16\u8f91main.py\u6587\u4ef6 from typing import Optional from fastapi import FastAPI , Header , HTTPException from pydantic import BaseModel fake_secret_token = \"coneofsilence\" fake_db = { \"foo\" : { \"id\" : \"foo\" , \"title\" : \"Foo\" , \"description\" : \"There goes my hero\" }, \"bar\" : { \"id\" : \"bar\" , \"title\" : \"Bar\" , \"description\" : \"The bartenders\" }, } app = FastAPI () class Item ( BaseModel ): id : str title : str description : Optional [ str ] = None @app . get ( \"/items/ {item_id} \" , response_model = Item ) async def read_main ( item_id : str , x_token : str = Header ( ... )): if x_token != fake_secret_token : raise HTTPException ( status_code = 400 , detail = \"Invalid X-Token header\" ) if item_id not in fake_db : raise HTTPException ( status_code = 404 , detail = \"Item not found\" ) return fake_db [ item_id ] @app . post ( \"/items/\" , response_model = Item ) async def create_item ( item : Item , x_token : str = Header ( ... )): if x_token != fake_secret_token : raise HTTPException ( status_code = 400 , detail = \"Invalid X-Token header\" ) if item . id in fake_db : raise HTTPException ( status_code = 400 , detail = \"Item already exists\" ) fake_db [ item . id ] = item return item \u5bf9\u5e94\u7684test\u6d4b\u8bd5\u4e3a \u7f16\u8f91test_main.py from fastapi.testclient import TestClient from main import app client = TestClient ( app ) def test_read_item (): response = client . get ( \"/items/foo\" , headers = { \"X-Token\" : \"coneofsilence\" }) assert response . status_code == 200 assert response . json () == { \"id\" : \"foo\" , \"title\" : \"Foo\" , \"description\" : \"There goes my hero\" , } def test_read_item_bad_token (): response = client . get ( \"/items/foo\" , headers = { \"X-Token\" : \"hailhydra\" }) assert response . status_code == 400 assert response . json () == { \"detail\" : \"Invalid X-Token header\" } def test_read_inexistent_item (): response = client . get ( \"/items/baz\" , headers = { \"X-Token\" : \"coneofsilence\" }) assert response . status_code == 404 assert response . json () == { \"detail\" : \"Item not found\" } def test_create_item (): response = client . post ( \"/items/\" , headers = { \"X-Token\" : \"coneofsilence\" }, json = { \"id\" : \"foobar\" , \"title\" : \"Foo Bar\" , \"description\" : \"The Foo Barters\" }, ) assert response . status_code == 200 assert response . json () == { \"id\" : \"foobar\" , \"title\" : \"Foo Bar\" , \"description\" : \"The Foo Barters\" , } def test_create_item_bad_token (): response = client . post ( \"/items/\" , headers = { \"X-Token\" : \"hailhydra\" }, json = { \"id\" : \"bazz\" , \"title\" : \"Bazz\" , \"description\" : \"Drop the bazz\" }, ) assert response . status_code == 400 assert response . json () == { \"detail\" : \"Invalid X-Token header\" } def test_create_existing_item (): response = client . post ( \"/items/\" , headers = { \"X-Token\" : \"coneofsilence\" }, json = { \"id\" : \"foo\" , \"title\" : \"The Foo ID Stealers\" , \"description\" : \"There goes my stealer\" , }, ) assert response . status_code == 400 assert response . json () == { \"detail\" : \"Item already exists\" } \u7a0b\u5e8f\u8fd0\u884c\u65b9\u5f0f\u4e3a uvicorn main:app --reload , \u6d4b\u8bd5\u8fd0\u884c\u65b9\u5f0f\u4e3a pytest -v test_main.py \u4f9d\u8d56\u6587\u4ef6requirements.txt attrs == 19.3 . 0 certifi == 2020.6 . 20 chardet == 3.0 . 4 click == 7.1 . 2 fastapi == 0.58 . 1 flake8 == 3.8 . 3 h11 == 0.9 . 0 httptools == 0.1 . 1 idna == 2.10 mccabe == 0.6 . 1 more - itertools == 8.4 . 0 packaging == 20.4 pluggy == 0.13 . 1 py == 1.9 . 0 pycodestyle == 2.6 . 0 pydantic == 1.6 . 1 pyflakes == 2.2 . 0 pyparsing == 2.4 . 7 pytest == 5.4 . 3 requests == 2.24 . 0 six == 1.15 . 0 starlette == 0.13 . 4 urllib3 == 1.25 . 9 uvicorn == 0.11 . 5 uvloop == 0.14 . 0 wcwidth == 0.2 . 5 websockets == 8.1","title":"python\u4ee3\u7801"},{"location":"notes/2020/devops/twhomework/doc/#dockerfileimage","text":"FROM python:3.8-slim WORKDIR /opt/app copy ./ /opt/app RUN pip3 install --no-cache-dir -r /opt/app/requirements.txt -i https://mirrors.aliyun.com/pypi/simple/ ENV PYTHONPATH /opt/app CMD [ \"uvicorn\" , \"main:app\" , \"--host\" , \"0.0.0.0\" ] \u955c\u50cf\u57fa\u4e8epython3.8\u7684slim(debian)\u7248\u4f5c\u4e3a\u57fa\u7840\u955c\u50cf","title":"Dockerfile\u6784\u5efaImage"},{"location":"notes/2020/devops/twhomework/doc/#_11","text":"\u56e0\u4e3aJenkins\u7684\u9ed8\u8ba4\u914d\u7f6e\uff0c\u6211\u4eec\u53ef\u4ee5\u4ee5groovy\u5b9a\u5236\u7684DSL\u6765\u7f16\u5199\u6d41\u6c34\u7ebf \u7f16\u8f91Jenkinsfile pipeline { agent any stages { stage ( 'Cloning Git' ) { steps { git 'https://github.com/pingf/hello-world-fastapi.git' } } stage ( 'Building image' ) { steps { script { dockerImage = docker . build imageName + \":$BUILD_NUMBER\" } } } stage ( 'Run Test' ) { steps { script { sh \"docker run --rm \" + imageName + \":$BUILD_NUMBER pytest -v\" } } } stage ( 'Run Flake' ) { steps { script { sh \"docker run --rm \" + imageName + \":$BUILD_NUMBER flake8 main.py\" } } } stage ( 'Publishing Image' ) { parallel { stage ( 'Publishing Image' ) { steps { script { docker . withRegistry ( \"http://\" + registry , registryCred ) { dockerImage . push () } } } } stage ( 'publish to test registry' ) { steps { script { docker . withRegistry ( \"http://\" + registryTest , registryCred ) { dockerImage . push () } } } } stage ( 'publish to prod registry' ) { steps { script { docker . withRegistry ( \"http://\" + registryProd , registryCred ) { dockerImage . push () } } } } } } stage ( 'Clean Local Image' ) { steps { script { sh \"docker rmi \" + registry + \"/\" + imageName + \":$BUILD_NUMBER\" } } } stage ( 'Deploy' ) { parallel { stage ( 'deploy to dev' ) { steps { script { withKubeConfig ([ credentialsId: 'MYKUBE' , serverUrl: 'https://172.19.0.41:6443' , namespace: 'twwork' ]) { sh 'cat deploy.yaml | sed -e \"s/\\\\\\${name}/' + name + '/g\" | sed -e \"s/\\\\\\${port}/' + port + '/g\" | sed -e \"s/\\\\\\${namespace}/' + namespace + '/g\" | sed -e \"s/\\\\\\${registry}/' + registry + '/g\" | sed -e \"s/\\\\\\${version}/' + \"$BUILD_NUMBER\" + '/g\" >> twdeploy.yaml' sh 'cat twdeploy.yaml' sh 'kubectl apply -f twdeploy.yaml' } } } } stage ( 'deploy to test' ) { steps { input 'Deploy to test?' script { withKubeConfig ([ credentialsId: 'MYKUBE' , serverUrl: 'https://172.19.0.41:6443' , namespace: 'twwork' ]) { sh 'cat deploy.yaml | sed -e \"s/\\\\\\${name}/' + nameTest + '/g\" | sed -e \"s/\\\\\\${port}/' + portTest + '/g\" | sed -e \"s/\\\\\\${namespace}/' + namespace + '/g\" | sed -e \"s/\\\\\\${registry}/' + registry + '/g\" | sed -e \"s/\\\\\\${version}/' + \"$BUILD_NUMBER\" + '/g\" >> twdeploy-test.yaml' sh 'cat twdeploy-test.yaml' sh 'kubectl apply -f twdeploy-test.yaml' } } } } stage ( 'deploy to prod' ) { steps { input 'Deploy to prod?' script { withKubeConfig ([ credentialsId: 'MYKUBE' , serverUrl: 'https://172.19.0.41:6443' , namespace: 'twwork' ]) { sh 'cat deploy.yaml | sed -e \"s/\\\\\\${name}/' + nameProd + '/g\" | sed -e \"s/\\\\\\${port}/' + portProd + '/g\" | sed -e \"s/\\\\\\${namespace}/' + namespace + '/g\" | sed -e \"s/\\\\\\${registry}/' + registry + '/g\" | sed -e \"s/\\\\\\${version}/' + \"$BUILD_NUMBER\" + '/g\" >> twdeploy-prod.yaml' sh 'cat twdeploy-prod.yaml' sh 'kubectl apply -f twdeploy-prod.yaml' } } } } } } } environment { registry = '172.19.0.1:8082' registryTest = '172.19.0.1:8084' registryProd = '172.19.0.1:8086' imageName = 'meng/helloworld-fastapi' registryCred = 'DOCKER_CRED' namespace = 'default' namespaceTest = 'twtest' namespaceProd = 'twprod' name = 'demo' nameTest = 'demo-test' nameProd = 'demo-prod' port = '30081' portTest = '30082' portProd = '30083' } } \u5f53\u6211\u4eec\u6253\u5f00Jenkins\u7684Blue Ocean UI\uff0c\u53ef\u4ee5\u901a\u8fc7\u6784\u5efa\uff0c\u770b\u5230\u5177\u4f53\u7684\u6d41\u6c34\u7ebf\u7684\u5f62\u6001 \u5176\u4e2ddeploy to test\u548cdeploy to prod\u4e3a\u624b\u52a8\u786e\u8ba4\u9636\u6bb5\uff0c\u5176\u5b83\u4e3a\u81ea\u52a8\u9636\u6bb5 \u53e6\u5916\u5411\u591a\u4e2a\u73af\u5883publish image\u4e3a\u5e76\u884c\u5904\u7406\u9636\u6bb5 \u8981\u6ce8\u610f\u4e24\u70b9 docker . withRegistry ( \"http://\" + registry , registryCred ) { dockerImage . push () } \u4ee5\u53ca withKubeConfig ([ credentialsId: 'MYKUBE' , serverUrl: 'https://172.19.0.41:6443' , namespace: 'twwork' ]) { sh 'cat deploy.yaml | sed -e \"s/\\\\\\${name}/' + nameTest + '/g\" | sed -e \"s/\\\\\\${port}/' + portTest + '/g\" | sed -e \"s/\\\\\\${namespace}/' + namespace + '/g\" | sed -e \"s/\\\\\\${registry}/' + registry + '/g\" | sed -e \"s/\\\\\\${version}/' + \"$BUILD_NUMBER\" + '/g\" >> twdeploy-test.yaml' sh 'cat twdeploy-test.yaml' sh 'kubectl apply -f twdeploy-test.yaml' } \u8fd9\u4e24\u6bb5\u4ee3\u7801\u4e3a\u4e86\u4fdd\u8bc1\u5b89\u5168\u6027\uff0c\u4f7f\u7528\u4e86jenkins\u7684credential\u673a\u5236\uff0c\u4e14\u5206\u522b\u4e3auser/password\u548csecret file\u5f62\u5f0f\u6dfb\u52a0 \u53e6\u5916\u5728\u8c03\u7528kubectl apply\u65f6\uff0c\u4e3a\u4e86\u5c06jenkins\u6784\u5efa\u65f6\u7684\u53c2\u6570\u52a8\u6001\u4f20\u5165\uff0c\u4f7f\u7528sed\u8fdb\u884c\u6a21\u677f\u66ff\u6362","title":"\u6d41\u6c34\u7ebf\u7f16\u6392\u6587\u4ef6"},{"location":"notes/2020/devops/twhomework/doc/#deploy","text":"apiVersion : apps/v1 kind : Deployment metadata : name : ${name} labels : app : ${name} namespace : ${namespace} spec : replicas : 3 selector : matchLabels : app : ${name} template : metadata : labels : app : ${name} spec : containers : - name : ${name} image : ${registry}/meng/helloworld-fastapi:${version} ports : - containerPort : 8000 --- apiVersion : v1 kind : Service metadata : name : ${name} namespace : ${namespace} spec : ports : - name : http nodePort : ${port} port : 8000 protocol : TCP targetPort : 8000 selector : app : ${name} type : NodePort","title":"deploy\u6a21\u677f"},{"location":"notes/2020/devops/twhomework/doc/#_12","text":"\u56e0\u4e3a\u4f7f\u7528\u674eNodePort\u5bf9\u5916\u66b4\u9732\uff0c\u4ee5dev\u73af\u5883\u4e3a\u4f8b \u6211\u4eec\u8bbf\u95ee http://172.19.0.45:30081/docs , \u53ef\u4ee5\u901a\u8fc7swagger\u7684try it out\u754c\u9762\u8fdb\u884c\u624b\u5de5\u6d4b\u8bd5 \u4e5f\u53ef\u901a\u8fc7 http://172.19.0.45:30081/redoc \u66f4\u597d\u7684\u89c2\u770b\u6587\u6863 \u5f53\u6211\u4eec\u914d\u7f6e\u4e86istio\u7b49service mesh\u7ec4\u4ef6\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7kiali\u7b49\u7ec4\u4ef6\u8fdb\u884c\u94fe\u8def\u5206\u6790","title":"\u90e8\u7f72\u540e\u8fd0\u884c\u5c55\u793a"},{"location":"notes/2020/devops/twhomework/doc/#_13","text":"\u76ee\u524d\u7684\u65b9\u6848\u56e0\u4e3a\u7f51\u7edc\u73af\u5883\u6709\u9650\uff0c\u6ca1\u6709\u516c\u7f51ip\uff0cpush\u89e6\u53d1\u6ca1\u6709\u914d\u7f6e\u3002 \u53c8\u56e0\u4e3a\u65f6\u95f4\u6709\u9650\uff0c\u53ea\u662f\u4fdd\u8bc1\u4e86\u8fd0\u884c\u65f6\u67b6\u6784\u4ee5\u53ca\u7528\u6237\u7a0b\u5e8f\uff08\u7531k8s\u4fdd\u8bc1\uff09\u7684ha\uff0c\u5982\u679c\u65f6\u95f4\u5141\u8bb8\uff0c\u8fd8\u53ef\u4ee5\u6709\u5f88\u591a\u6539\u5584\u7684\u73a9\u6cd5\uff0c \u6bd4\u5982jenkins\u4ee5\u53canexus\u5728k8s\u5185\u7684ha\u90e8\u7f72\uff0cjenkins\u590d\u7528k8s\u673a\u5236\u52a8\u6001\u8d77worker\u7b49\u3002 \u540c\u65f6\uff0c\u65f6\u95f4\u5141\u8bb8\u7684\u5316\u4e5f\u53ef\u4ee5\u914d\u7f6e\u4e0bpromethues\u914d\u5408loki\u6216\u8005elk\u7b49\u5b8c\u6210\u76d1\u63a7\u4ee5\u53ca\u65e5\u5fd7\u7684\u76d1\u63a7\u4e0e\u5206\u6790\u7b49\u3002 \u53e6\u5916\uff0c\u5728k8s\u73af\u5883\u4e0b\u6709\u66f4\u52a0\u4e91\u539f\u751f\u7684JenkinsX\u4e5f\u53ef\u4ee5\u8003\u8651\u4f7f\u7528\u3002","title":"\u53ef\u80fd\u6027\u6539\u8fdb"},{"location":"notes/2020/devops/twhomework/doc/#_14","text":"\u8fd9\u6837\u4e00\u4efd\u8fd9\u4e48\u5b8c\u6574\u7684\u65b9\u6848\uff0c\u7adf\u7136\u6ca1\u6709\u4e00\u6b21\u901a\u8fc7\u3002 \u7ed9\u7684\u7406\u7531\u662f, \u90e8\u7f72\u65b9\u6848\u653e\u5728\u6587\u6863\u91cc\uff0c\u6ca1\u6709\u72ec\u7acb\u5199\u51fa\u81ea\u52a8\u5316\u7684\u811a\u672c\u3002 \u5982\u679c\u662fjenkins\uff0cnexus\u8fd9\u6837\uff0c\u56e0\u4e3a\u6587\u4e2d\u7ed9\u51fa\u7684\u662fdocker\u7b80\u6613\u90e8\u7f72\u6a21\u5f0f\uff0c\u90fd\u662f\u4e00\u884c\u547d\u4ee4\u884c\u800c\u4ee5\uff0c\u653e\u54ea\u91cc\u5176\u5b9e\u533a\u522b\u4e0d\u5927\u3002 \u5982\u679c\u662fk8s\u7684\u90e8\u7f72\uff0c\u8fd9\u91cc\u7ed9\u7684\u662fha\u90e8\u7f72\uff0c\u8981\u6c42\u8fd9\u90fd\u4e00\u952e\u90e8\u7f72\uff0c\u6211\u8fd9\u65b9\u6848\u90fd\u53ef\u4ee5\u5f53\u4ea7\u54c1\u5356\u94b1\u4e86\u3002 \u6574\u4f53\u5bf9tw\u597d\u611f\u5ea6\u9aa4\u7136\u4e0b\u964d\u3002 /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = 'https://devs-wiki.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); Please enable JavaScript to view the comments powered by Disqus.","title":"\u540e\u8bb0"},{"location":"notes/2020/golang/basic/","text":"\u7b2c\u4e00\u4e2aGo\u7a0b\u5e8f package main import \"fmt\" func main () { fmt . Println ( \"hello world\" ) } \u5305\u58f0\u660e \u5305\u5bfc\u5165 \u51fd\u6570 main fmt \u51fd\u6570 package main import \"fmt\" // Hello func func Hello () { fmt . Println ( \"hello world\" ) } func main () { Hello () } \u72ec\u7acbHello\u51fd\u6570\u5230\u4e00\u4e2a\u6587\u4ef6\u4e2d \u5982\u679c\u6211\u4eec\u5c06\u4e0a\u8ff0\u6587\u4ef6\u62c6\u5206\u6210main.go\u548chello.go\u6587\u4ef6\uff0c\u5e76\u653e\u5728\u4e00\u4e2a\u6587\u4ef6\u5939\u4e0b\uff0c\u7c7b\u4f3c package main import \"hello\" func main () { Hello () } package hello import \"fmt\" // Hello func func Hello () { fmt . Println ( \"hello world\" ) } \u5176\u4f1a\u6709\u62a5\u9519\uff0c\u8981\u4e48\u662f\u627e\u4e0d\u5230hello\u7684\u5305\uff08\u4e0d\u5728gopath\u4e0b\u9762\uff09\uff0c\u8981\u4e48\u662f\u4e00\u4e2a\u6587\u4ef6\u5939\u4e0b\u6709\u591a\u4e2apackage\uff08main\u548chello\uff09 \u8fd9\u91cc\u6211\u4eec\u5047\u8bbe\u6211\u4eec\u4f7f\u7528go mod init basic\u6765\u521d\u59cb\u5316\uff0c\u8fd9\u6837\u5f53\u524d\u7684\u76ee\u5f55\u5c31\u76f8\u5f53\u4e0eGOPATH\u4e0b\u7684\u4e00\u4e2a\u76ee\u5f55\u4e86\uff0c \u53e6\u5916\uff0c\u8003\u8651\u5230\u5728\u4e00\u4e2a\u76ee\u5f55\u4e0b\uff0cgolang\u53ea\u5141\u8bb8\u4e00\u4e2apackage name\uff0c\u6211\u4eec\u9700\u8981\u628ahello.go\u653e\u5728\u72ec\u7acb\u7684\u6587\u4ef6\u5939\u4e0b\u9762 \u6211\u4eec\u5728\u76ee\u5f55\u7ed3\u6784\u4e0a\u505a\u5982\u4e0b\u7684\u4fee\u6539 . \u251c\u2500\u2500 go.mod \u251c\u2500\u2500 hello \u2502 \u2514\u2500\u2500 hello.go \u2514\u2500\u2500 main.go \u5176\u4e2dgo.mod\u5185\u5bb9\u5982\u4e0b module basic go 1 .14 hello/hello.go \u5185\u5bb9\u5982\u4e0b package hello import \"fmt\" // Hello func func Hello () { fmt . Println ( \"hello world\" ) } main.go\u5185\u5bb9\u5982\u4e0b package main import h \"basic/hello\" func main () { h . Hello () } \u8fd9\u6837\uff0c\u5f53\u6211\u4eec\u4f7f\u7528 go run main.go \u8fd0\u884c\u4f9d\u65e7\u53ef\u4ee5\u8fd0\u884c\u3002 \u8981\u6ce8\u610f\u7684\u662f\uff0cpackage name\u548cdirectory name\u662f\u6709\u4e9b\u5dee\u5f02\u7684\uff0c \u4ece\u5f15\u5165\u672c\u5730\u5305\u7684\u89d2\u5ea6\uff0c\u8981\u4f7f\u7528directory name, \u800c\u4ece\u5b89\u88c5\u7684\u89d2\u5ea6\u8981\u4f7f\u7528package name\u3002 \u6bd4\u5982\u5f53\u4e0a\u9762\u7684hello\u6587\u4ef6\u5939\u6539\u4e3a\u4e86a\uff0c\u90a3\u4e48\u5728main\u6587\u4ef6\u4e2d\uff0c\u5e94\u5c06import\u6539\u4e3a\u201cbasic/hello\u201d\u3002 \u800cbasic\u51b3\u5b9a\u4e86go install\u65f6\uff0c\u751f\u6210\u7684\u6267\u884c\u6587\u4ef6\u540d\u79f0\u4e3abasic\u3002","title":"Basic"},{"location":"notes/2020/golang/basic/#go","text":"package main import \"fmt\" func main () { fmt . Println ( \"hello world\" ) } \u5305\u58f0\u660e \u5305\u5bfc\u5165 \u51fd\u6570 main fmt \u51fd\u6570 package main import \"fmt\" // Hello func func Hello () { fmt . Println ( \"hello world\" ) } func main () { Hello () }","title":"\u7b2c\u4e00\u4e2aGo\u7a0b\u5e8f"},{"location":"notes/2020/golang/basic/#hello","text":"\u5982\u679c\u6211\u4eec\u5c06\u4e0a\u8ff0\u6587\u4ef6\u62c6\u5206\u6210main.go\u548chello.go\u6587\u4ef6\uff0c\u5e76\u653e\u5728\u4e00\u4e2a\u6587\u4ef6\u5939\u4e0b\uff0c\u7c7b\u4f3c package main import \"hello\" func main () { Hello () } package hello import \"fmt\" // Hello func func Hello () { fmt . Println ( \"hello world\" ) } \u5176\u4f1a\u6709\u62a5\u9519\uff0c\u8981\u4e48\u662f\u627e\u4e0d\u5230hello\u7684\u5305\uff08\u4e0d\u5728gopath\u4e0b\u9762\uff09\uff0c\u8981\u4e48\u662f\u4e00\u4e2a\u6587\u4ef6\u5939\u4e0b\u6709\u591a\u4e2apackage\uff08main\u548chello\uff09 \u8fd9\u91cc\u6211\u4eec\u5047\u8bbe\u6211\u4eec\u4f7f\u7528go mod init basic\u6765\u521d\u59cb\u5316\uff0c\u8fd9\u6837\u5f53\u524d\u7684\u76ee\u5f55\u5c31\u76f8\u5f53\u4e0eGOPATH\u4e0b\u7684\u4e00\u4e2a\u76ee\u5f55\u4e86\uff0c \u53e6\u5916\uff0c\u8003\u8651\u5230\u5728\u4e00\u4e2a\u76ee\u5f55\u4e0b\uff0cgolang\u53ea\u5141\u8bb8\u4e00\u4e2apackage name\uff0c\u6211\u4eec\u9700\u8981\u628ahello.go\u653e\u5728\u72ec\u7acb\u7684\u6587\u4ef6\u5939\u4e0b\u9762 \u6211\u4eec\u5728\u76ee\u5f55\u7ed3\u6784\u4e0a\u505a\u5982\u4e0b\u7684\u4fee\u6539 . \u251c\u2500\u2500 go.mod \u251c\u2500\u2500 hello \u2502 \u2514\u2500\u2500 hello.go \u2514\u2500\u2500 main.go \u5176\u4e2dgo.mod\u5185\u5bb9\u5982\u4e0b module basic go 1 .14 hello/hello.go \u5185\u5bb9\u5982\u4e0b package hello import \"fmt\" // Hello func func Hello () { fmt . Println ( \"hello world\" ) } main.go\u5185\u5bb9\u5982\u4e0b package main import h \"basic/hello\" func main () { h . Hello () } \u8fd9\u6837\uff0c\u5f53\u6211\u4eec\u4f7f\u7528 go run main.go \u8fd0\u884c\u4f9d\u65e7\u53ef\u4ee5\u8fd0\u884c\u3002 \u8981\u6ce8\u610f\u7684\u662f\uff0cpackage name\u548cdirectory name\u662f\u6709\u4e9b\u5dee\u5f02\u7684\uff0c \u4ece\u5f15\u5165\u672c\u5730\u5305\u7684\u89d2\u5ea6\uff0c\u8981\u4f7f\u7528directory name, \u800c\u4ece\u5b89\u88c5\u7684\u89d2\u5ea6\u8981\u4f7f\u7528package name\u3002 \u6bd4\u5982\u5f53\u4e0a\u9762\u7684hello\u6587\u4ef6\u5939\u6539\u4e3a\u4e86a\uff0c\u90a3\u4e48\u5728main\u6587\u4ef6\u4e2d\uff0c\u5e94\u5c06import\u6539\u4e3a\u201cbasic/hello\u201d\u3002 \u800cbasic\u51b3\u5b9a\u4e86go install\u65f6\uff0c\u751f\u6210\u7684\u6267\u884c\u6587\u4ef6\u540d\u79f0\u4e3abasic\u3002","title":"\u72ec\u7acbHello\u51fd\u6570\u5230\u4e00\u4e2a\u6587\u4ef6\u4e2d"},{"location":"notes/2020/golang/ocp/","text":"Open-Closed Principle \u5f00\u653e\u5c01\u95ed\u51c6\u5219\u7684golang\u5b9e\u4f8b author: dameng(Makefile\u541b) \u6982\u5ff5\u5f15\u5bfc S.O.L.I.D \u539f\u5219\u4e2d\u7684 O \u5373\u6307\u660e\u7684\u662f\u5f00\u653e\u5c01\u95ed\u51c6\u5219, \u5176\u5021\u5bfc\u8f6f\u4ef6\u5b9e\u4f53\u5e94\u8be5\u662f\u53ef\u4ee5\u6269\u5c55\u7684\uff0c\u4f46\u4e0d\u63a5\u53d7\u4fee\u6539. Software entities (classes, modules, functions, etc.) should be open for extension, but closed for modification. \u573a\u666f\u642d\u5efa \u4e3a\u4e86\u65b9\u4fbf\u8bb2\u89e3\uff0c\u8fd9\u91cc\u4ee5\u4e00\u4e2a\u73b0\u5b9e\u4e2d\u7684\u4f8b\u5b50\u6765\u8bb2\u89e3\uff0c\u5047\u8bbe\u6211\u4eec\u7684\u4e3b\u4eba\u516c\u5c0f\u660e\u521a\u521a\u627e\u4e86\u4e00\u4efd\u65b0\u5de5\u4f5c\uff0c\u987a\u5e26\u60f3\u79df\u4e2a\u79bb\u516c\u53f8\u8fd1\u4e00\u70b9\u7684\u623f\u5b50, \u4e0e\u662f\u4ed6\u767b\u9646\u201c\u67d0\u5bb6\u201d\u7f51\u8fdb\u884c\u641c\u5bfb\uff0c\u53d1\u73b0\u5176\u53ef\u4ee5\u6309\u8ddd\u79bb\uff0c\u4e5f\u53ef\u4ee5\u6309\u4ef7\u4f4d\u8fdb\u884c\u641c\u7d22\u3002 \u6211\u4eec\u8fd9\u91cc\u5bf9\u623f\u5c4b\u8fdb\u884c\u4e00\u4e9b\u62bd\u8c61\uff0c\u5982\u679c\u6211\u4eec\u7684\u7528\u6237\u5173\u5fc3\u7684\u53ea\u6709\u8ddd\u79bb\u548c\u4ef7\u4f4d\u7f6e\uff0c\u90a3\u4e48\u53ef\u4ee5\u8fdb\u884c\u5982\u4e0b\u7684\u62bd\u8c61\u3002 type Estate struct { name string distance float64 price int64 } \u9664\u4e86\u4e3e\u4f8b\u548c\u4ef7\u4e3a\u4e4b\u5916\uff0c\u6211\u4eec\u589e\u52a0\u4e86\u4e00\u4e2aname\u5c5e\u6027\uff0c\u7528\u6765\u6807\u540d\u623f\u5c4b\u5177\u4f53\u7684\u4e0d\u540c\u3002 \u800c\u67e5\u8be2\u7684\u6761\u4ef6\u6709\u4e24\u4e2a\uff1a \u8ddd\u79bb\uff0c\u4ef7\u4f4d. \u6211\u4eec\u9700\u8981\u80fd\u5206\u522b\u6309\u7167\u8ddd\u79bb\u548c\u52a0\u4e3a\u8fdb\u884c\u67e5\u627e\uff0c\u8fd9\u91cc\u4e5f\u8fdb\u884c\u4e00\u4e9b\u62bd\u8c61\u5982\u4e0b type Filter struct { } func ( f * Filter ) FilterByPrice ( estates [] Estate , low int64 , high int64 ) [] * Estate { result := make ([] * Estate , 0 ) for i , v := range estates { if low <= v . price && v . price <= high { result = append ( result , & estates [ i ]) } } return result } func ( f * Filter ) FilterByDistance ( estates [] Estate , distance float64 ) [] * Estate { result := make ([] * Estate , 0 ) for i , v := range estates { if v . distance <= distance { result = append ( result , & estates [ i ]) } } return result } \u53ef\u4ee5\u770b\u5230\uff0cFilter\u7ed3\u6784\u4f53\u672c\u8eab\u5e76\u4e0d\u5305\u542b\u989d\u5916\u7684\u5c5e\u6027\uff0c\u53ea\u662f\u589e\u52a0\u4e86\u4e24\u4e2a\u67e5\u8be2\u7684\u65b9\u6cd5\u3002 \u771f\u6b63\u8c03\u7528\u65f6\uff0c\u6211\u4eec\u9700\u8981\u5148\u6784\u5efa\u4e00\u4e9b\u623f\u5c4b\u7684\u6570\u636e\uff0c\u6bd4\u5982 houses := [] Estate { { \"\u798f\u5c71\u4e00\u6751#1\" , 3.0 , 5500 }, { \"\u7531\u7531\u4e00\u6751#1\" , 4.0 , 4000 }, { \"\u9ad8\u5883\u4e00\u6751#1\" , 7.0 , 3500 } } \u5728\u67e5\u627e\u65f6\uff0c\u6211\u4eec\u9700\u8981\u58f0\u660e\u4e00\u4e2aFilter\u7684\u5b9e\u4f8b\u4ee5\u4fbf\u8c03\u7528\u5176\u65b9\u6cd5 f := Filter {} \u6309\u4ef7\u683c\u67e5\u627e for _ , v := range f . FilterByPrice ( houses , 2500 , 4500 ) { fmt . Println ( v . name ) } \u6309\u8ddd\u79bb\u67e5\u627e for _,v := range f.FilterByDistance(houses, 5.0) { fmt.Println(v.name) } \u9700\u6c42\u53d8\u66f4 \u8fd9\u4e2a\u65f6\u5019\u4e00\u4e2a\u5f88\u81ea\u7136\u5c31\u80fd\u5f15\u751f\u51fa\u6765\u7684\u9700\u6c42\u5c31\u662f \u540c\u65f6\u6309\u4ef7\u683c\u548c\u8ddd\u79bb\u8fdb\u884c\u67e5\u627e \u76f4\u89c2\u7684\u505a\u6cd5\u662f\u589e\u52a0\u4e00\u4e2a FilterByPriceAndDistance , \u5b8c\u6210\u76f8\u5e94\u6761\u4ef6\u5339\u914d\u7684\u641c\u5bfb \u6bd4\u5982\u53ef\u4ee5\u6309\u7167\u5982\u4e0b\u8fdb\u884c\u5b9e\u73b0 func ( f * Filter ) FilterByPriceAndDistance ( estates [] Estate , low int64 , high int64 , distance float64 ) [] * Estate { result := make ([] * Estate , 0 ) for i , v := range estates { if low <= v . price && v . price <= high && v . distance <= distance { result = append ( result , & estates [ i ]) } } return result } \u4f46\u662f\u8fd9\u662f\u4e0d\u7b26\u5408Open-Closed\u51c6\u5219\uff0c \u56e0\u4e3a\u8fd9\u662f\u4e00\u79cd\u201c\u4fb5\u5165\u5f0f\u201d\u7684\"\u4fee\u6539\"(\u8c03\u7528\u65f6\u51fd\u6570\u540d\u79f0\u7b49\u9700\u8981\u4fee\u6539)\uff0c \u8fd9\u79cd\u65b9\u5f0f\u5b9e\u73b0\u7b80\u5355\uff0c\u4f46\u662f\u6574\u4f53\u7f3a\u4e4f\u89c4\u8303\u6027\uff0c\u540c\u65f6\u6bcf\u5f53\u6709\u4e00\u79cd\u65b0\u7684\u9700\u6c42\u6765\u7684\u65f6\u5019\uff0c\u8fd8\u8981\u624b\u5de5\u589e\u52a0\u989d\u5916\u7684\u4ee3\u7801\uff0c\u6269\u5c55\u4e0d\u591f\u65b9\u4fbf\u3002 \u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5c1d\u8bd5\u5b9e\u8df5\u4f7f\u7528OC\u539f\u5219\u5bf9\u5176\u8fdb\u884c\u6539\u9020 OC\u62bd\u8c61Spec \u4e3a\u4e86\u907f\u514d\u8fd9\u79cd\u7d2f\u52a0\u5f0f\u7684\u4fee\u6539\uff0c\u6211\u4eec\u53ef\u4ee5\u62bd\u79bb\u51fa\u4e00\u5c42\u4e2d\u95f4\u6982\u5ff5\uff0c\u7528\u6765\u7edf\u4e00\u63cf\u8ff0\u67e5\u8be2\u6761\u4ef6\u3002 \u8fd9\u91cc\u6682\u5b9a\u5176\u7ed3\u6784\u4f53\u540d\u79f0\u4e3aSpec type Spec interface { IsSatisfied ( e * Estate ) bool } \u8fd9\u91cc\u5bf9\u4e8eprice\u548cdistance\u5206\u522b\u505a\u4e24\u4e2a\u63a5\u53e3\u7684\u5b9e\u73b0 type DistanceSpec struct { distance float64 } type PriceSpec struct { low int64 high int64 } \u800c\u5176 IsSatisfied \u65b9\u6cd5\u7684\u5b9e\u73b0\u4e3a func ( d DistanceSpec ) IsSatisfied ( e * Estate ) bool { return e . distance <= d . distance } func ( p PriceSpec ) IsSatisfied ( e * Estate ) bool { return e . price >= p . low && e . price <= p . high } \u6211\u4eec\u5728\u8c03\u7528Filter\u7684\u65b9\u6cd5\u65f6\u53ef\u4ee5\u505a\u5982\u4e0b\u7684\u6539\u9020 func ( f * Filter ) Filter ( estates [] Estate , spec Spec ) [] * Estate { result := make ([] * Estate , 0 ) for i , v := range estates { if spec . IsSatisfied ( & v ) { result = append ( result , & estates [ i ]) } } return result } \u53ef\u4ee5\u770b\u5230\uff0c\u5982\u679c\u8981\u65b0\u589e\u4e00\u4e2a\u67e5\u8be2\u6761\u4ef6\u7684\u8bdd\uff0c\u6211\u4eec\u4ecd\u7136\u9700\u8981\u505a\u4e00\u4e9b\u4fee\u6539\uff0c \u4f46\u8fd9\u91cc\u5df2\u7ecf\u4e0d\u518d\u662f\u5bf9Filter\u65b9\u6cd5\u7684\u4fee\u6539\uff0c\u800c\u662f\u7f16\u5199\u4e00\u4e2aSpec\u6765\u5b8c\u6210\u6269\u5c55\u3002 \u8fd9\u662f\u7b26\u5408OC\u539f\u5219\u7684\u3002\u53e6\u5916\uff0c\u8fd8\u6709\u4e00\u4e2a\u597d\u5904\uff0c\u5f53\u591a\u4e2a\u67e5\u8be2\u6761\u4ef6\u4ea7\u751f\u65f6\uff0c\u65f6\u6309\u6216\u8fd8\u662f\u6309\u4e0e\u8fdb\u884c\u6761\u4ef6\u5224\u65ad\u4e5f\u662f\u4e00\u4e2a\u95ee\u9898\u3002 \u76f8\u6bd4\u4e4b\u524d\u7684\u4ee3\u7801\uff0c\u62bd\u8c61\u51faSpec\u63a5\u53e3\u540e\u53ef\u4ee5\u66f4\u597d\u7684\u5b9e\u73b0\u8fd9\u4e00\u70b9\u3002 type AndSpec struct { first , second Spec } func ( a AndSpec ) IsSatisfied ( e * Estate ) bool { return a . first . IsSatisfied ( e ) && a . second . IsSatisfied ( e ) } \u76f8\u5e94\u7684\uff0c\u5176\u8c03\u7528\u65b9\u5f0f\u4e3a f := Filter {} priceSpec := PriceSpec { 2500 , 4500 } distanceSpec := DistanceSpec { 5.0 } andSpec := AndSpec { priceSpec , distanceSpec } for _ , v := range f . Filter ( houses , andSpec ) { fmt . Println ( v . name ) } \u5b8c\u6574\u7684\u4ee3\u7801\u5982\u4e0b package main import ( \"fmt\" ) type Estate struct { name string distance float64 price int64 } type Filter struct { } type Spec interface { IsSatisfied ( e * Estate ) bool } type DistanceSpec struct { distance float64 } type PriceSpec struct { low int64 high int64 } type AndSpec struct { first , second Spec } func ( d DistanceSpec ) IsSatisfied ( e * Estate ) bool { return e . distance <= d . distance } func ( p PriceSpec ) IsSatisfied ( e * Estate ) bool { return e . price >= p . low && e . price <= p . high } func ( a AndSpec ) IsSatisfied ( e * Estate ) bool { return a . first . IsSatisfied ( e ) && a . second . IsSatisfied ( e ) } func ( f * Filter ) Filter ( estates [] Estate , spec Spec ) [] * Estate { result := make ([] * Estate , 0 ) for i , v := range estates { if spec . IsSatisfied ( & v ) { result = append ( result , & estates [ i ]) } } return result } func main () { houses := [] Estate { { \"\u798f\u5c71\u4e00\u6751#1\" , 3.0 , 5500 }, { \"\u7531\u7531\u4e00\u6751#1\" , 4.0 , 4000 }, { \"\u9ad8\u5883\u4e00\u6751#1\" , 7.0 , 3500 } } fmt . Println ( houses ) f := Filter {} fmt . Println ( \"---------\" ) priceSpec := PriceSpec { 2500 , 4500 } for _ , v := range f . Filter ( houses , priceSpec ) { fmt . Println ( v . name ) } fmt . Println ( \"---------\" ) distanceSpec := DistanceSpec { 5.0 } for _ , v := range f . Filter ( houses , distanceSpec ) { fmt . Println ( v . name ) } fmt . Println ( \"---------\" ) andSpec := AndSpec { priceSpec , distanceSpec } for _ , v := range f . Filter ( houses , andSpec ) { fmt . Println ( v . name ) } }","title":"Open-Closed Principle \u5f00\u653e\u5c01\u95ed\u51c6\u5219\u7684golang\u5b9e\u4f8b"},{"location":"notes/2020/golang/ocp/#open-closed-principle-golang","text":"author: dameng(Makefile\u541b)","title":"Open-Closed Principle \u5f00\u653e\u5c01\u95ed\u51c6\u5219\u7684golang\u5b9e\u4f8b"},{"location":"notes/2020/golang/ocp/#_1","text":"S.O.L.I.D \u539f\u5219\u4e2d\u7684 O \u5373\u6307\u660e\u7684\u662f\u5f00\u653e\u5c01\u95ed\u51c6\u5219, \u5176\u5021\u5bfc\u8f6f\u4ef6\u5b9e\u4f53\u5e94\u8be5\u662f\u53ef\u4ee5\u6269\u5c55\u7684\uff0c\u4f46\u4e0d\u63a5\u53d7\u4fee\u6539. Software entities (classes, modules, functions, etc.) should be open for extension, but closed for modification.","title":"\u6982\u5ff5\u5f15\u5bfc"},{"location":"notes/2020/golang/ocp/#_2","text":"\u4e3a\u4e86\u65b9\u4fbf\u8bb2\u89e3\uff0c\u8fd9\u91cc\u4ee5\u4e00\u4e2a\u73b0\u5b9e\u4e2d\u7684\u4f8b\u5b50\u6765\u8bb2\u89e3\uff0c\u5047\u8bbe\u6211\u4eec\u7684\u4e3b\u4eba\u516c\u5c0f\u660e\u521a\u521a\u627e\u4e86\u4e00\u4efd\u65b0\u5de5\u4f5c\uff0c\u987a\u5e26\u60f3\u79df\u4e2a\u79bb\u516c\u53f8\u8fd1\u4e00\u70b9\u7684\u623f\u5b50, \u4e0e\u662f\u4ed6\u767b\u9646\u201c\u67d0\u5bb6\u201d\u7f51\u8fdb\u884c\u641c\u5bfb\uff0c\u53d1\u73b0\u5176\u53ef\u4ee5\u6309\u8ddd\u79bb\uff0c\u4e5f\u53ef\u4ee5\u6309\u4ef7\u4f4d\u8fdb\u884c\u641c\u7d22\u3002 \u6211\u4eec\u8fd9\u91cc\u5bf9\u623f\u5c4b\u8fdb\u884c\u4e00\u4e9b\u62bd\u8c61\uff0c\u5982\u679c\u6211\u4eec\u7684\u7528\u6237\u5173\u5fc3\u7684\u53ea\u6709\u8ddd\u79bb\u548c\u4ef7\u4f4d\u7f6e\uff0c\u90a3\u4e48\u53ef\u4ee5\u8fdb\u884c\u5982\u4e0b\u7684\u62bd\u8c61\u3002 type Estate struct { name string distance float64 price int64 } \u9664\u4e86\u4e3e\u4f8b\u548c\u4ef7\u4e3a\u4e4b\u5916\uff0c\u6211\u4eec\u589e\u52a0\u4e86\u4e00\u4e2aname\u5c5e\u6027\uff0c\u7528\u6765\u6807\u540d\u623f\u5c4b\u5177\u4f53\u7684\u4e0d\u540c\u3002 \u800c\u67e5\u8be2\u7684\u6761\u4ef6\u6709\u4e24\u4e2a\uff1a \u8ddd\u79bb\uff0c\u4ef7\u4f4d. \u6211\u4eec\u9700\u8981\u80fd\u5206\u522b\u6309\u7167\u8ddd\u79bb\u548c\u52a0\u4e3a\u8fdb\u884c\u67e5\u627e\uff0c\u8fd9\u91cc\u4e5f\u8fdb\u884c\u4e00\u4e9b\u62bd\u8c61\u5982\u4e0b type Filter struct { } func ( f * Filter ) FilterByPrice ( estates [] Estate , low int64 , high int64 ) [] * Estate { result := make ([] * Estate , 0 ) for i , v := range estates { if low <= v . price && v . price <= high { result = append ( result , & estates [ i ]) } } return result } func ( f * Filter ) FilterByDistance ( estates [] Estate , distance float64 ) [] * Estate { result := make ([] * Estate , 0 ) for i , v := range estates { if v . distance <= distance { result = append ( result , & estates [ i ]) } } return result } \u53ef\u4ee5\u770b\u5230\uff0cFilter\u7ed3\u6784\u4f53\u672c\u8eab\u5e76\u4e0d\u5305\u542b\u989d\u5916\u7684\u5c5e\u6027\uff0c\u53ea\u662f\u589e\u52a0\u4e86\u4e24\u4e2a\u67e5\u8be2\u7684\u65b9\u6cd5\u3002 \u771f\u6b63\u8c03\u7528\u65f6\uff0c\u6211\u4eec\u9700\u8981\u5148\u6784\u5efa\u4e00\u4e9b\u623f\u5c4b\u7684\u6570\u636e\uff0c\u6bd4\u5982 houses := [] Estate { { \"\u798f\u5c71\u4e00\u6751#1\" , 3.0 , 5500 }, { \"\u7531\u7531\u4e00\u6751#1\" , 4.0 , 4000 }, { \"\u9ad8\u5883\u4e00\u6751#1\" , 7.0 , 3500 } } \u5728\u67e5\u627e\u65f6\uff0c\u6211\u4eec\u9700\u8981\u58f0\u660e\u4e00\u4e2aFilter\u7684\u5b9e\u4f8b\u4ee5\u4fbf\u8c03\u7528\u5176\u65b9\u6cd5 f := Filter {} \u6309\u4ef7\u683c\u67e5\u627e for _ , v := range f . FilterByPrice ( houses , 2500 , 4500 ) { fmt . Println ( v . name ) } \u6309\u8ddd\u79bb\u67e5\u627e for _,v := range f.FilterByDistance(houses, 5.0) { fmt.Println(v.name) }","title":"\u573a\u666f\u642d\u5efa"},{"location":"notes/2020/golang/ocp/#_3","text":"\u8fd9\u4e2a\u65f6\u5019\u4e00\u4e2a\u5f88\u81ea\u7136\u5c31\u80fd\u5f15\u751f\u51fa\u6765\u7684\u9700\u6c42\u5c31\u662f \u540c\u65f6\u6309\u4ef7\u683c\u548c\u8ddd\u79bb\u8fdb\u884c\u67e5\u627e \u76f4\u89c2\u7684\u505a\u6cd5\u662f\u589e\u52a0\u4e00\u4e2a FilterByPriceAndDistance , \u5b8c\u6210\u76f8\u5e94\u6761\u4ef6\u5339\u914d\u7684\u641c\u5bfb \u6bd4\u5982\u53ef\u4ee5\u6309\u7167\u5982\u4e0b\u8fdb\u884c\u5b9e\u73b0 func ( f * Filter ) FilterByPriceAndDistance ( estates [] Estate , low int64 , high int64 , distance float64 ) [] * Estate { result := make ([] * Estate , 0 ) for i , v := range estates { if low <= v . price && v . price <= high && v . distance <= distance { result = append ( result , & estates [ i ]) } } return result } \u4f46\u662f\u8fd9\u662f\u4e0d\u7b26\u5408Open-Closed\u51c6\u5219\uff0c \u56e0\u4e3a\u8fd9\u662f\u4e00\u79cd\u201c\u4fb5\u5165\u5f0f\u201d\u7684\"\u4fee\u6539\"(\u8c03\u7528\u65f6\u51fd\u6570\u540d\u79f0\u7b49\u9700\u8981\u4fee\u6539)\uff0c \u8fd9\u79cd\u65b9\u5f0f\u5b9e\u73b0\u7b80\u5355\uff0c\u4f46\u662f\u6574\u4f53\u7f3a\u4e4f\u89c4\u8303\u6027\uff0c\u540c\u65f6\u6bcf\u5f53\u6709\u4e00\u79cd\u65b0\u7684\u9700\u6c42\u6765\u7684\u65f6\u5019\uff0c\u8fd8\u8981\u624b\u5de5\u589e\u52a0\u989d\u5916\u7684\u4ee3\u7801\uff0c\u6269\u5c55\u4e0d\u591f\u65b9\u4fbf\u3002 \u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5c1d\u8bd5\u5b9e\u8df5\u4f7f\u7528OC\u539f\u5219\u5bf9\u5176\u8fdb\u884c\u6539\u9020","title":"\u9700\u6c42\u53d8\u66f4"},{"location":"notes/2020/golang/ocp/#ocspec","text":"\u4e3a\u4e86\u907f\u514d\u8fd9\u79cd\u7d2f\u52a0\u5f0f\u7684\u4fee\u6539\uff0c\u6211\u4eec\u53ef\u4ee5\u62bd\u79bb\u51fa\u4e00\u5c42\u4e2d\u95f4\u6982\u5ff5\uff0c\u7528\u6765\u7edf\u4e00\u63cf\u8ff0\u67e5\u8be2\u6761\u4ef6\u3002 \u8fd9\u91cc\u6682\u5b9a\u5176\u7ed3\u6784\u4f53\u540d\u79f0\u4e3aSpec type Spec interface { IsSatisfied ( e * Estate ) bool } \u8fd9\u91cc\u5bf9\u4e8eprice\u548cdistance\u5206\u522b\u505a\u4e24\u4e2a\u63a5\u53e3\u7684\u5b9e\u73b0 type DistanceSpec struct { distance float64 } type PriceSpec struct { low int64 high int64 } \u800c\u5176 IsSatisfied \u65b9\u6cd5\u7684\u5b9e\u73b0\u4e3a func ( d DistanceSpec ) IsSatisfied ( e * Estate ) bool { return e . distance <= d . distance } func ( p PriceSpec ) IsSatisfied ( e * Estate ) bool { return e . price >= p . low && e . price <= p . high } \u6211\u4eec\u5728\u8c03\u7528Filter\u7684\u65b9\u6cd5\u65f6\u53ef\u4ee5\u505a\u5982\u4e0b\u7684\u6539\u9020 func ( f * Filter ) Filter ( estates [] Estate , spec Spec ) [] * Estate { result := make ([] * Estate , 0 ) for i , v := range estates { if spec . IsSatisfied ( & v ) { result = append ( result , & estates [ i ]) } } return result } \u53ef\u4ee5\u770b\u5230\uff0c\u5982\u679c\u8981\u65b0\u589e\u4e00\u4e2a\u67e5\u8be2\u6761\u4ef6\u7684\u8bdd\uff0c\u6211\u4eec\u4ecd\u7136\u9700\u8981\u505a\u4e00\u4e9b\u4fee\u6539\uff0c \u4f46\u8fd9\u91cc\u5df2\u7ecf\u4e0d\u518d\u662f\u5bf9Filter\u65b9\u6cd5\u7684\u4fee\u6539\uff0c\u800c\u662f\u7f16\u5199\u4e00\u4e2aSpec\u6765\u5b8c\u6210\u6269\u5c55\u3002 \u8fd9\u662f\u7b26\u5408OC\u539f\u5219\u7684\u3002\u53e6\u5916\uff0c\u8fd8\u6709\u4e00\u4e2a\u597d\u5904\uff0c\u5f53\u591a\u4e2a\u67e5\u8be2\u6761\u4ef6\u4ea7\u751f\u65f6\uff0c\u65f6\u6309\u6216\u8fd8\u662f\u6309\u4e0e\u8fdb\u884c\u6761\u4ef6\u5224\u65ad\u4e5f\u662f\u4e00\u4e2a\u95ee\u9898\u3002 \u76f8\u6bd4\u4e4b\u524d\u7684\u4ee3\u7801\uff0c\u62bd\u8c61\u51faSpec\u63a5\u53e3\u540e\u53ef\u4ee5\u66f4\u597d\u7684\u5b9e\u73b0\u8fd9\u4e00\u70b9\u3002 type AndSpec struct { first , second Spec } func ( a AndSpec ) IsSatisfied ( e * Estate ) bool { return a . first . IsSatisfied ( e ) && a . second . IsSatisfied ( e ) } \u76f8\u5e94\u7684\uff0c\u5176\u8c03\u7528\u65b9\u5f0f\u4e3a f := Filter {} priceSpec := PriceSpec { 2500 , 4500 } distanceSpec := DistanceSpec { 5.0 } andSpec := AndSpec { priceSpec , distanceSpec } for _ , v := range f . Filter ( houses , andSpec ) { fmt . Println ( v . name ) } \u5b8c\u6574\u7684\u4ee3\u7801\u5982\u4e0b package main import ( \"fmt\" ) type Estate struct { name string distance float64 price int64 } type Filter struct { } type Spec interface { IsSatisfied ( e * Estate ) bool } type DistanceSpec struct { distance float64 } type PriceSpec struct { low int64 high int64 } type AndSpec struct { first , second Spec } func ( d DistanceSpec ) IsSatisfied ( e * Estate ) bool { return e . distance <= d . distance } func ( p PriceSpec ) IsSatisfied ( e * Estate ) bool { return e . price >= p . low && e . price <= p . high } func ( a AndSpec ) IsSatisfied ( e * Estate ) bool { return a . first . IsSatisfied ( e ) && a . second . IsSatisfied ( e ) } func ( f * Filter ) Filter ( estates [] Estate , spec Spec ) [] * Estate { result := make ([] * Estate , 0 ) for i , v := range estates { if spec . IsSatisfied ( & v ) { result = append ( result , & estates [ i ]) } } return result } func main () { houses := [] Estate { { \"\u798f\u5c71\u4e00\u6751#1\" , 3.0 , 5500 }, { \"\u7531\u7531\u4e00\u6751#1\" , 4.0 , 4000 }, { \"\u9ad8\u5883\u4e00\u6751#1\" , 7.0 , 3500 } } fmt . Println ( houses ) f := Filter {} fmt . Println ( \"---------\" ) priceSpec := PriceSpec { 2500 , 4500 } for _ , v := range f . Filter ( houses , priceSpec ) { fmt . Println ( v . name ) } fmt . Println ( \"---------\" ) distanceSpec := DistanceSpec { 5.0 } for _ , v := range f . Filter ( houses , distanceSpec ) { fmt . Println ( v . name ) } fmt . Println ( \"---------\" ) andSpec := AndSpec { priceSpec , distanceSpec } for _ , v := range f . Filter ( houses , andSpec ) { fmt . Println ( v . name ) } }","title":"OC\u62bd\u8c61Spec"},{"location":"notes/2020/golang/startup/","text":"","title":"Startup"},{"location":"notes/2020/golang/types/","text":"golang\u4e2d\u7684\u7c7b\u578b \u57fa\u7840\u7c7b\u578b \u5e03\u5c14\u7c7b\u578b \u6570\u503c\u7c7b\u578b \u5b57\u7b26\uff08\u4e32\uff09\u7c7b\u578b \u590d\u6570\u7c7b\u578b","title":"golang\u4e2d\u7684\u7c7b\u578b"},{"location":"notes/2020/golang/types/#golang","text":"","title":"golang\u4e2d\u7684\u7c7b\u578b"},{"location":"notes/2020/golang/types/#_1","text":"\u5e03\u5c14\u7c7b\u578b \u6570\u503c\u7c7b\u578b \u5b57\u7b26\uff08\u4e32\uff09\u7c7b\u578b \u590d\u6570\u7c7b\u578b","title":"\u57fa\u7840\u7c7b\u578b"},{"location":"notes/2020/ml/cuda_install/","text":"tensorflow/pytorch \u5b89\u88c5\u51c6\u5907 \u65f6\u6548\u6027: 2020\u5e74\u521d \u65e0\u8bbatf\u8fd8\u662ftorch,\u5b83\u4eec\u90fd\u9700\u8981N\u5361\u9a71\u52a8\u652f\u6301\uff0c\u6211\u7684\u7b14\u8bb0\u672c\u662fGTX 1650\u7684\u663e\u5361\uff0c\u73b0\u5728tensorflow 2.1\u548cpytorch 1.3\uff0c \u9ed8\u8ba4\u63a8\u8350\u7684\u662fcuda 10.1\u7684\u73af\u5883\uff0c\u8be5\u73af\u5883\u914d\u7f6e\u7684nvidia\u9a71\u52a8\u662f418\uff0c\u636e\u8bf4\u5230\u4e86nvidia430\u7684\u9a71\u52a8\u624d\u652f\u63011650\u7684\u5361\uff0c\u6240\u4ee5\u53ef\u4ee5\u5148\u5b89\u88c5\u597d\u9a71\u52a8\uff0c\u518d\u5b89\u88c5cuda\uff0c\u5e76\u4e14\u53d6\u6d88\u5185\u7f6e\u7684\u9a71\u52a8\u52fe\u9009\u3002 \u6ce8\u610f\uff1a \u5728ubuntu\u4e0b\u53ef\u4ee5\u4f7f\u7528 sudo prime-select nvidia \u6765\u5207\u6362\u72ec\u663e cuda-toolkit \u5b89\u88c5 wget https://developer.download.nvidia.com/compute/cuda/repos/ubuntu1804/x86_64/cuda-repo-ubuntu1804_10.1.243-1_amd64.deb sudo sh cuda_10.1.243_418.87.00_linux.run \u5b8c\u6210\u5b89\u88c5\u540e\uff0c\u9700\u8981\u914d\u7f6e\u73af\u5883\u53d8\u91cf\uff0c\u5e76\u6267\u884cldconfig - PATH includes /usr/local/cuda-10.1/bin - LD_LIBRARY_PATH includes /usr/local/cuda-10.1/lib64, or, add /usr/local/cuda-10.1/lib64 to /etc/ld.so.conf and run ldconfig as root \u6ce8\u610f\uff1a \u76ee\u524d(2020\u5e74\u521d)cuda\u5df2\u7ecf\u670910.2\u7684\u7248\u672c\u4e86\uff0c\u4f46\u662ftensorflow\u548cpytorch\u7684\u5b98\u65b9\u6587\u6863\u4f9d\u65e7\u662f\u9488\u5bf910.1\u7684\uff0c\u7406\u8bba\u4e0a\u5b89\u88c510.2\u7684cuda\u4e5f\u662f\u53ef\u4ee5\u7684\uff0c\u4f46\u662f\u6709\u53ef\u80fd\u4f1a\u62a5\u52a8\u6001\u8fde\u63a5\u5e93\u5f02\u5e38\u7b49\u95ee\u9898\uff0c\u9700\u8981mock\u4e00\u4e0b\uff0c\u6240\u4ee5\u4e00\u822c\u6765\u8bf4\u8fd8\u662f\u76f4\u63a5\u88c510.1\u5c31\u597d cudnn\u7684\u5b89\u88c5 \u548c10.1\u5bf9\u5e94\u7684cuDNN\u7248\u672c\u67097.6.4\uff08\u80fd\u4e0d\u80fd\u88c5\u5176\u5b83\u7684\u5176\u5b9e\u6211\u4e5f\u6ca1\u5b9e\u9a8c\u8fc7\uff09 \u8fd9\u91cc\u7ed9\u51fa\u51e0\u4e2a\u76f8\u5173\u7684\u94fe\u63a5 cudnn libcudnn libcudnn-dev libcudnn-doc cudnn \u662f tgz\u538b\u7f29\u5305\uff0c\u9700\u8981\u89e3\u538b\uff0c\u89e3\u538b\u540e\u6267\u884c sudo cp cuda/include/cudnn.h /usr/local/cuda/include sudo cp cuda/lib64/libcudnn* /usr/local/cuda/lib64 sudo chmod a+r /usr/local/cuda/include/cudnn.h /usr/local/cuda/lib64/libcudnn* \u6ce8\u610f\uff1a \u5982\u679c\u51fa\u73b0so\u8fde\u63a5\u5e93\u95ee\u9898\uff0c\u53ef\u4ee5\u624b\u5de5\u94fe\u63a5\uff0c\u6216\u8005\u518d\u6b21copy cuda/lib64\u4e0b\u5bf9\u5e94\u7684\u6587\u4ef6\u5230/usr/local/cuda/lib64\u4e2d \u9a8c\u8bc1cudnn\u5b89\u88c5 cp -r /usr/src/cudnn_samples_v7 ./ build\u5176\u4e2dmnist\u7684\u4f8b\u5b50\u5e76\u6267\u884c\uff0c\u5982\u679ctest\u901a\u8fc7\uff0c\u8bf4\u660e\u5b89\u88c5\u6210\u529f tensorflow \u5b89\u88c5 pip install tensorflow pytorch \u5b89\u88c5 pip install torch torchvision","title":"tensorflow/pytorch \u5b89\u88c5\u51c6\u5907"},{"location":"notes/2020/ml/cuda_install/#tensorflowpytorch","text":"\u65f6\u6548\u6027: 2020\u5e74\u521d \u65e0\u8bbatf\u8fd8\u662ftorch,\u5b83\u4eec\u90fd\u9700\u8981N\u5361\u9a71\u52a8\u652f\u6301\uff0c\u6211\u7684\u7b14\u8bb0\u672c\u662fGTX 1650\u7684\u663e\u5361\uff0c\u73b0\u5728tensorflow 2.1\u548cpytorch 1.3\uff0c \u9ed8\u8ba4\u63a8\u8350\u7684\u662fcuda 10.1\u7684\u73af\u5883\uff0c\u8be5\u73af\u5883\u914d\u7f6e\u7684nvidia\u9a71\u52a8\u662f418\uff0c\u636e\u8bf4\u5230\u4e86nvidia430\u7684\u9a71\u52a8\u624d\u652f\u63011650\u7684\u5361\uff0c\u6240\u4ee5\u53ef\u4ee5\u5148\u5b89\u88c5\u597d\u9a71\u52a8\uff0c\u518d\u5b89\u88c5cuda\uff0c\u5e76\u4e14\u53d6\u6d88\u5185\u7f6e\u7684\u9a71\u52a8\u52fe\u9009\u3002 \u6ce8\u610f\uff1a \u5728ubuntu\u4e0b\u53ef\u4ee5\u4f7f\u7528 sudo prime-select nvidia \u6765\u5207\u6362\u72ec\u663e cuda-toolkit \u5b89\u88c5 wget https://developer.download.nvidia.com/compute/cuda/repos/ubuntu1804/x86_64/cuda-repo-ubuntu1804_10.1.243-1_amd64.deb sudo sh cuda_10.1.243_418.87.00_linux.run \u5b8c\u6210\u5b89\u88c5\u540e\uff0c\u9700\u8981\u914d\u7f6e\u73af\u5883\u53d8\u91cf\uff0c\u5e76\u6267\u884cldconfig - PATH includes /usr/local/cuda-10.1/bin - LD_LIBRARY_PATH includes /usr/local/cuda-10.1/lib64, or, add /usr/local/cuda-10.1/lib64 to /etc/ld.so.conf and run ldconfig as root \u6ce8\u610f\uff1a \u76ee\u524d(2020\u5e74\u521d)cuda\u5df2\u7ecf\u670910.2\u7684\u7248\u672c\u4e86\uff0c\u4f46\u662ftensorflow\u548cpytorch\u7684\u5b98\u65b9\u6587\u6863\u4f9d\u65e7\u662f\u9488\u5bf910.1\u7684\uff0c\u7406\u8bba\u4e0a\u5b89\u88c510.2\u7684cuda\u4e5f\u662f\u53ef\u4ee5\u7684\uff0c\u4f46\u662f\u6709\u53ef\u80fd\u4f1a\u62a5\u52a8\u6001\u8fde\u63a5\u5e93\u5f02\u5e38\u7b49\u95ee\u9898\uff0c\u9700\u8981mock\u4e00\u4e0b\uff0c\u6240\u4ee5\u4e00\u822c\u6765\u8bf4\u8fd8\u662f\u76f4\u63a5\u88c510.1\u5c31\u597d cudnn\u7684\u5b89\u88c5 \u548c10.1\u5bf9\u5e94\u7684cuDNN\u7248\u672c\u67097.6.4\uff08\u80fd\u4e0d\u80fd\u88c5\u5176\u5b83\u7684\u5176\u5b9e\u6211\u4e5f\u6ca1\u5b9e\u9a8c\u8fc7\uff09 \u8fd9\u91cc\u7ed9\u51fa\u51e0\u4e2a\u76f8\u5173\u7684\u94fe\u63a5 cudnn libcudnn libcudnn-dev libcudnn-doc cudnn \u662f tgz\u538b\u7f29\u5305\uff0c\u9700\u8981\u89e3\u538b\uff0c\u89e3\u538b\u540e\u6267\u884c sudo cp cuda/include/cudnn.h /usr/local/cuda/include sudo cp cuda/lib64/libcudnn* /usr/local/cuda/lib64 sudo chmod a+r /usr/local/cuda/include/cudnn.h /usr/local/cuda/lib64/libcudnn* \u6ce8\u610f\uff1a \u5982\u679c\u51fa\u73b0so\u8fde\u63a5\u5e93\u95ee\u9898\uff0c\u53ef\u4ee5\u624b\u5de5\u94fe\u63a5\uff0c\u6216\u8005\u518d\u6b21copy cuda/lib64\u4e0b\u5bf9\u5e94\u7684\u6587\u4ef6\u5230/usr/local/cuda/lib64\u4e2d \u9a8c\u8bc1cudnn\u5b89\u88c5 cp -r /usr/src/cudnn_samples_v7 ./ build\u5176\u4e2dmnist\u7684\u4f8b\u5b50\u5e76\u6267\u884c\uff0c\u5982\u679ctest\u901a\u8fc7\uff0c\u8bf4\u660e\u5b89\u88c5\u6210\u529f tensorflow \u5b89\u88c5 pip install tensorflow pytorch \u5b89\u88c5 pip install torch torchvision","title":"tensorflow/pytorch \u5b89\u88c5\u51c6\u5907"},{"location":"slides/demo01/template/","text":"Additional Documentation Some references... /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = 'https://devs-wiki.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); Please enable JavaScript to view the comments powered by Disqus.","title":"Template"},{"location":"slides/docker/intro15m/","text":"Docker in 15 minutes SPONSORSHIP \u5982\u679c\u559c\u6b22\u672c\u8bfe\u7a0b\u4e14\u5e0c\u671b\u652f\u6301\u540e\u7eed\u66f4\u597d\u7684\u521b\u4f5c\u4e0e\u66f4\u65b0\uff0c\u53ef\u4ee5\u901a\u8fc7 sponsorship \u9875\u9762\u8fdb\u884c\u6350\u8d60\u3002 /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = 'https://devs-wiki.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); Please enable JavaScript to view the comments powered by Disqus.","title":"Docker in 15 minutes"},{"location":"slides/docker/intro15m/#docker-in-15-minutes","text":"SPONSORSHIP \u5982\u679c\u559c\u6b22\u672c\u8bfe\u7a0b\u4e14\u5e0c\u671b\u652f\u6301\u540e\u7eed\u66f4\u597d\u7684\u521b\u4f5c\u4e0e\u66f4\u65b0\uff0c\u53ef\u4ee5\u901a\u8fc7 sponsorship \u9875\u9762\u8fdb\u884c\u6350\u8d60\u3002 /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = 'https://devs-wiki.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); Please enable JavaScript to view the comments powered by Disqus.","title":"Docker in 15 minutes"},{"location":"slides/docker/intro2h/","text":"Docker & Kubernetes in 2 hours SPONSORSHIP \u5982\u679c\u559c\u6b22\u672c\u8bfe\u7a0b\u4e14\u5e0c\u671b\u652f\u6301\u540e\u7eed\u66f4\u597d\u7684\u521b\u4f5c\u4e0e\u66f4\u65b0\uff0c\u53ef\u4ee5\u901a\u8fc7 sponsorship \u9875\u9762\u8fdb\u884c\u6350\u8d60\u3002 /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = 'https://devs-wiki.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); Please enable JavaScript to view the comments powered by Disqus.","title":"Docker & Kubernetes in 2 hours"},{"location":"slides/docker/intro2h/#docker-kubernetes-in-2-hours","text":"SPONSORSHIP \u5982\u679c\u559c\u6b22\u672c\u8bfe\u7a0b\u4e14\u5e0c\u671b\u652f\u6301\u540e\u7eed\u66f4\u597d\u7684\u521b\u4f5c\u4e0e\u66f4\u65b0\uff0c\u53ef\u4ee5\u901a\u8fc7 sponsorship \u9875\u9762\u8fdb\u884c\u6350\u8d60\u3002 /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = 'https://devs-wiki.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); Please enable JavaScript to view the comments powered by Disqus.","title":"Docker &amp; Kubernetes in 2 hours"},{"location":"slides/gdg-shanghai/k8s/ch00/","text":"GDG \u4e0a\u6d77 Docker\u4e0eK8s\u8bfe\u7a0b \u51c6\u5907\u8bf4\u660e \u672c\u6b21\u8bfe\u7a0b\u4e3a\u5b9e\u8df5\u7c7b\u578b\u8bfe\u7a0b\uff0c\u4f1a\u7a7f\u63d2\u591a\u4e2a\u5b9e\u4f8b\u4efb\u52a1\uff08\u4e3b\u8981\u96be\u5ea6\u4f1a\u96c6\u4e2d\u5728\u521d\u3001\u4e2d\u7ea7\u522b\uff09\uff0c\u5927\u5bb6\u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u7684\u63a5\u53d7\u7a0b\u5ea6\u4ee5\u53ca\u65f6\u95f4\u81ea\u884c\u9009\u62e9 \u5728\u53c2\u52a0\u672c\u6b21workshop\u524d\uff0c\u5e0c\u671b\u4f60\u5df2\u7ecf\u5177\u5907\u4e86\u4e00\u5b9a\u7684linux\u64cd\u4f5c\u57fa\u7840\uff0c\u5982\u679c\u6ca1\u6709\u53ef\u4ee5\u901a\u8fc7\u4e4b\u524d\u7ae0\u8282\u7684\u8bfe\u4ef6\u8fdb\u884c\u5b66\u4e60 devs.wiki \u672c\u6b21\u8bfe\u7a0b\u603b\u5171\u6709\u4e94\u6b21\u5206\u4eab\uff0c \u524d\u4e09\u8282\u8bfe\u7a0b\u5bf9\u4e8e\u6240\u4f7f\u7528\u7684\u7535\u8111\u6ca1\u6709\u592a\u591a\u7684\u8981\u6c42\uff0c\u57fa\u672c\u4e0a\u53ea\u8981\u6709\u80fd\u8fd0\u884clinux\u7684\u73af\u5883\u5373\u53ef\u6ee1\u8db3\u3002\u540e\u4e24\u8282\u8bfe\u6709\u4e00\u5b9a\u786c\u4ef6\u8981\u6c42\u9650\u5236\uff0c\u6bd5\u7adf\u8981\u642d\u5efa\u96c6\u7fa4\u73af\u5883\uff0c\u914d\u7f6e\u592a\u4f4e\u4e86\u53ef\u80fd\u8dd1\u4e0d\u8d77\u6765\uff0c\u65e0\u6cd5\u5b8c\u6574\u4f53\u9a8c\u3002 \u4f53\u9a8c\u7684\u65b9\u5f0f\u53ef\u4ee5\u5728\u672c\u5730\u642d\u5efa\u865a\u62df\u673a\uff08\u96c6\u7fa4\uff09\u6216\u8d2d\u4e70\u4e91\u7aef\u670d\u52a1\u5668\uff0c\u5e76\u6ca1\u6709\u786c\u6027\u9650\u5236\u3002 \u5bf9\u4e8e\u672c\u5730\u642d\u5efa\u865a\u62df\u673a\uff08\u96c6\u7fa4\uff09\u7684\u5efa\u8bae - \u4e09\u53f0\u8282\u70b9\uff0c\u4e00\u53f0\u7528\u4f5cmaster\u8282\u70b9\uff0c\u4e24\u53f0\u7528\u4f5cnode\u8282\u70b9 - master\u8282\u70b9\u914d\u7f6e\uff0c\u5efa\u8bae\u6700\u4f4e 2 CPU\uff0c3Gi Memory - node\u8282\u70b9\u914d\u7f6e\uff0c\u5efa\u8bae\u6700\u4f4e 2 CPU\uff0c2Gi Memory - \u955c\u50cf\u5efa\u8bae\u4f7f\u7528systemd\u7ba1\u7406\u670d\u52a1\u7684linux\u955c\u50cf\uff0c\u5982debian\uff0cubuntu\uff0cfedora\uff0ccentos\u7b49 \u5bf9\u4e8e\u4e91\u7aef\u8d2d\u4e70\u670d\u52a1\u5668\u7684\u5efa\u8bae - \u5efa\u8bae\u8d2d\u4e70\u7f51\u7edc\u8bbf\u95ee\u6d41\u7545\u7684\u673a\u623f - \u4f9d\u65e7\u4e3a\u4e09\u53f0\u8282\u70b9\uff0c\u914d\u7f6e\u540c\u4e0a \u8bfe\u7a0b\u76ee\u5f55 Docker\u57fa\u7840\u5165\u95e8 Docker\u5185\u529f\u63d0\u5347 \u6f2b\u8c08K8s K8s\u5165\u95e8 K8s\u5b9e\u6218 SPONSORSHIP \u5982\u679c\u559c\u6b22\u672c\u8bfe\u7a0b\u4e14\u5e0c\u671b\u652f\u6301\u540e\u7eed\u66f4\u597d\u7684\u521b\u4f5c\u4e0e\u66f4\u65b0\uff0c\u53ef\u4ee5\u901a\u8fc7 sponsorship \u9875\u9762\u8fdb\u884c\u6350\u8d60\u3002","title":"GDG \u4e0a\u6d77 Docker\u4e0eK8s\u8bfe\u7a0b"},{"location":"slides/gdg-shanghai/k8s/ch00/#gdg-dockerk8s","text":"\u51c6\u5907\u8bf4\u660e \u672c\u6b21\u8bfe\u7a0b\u4e3a\u5b9e\u8df5\u7c7b\u578b\u8bfe\u7a0b\uff0c\u4f1a\u7a7f\u63d2\u591a\u4e2a\u5b9e\u4f8b\u4efb\u52a1\uff08\u4e3b\u8981\u96be\u5ea6\u4f1a\u96c6\u4e2d\u5728\u521d\u3001\u4e2d\u7ea7\u522b\uff09\uff0c\u5927\u5bb6\u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u7684\u63a5\u53d7\u7a0b\u5ea6\u4ee5\u53ca\u65f6\u95f4\u81ea\u884c\u9009\u62e9 \u5728\u53c2\u52a0\u672c\u6b21workshop\u524d\uff0c\u5e0c\u671b\u4f60\u5df2\u7ecf\u5177\u5907\u4e86\u4e00\u5b9a\u7684linux\u64cd\u4f5c\u57fa\u7840\uff0c\u5982\u679c\u6ca1\u6709\u53ef\u4ee5\u901a\u8fc7\u4e4b\u524d\u7ae0\u8282\u7684\u8bfe\u4ef6\u8fdb\u884c\u5b66\u4e60 devs.wiki \u672c\u6b21\u8bfe\u7a0b\u603b\u5171\u6709\u4e94\u6b21\u5206\u4eab\uff0c \u524d\u4e09\u8282\u8bfe\u7a0b\u5bf9\u4e8e\u6240\u4f7f\u7528\u7684\u7535\u8111\u6ca1\u6709\u592a\u591a\u7684\u8981\u6c42\uff0c\u57fa\u672c\u4e0a\u53ea\u8981\u6709\u80fd\u8fd0\u884clinux\u7684\u73af\u5883\u5373\u53ef\u6ee1\u8db3\u3002\u540e\u4e24\u8282\u8bfe\u6709\u4e00\u5b9a\u786c\u4ef6\u8981\u6c42\u9650\u5236\uff0c\u6bd5\u7adf\u8981\u642d\u5efa\u96c6\u7fa4\u73af\u5883\uff0c\u914d\u7f6e\u592a\u4f4e\u4e86\u53ef\u80fd\u8dd1\u4e0d\u8d77\u6765\uff0c\u65e0\u6cd5\u5b8c\u6574\u4f53\u9a8c\u3002 \u4f53\u9a8c\u7684\u65b9\u5f0f\u53ef\u4ee5\u5728\u672c\u5730\u642d\u5efa\u865a\u62df\u673a\uff08\u96c6\u7fa4\uff09\u6216\u8d2d\u4e70\u4e91\u7aef\u670d\u52a1\u5668\uff0c\u5e76\u6ca1\u6709\u786c\u6027\u9650\u5236\u3002 \u5bf9\u4e8e\u672c\u5730\u642d\u5efa\u865a\u62df\u673a\uff08\u96c6\u7fa4\uff09\u7684\u5efa\u8bae - \u4e09\u53f0\u8282\u70b9\uff0c\u4e00\u53f0\u7528\u4f5cmaster\u8282\u70b9\uff0c\u4e24\u53f0\u7528\u4f5cnode\u8282\u70b9 - master\u8282\u70b9\u914d\u7f6e\uff0c\u5efa\u8bae\u6700\u4f4e 2 CPU\uff0c3Gi Memory - node\u8282\u70b9\u914d\u7f6e\uff0c\u5efa\u8bae\u6700\u4f4e 2 CPU\uff0c2Gi Memory - \u955c\u50cf\u5efa\u8bae\u4f7f\u7528systemd\u7ba1\u7406\u670d\u52a1\u7684linux\u955c\u50cf\uff0c\u5982debian\uff0cubuntu\uff0cfedora\uff0ccentos\u7b49 \u5bf9\u4e8e\u4e91\u7aef\u8d2d\u4e70\u670d\u52a1\u5668\u7684\u5efa\u8bae - \u5efa\u8bae\u8d2d\u4e70\u7f51\u7edc\u8bbf\u95ee\u6d41\u7545\u7684\u673a\u623f - \u4f9d\u65e7\u4e3a\u4e09\u53f0\u8282\u70b9\uff0c\u914d\u7f6e\u540c\u4e0a","title":"GDG \u4e0a\u6d77 Docker\u4e0eK8s\u8bfe\u7a0b"},{"location":"slides/gdg-shanghai/k8s/ch00/#_1","text":"Docker\u57fa\u7840\u5165\u95e8 Docker\u5185\u529f\u63d0\u5347 \u6f2b\u8c08K8s K8s\u5165\u95e8 K8s\u5b9e\u6218","title":"\u8bfe\u7a0b\u76ee\u5f55"},{"location":"slides/gdg-shanghai/k8s/ch00/#sponsorship","text":"\u5982\u679c\u559c\u6b22\u672c\u8bfe\u7a0b\u4e14\u5e0c\u671b\u652f\u6301\u540e\u7eed\u66f4\u597d\u7684\u521b\u4f5c\u4e0e\u66f4\u65b0\uff0c\u53ef\u4ee5\u901a\u8fc7 sponsorship \u9875\u9762\u8fdb\u884c\u6350\u8d60\u3002","title":"SPONSORSHIP"},{"location":"slides/gdg-shanghai/k8s/ch01/","text":"Docker\u57fa\u7840\u5165\u95e8 /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = 'https://devs-wiki.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); Please enable JavaScript to view the comments powered by Disqus.","title":"Docker\u57fa\u7840\u5165\u95e8"},{"location":"slides/gdg-shanghai/k8s/ch01/#docker","text":"/** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = 'https://devs-wiki.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); Please enable JavaScript to view the comments powered by Disqus.","title":"Docker\u57fa\u7840\u5165\u95e8"},{"location":"slides/gdg-shanghai/k8s/ch02/","text":"Docker\u77e5\u8bc6\u8865\u5168 /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = 'https://devs-wiki.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); Please enable JavaScript to view the comments powered by Disqus.","title":"Docker\u77e5\u8bc6\u8865\u5168"},{"location":"slides/gdg-shanghai/k8s/ch02/#docker","text":"/** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = 'https://devs-wiki.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); Please enable JavaScript to view the comments powered by Disqus.","title":"Docker\u77e5\u8bc6\u8865\u5168"},{"location":"slides/gdg-shanghai/k8s/ch03/","text":"\u6f2b\u8c08K8s /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = 'https://devs-wiki.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); Please enable JavaScript to view the comments powered by Disqus.","title":"\u6f2b\u8c08K8s"},{"location":"slides/gdg-shanghai/k8s/ch03/#k8s","text":"/** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = 'https://devs-wiki.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); Please enable JavaScript to view the comments powered by Disqus.","title":"\u6f2b\u8c08K8s"},{"location":"slides/gdg-shanghai/k8s/ch04/","text":"K8s\u5165\u95e8 /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = 'https://devs-wiki.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); Please enable JavaScript to view the comments powered by Disqus.","title":"K8s\u5165\u95e8"},{"location":"slides/gdg-shanghai/k8s/ch04/#k8s","text":"/** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = 'https://devs-wiki.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); Please enable JavaScript to view the comments powered by Disqus.","title":"K8s\u5165\u95e8"},{"location":"slides/gdg-shanghai/k8s/ch05/","text":"K8s\u5b9e\u6218 /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = 'https://devs-wiki.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); Please enable JavaScript to view the comments powered by Disqus.","title":"K8s\u5b9e\u6218"},{"location":"slides/gdg-shanghai/k8s/ch05/#k8s","text":"/** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = 'https://devs-wiki.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); Please enable JavaScript to view the comments powered by Disqus.","title":"K8s\u5b9e\u6218"},{"location":"slides/gdg-zhengzhou/devfest2019/apifirst/","text":"API-First Approach to Building Products SPONSORSHIP \u5982\u679c\u559c\u6b22\u672c\u8bfe\u7a0b\u4e14\u5e0c\u671b\u652f\u6301\u540e\u7eed\u66f4\u597d\u7684\u521b\u4f5c\u4e0e\u66f4\u65b0\uff0c\u53ef\u4ee5\u901a\u8fc7 sponsorship \u9875\u9762\u8fdb\u884c\u6350\u8d60\u3002 /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = 'https://devs-wiki.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); Please enable JavaScript to view the comments powered by Disqus.","title":"API-First Approach to Building Products"},{"location":"slides/gdg-zhengzhou/devfest2019/apifirst/#api-first-approach-to-building-products","text":"SPONSORSHIP \u5982\u679c\u559c\u6b22\u672c\u8bfe\u7a0b\u4e14\u5e0c\u671b\u652f\u6301\u540e\u7eed\u66f4\u597d\u7684\u521b\u4f5c\u4e0e\u66f4\u65b0\uff0c\u53ef\u4ee5\u901a\u8fc7 sponsorship \u9875\u9762\u8fdb\u884c\u6350\u8d60\u3002 /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = 'https://devs-wiki.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); Please enable JavaScript to view the comments powered by Disqus.","title":"API-First Approach to Building Products"},{"location":"slides/python/quick_sort/","text":"Python \u5feb\u6392\u5165\u95e8 SPONSORSHIP \u5982\u679c\u559c\u6b22\u672c\u8bfe\u7a0b\u4e14\u5e0c\u671b\u652f\u6301\u540e\u7eed\u66f4\u597d\u7684\u521b\u4f5c\u4e0e\u66f4\u65b0\uff0c\u53ef\u4ee5\u901a\u8fc7 sponsorship \u9875\u9762\u8fdb\u884c\u6350\u8d60\u3002 /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = 'https://devs-wiki.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); Please enable JavaScript to view the comments powered by Disqus.","title":"Python \u5feb\u6392\u5165\u95e8"},{"location":"slides/python/quick_sort/#python","text":"SPONSORSHIP \u5982\u679c\u559c\u6b22\u672c\u8bfe\u7a0b\u4e14\u5e0c\u671b\u652f\u6301\u540e\u7eed\u66f4\u597d\u7684\u521b\u4f5c\u4e0e\u66f4\u65b0\uff0c\u53ef\u4ee5\u901a\u8fc7 sponsorship \u9875\u9762\u8fdb\u884c\u6350\u8d60\u3002 /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = 'https://devs-wiki.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); Please enable JavaScript to view the comments powered by Disqus.","title":"Python \u5feb\u6392\u5165\u95e8"},{"location":"sponsor/","text":"SPONSORSHIP \u6350\u8d60\u4e00\u5b9a\u7684\u79c1\u623f\u94b1\uff0c\u8ba9\u8fd9\u91cc\u53d8\u5f97\u66f4\u52a0\u7f8e\u597d\uff01 \u4f60\u5728\u83b7\u5f97\u6709\u9650\u7684\u4f46\u66f4\u597d\u7684\u6280\u672f\u652f\u6301\u7684\u540c\u65f6\uff0c\u4f60\u7684\u540d\u5b57\uff08\u6216\u6635\u79f0\uff09\u4e5f\u4f1a\u88ab\u94ed\u8bb0\uff01","title":"SPONSORSHIP"},{"location":"sponsor/#sponsorship","text":"\u6350\u8d60\u4e00\u5b9a\u7684\u79c1\u623f\u94b1\uff0c\u8ba9\u8fd9\u91cc\u53d8\u5f97\u66f4\u52a0\u7f8e\u597d\uff01 \u4f60\u5728\u83b7\u5f97\u6709\u9650\u7684\u4f46\u66f4\u597d\u7684\u6280\u672f\u652f\u6301\u7684\u540c\u65f6\uff0c\u4f60\u7684\u540d\u5b57\uff08\u6216\u6635\u79f0\uff09\u4e5f\u4f1a\u88ab\u94ed\u8bb0\uff01","title":"SPONSORSHIP"}]}